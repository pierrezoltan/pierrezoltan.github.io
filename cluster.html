<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Récapitulatif des matériels et logiciels &mdash; Documentation Documentation Projet Cluster Proxmox 0.0.1</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css\rtd_sphinx_search.min.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
        <script src="_static/js\rtd_sphinx_search.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="prev" title="Documentation Projet Cluster Proxmox" href="index.html" />
<style>
        .wy-side-nav-search .wy-dropdown > a img.logo, .wy-side-nav-search > a img.logo { width: 50%; height: 50%; }
</style>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Documentation Projet Cluster Proxmox
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Sommaire :</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#"><strong>Récapitulatif des matériels et logiciels</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#logiciels">Logiciels</a></li>
<li class="toctree-l2"><a class="reference internal" href="#materiels">Matériels</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adressage-ip">Adressage IP</a></li>
<li class="toctree-l2"><a class="reference internal" href="#schema-du-deploiement">Schéma du déploiement</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#serveur-proxmox"><strong>Serveur Proxmox</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#objectif-et-environnement">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#objectif">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#environnement">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#documentation">Documentation :</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-prealable">Configuration préalable</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#processus">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creation-dun-cluster">Création d’un Cluster</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installation-ceph">Installation Ceph</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ajout-des-monitors-et-managers">Ajout des Monitors et Managers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creation-dun-pool-de-stockage">Création d’un pool de stockage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creation-dun-pool">Création d’un pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mise-en-place-de-la-haute-disponibilite-ha">Mise en place de la haute disponibilité (HA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-de-la-migration-dune-vm">Test de la migration d’une VM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-de-la-haute-disponibilite-lors-dune-coupure-dun-serveur">Test de la haute disponibilité lors d’une coupure d’un serveur</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#suppression-dun-cluster">Suppression d’un cluster</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#switch-3com"><strong>Switch 3COM</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id5">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#administration-vlan-en-cli">Administration VLAN en CLI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creation-dun-vlan">Création d’un VLAN</a></li>
<li class="toctree-l3"><a class="reference internal" href="#supprimer-un-vlan">Supprimer un VLAN</a></li>
<li class="toctree-l3"><a class="reference internal" href="#administration-vlan-par-interface-web">Administration VLAN par interface Web</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configurer-dune-adresse-ip-en-gui">Configurer d’une adresse IP en GUI</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creer-un-trunk-sur-un-port">Créer un Trunk sur un port</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tagger-un-port">Tagger un port</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cisco-packet-tracer">Cisco Packet Tracer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#schema-du-reseau">Schéma du réseau</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-du-switch1-t2sr">Configuration du Switch1 (T2SR)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-du-switch2-t2sr2">Configuration du Switch2 (T2SR2)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id6">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#serveur-active-directory"><strong>Serveur Active Directory</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id7">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id8">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">Environnement</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id10">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fixer-ladresse-ip">Fixer l’adresse IP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linstallation-active-directory">L’installation Active Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#promouvoir-le-serveur-en-controleur-de-domaine">Promouvoir le serveur en contrôleur de domaine</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creation-des-utilisateurs">Création des utilisateurs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#creer-les-utilisateurs-manuellement">Créer les utilisateurs manuellement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#creer-automatiquement-les-utilisateurs-a-partir-dun-fichier-csv">Créer automatiquement les utilisateurs à partir d’un fichier csv.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-du-serveur-dns">Installation du serveur DNS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#joindre-un-client-linux-dans-active-directory">Joindre un client linux dans Active Directory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installation-des-package-necessaires-sur-des-distributions-basees-sur-debian">Installation des package nécessaires sur des distributions basées sur Debian</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installation-des-package-necessaires-sur-des-distributions-basees-sur-centos-freepbx">Installation des package nécessaires sur des distributions basées sur CentOS (FreePBX)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#joindre-le-serveur-ad">Joindre le serveur AD</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id11">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#serveur-nagios"><strong>Serveur NAGIOS</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id12">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id13">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id15">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id16">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#finalisation-du-linstallation">Finalisation du l’installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrer-active-directory-dans-nagios">Intégrer Active Directory dans NAGIOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-openssh-sur-windows-serveur-2019">Installation OpenSSH sur Windows Serveur 2019</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deployer-lagent-nagios-sur-windows-server">Déployer l’agent Nagios sur Windows Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ajouter-un-windows-serveur-2019-adds-a-surveiller">Ajouter un Windows serveur 2019 (ADDS) à surveiller</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deployer-lagent-nagios-sur-serveur-ubuntu-samba">Déployer l’agent Nagios sur Serveur Ubuntu (SAMBA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrer-nagios-dans-active-directory">Intégrer Nagios dans Active Directory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id17">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#serveur-pfsense"><strong>Serveur pfSense</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id18">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id19">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id20">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">Documentation :</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id22">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id23">Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuration-les-adresse-ip-du-pfsense">Configuration les adresse IP du pfSense</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-du-pfsense">Configuration du pfSense</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#configuration-generale">Configuration générale</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configurations-acces-au-serveur">Configurations accès au serveur</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-serveur-dhcp">Configuration serveur DHCP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#connexion-et-authentification-par-active-directory">Connexion et authentification par Active Directory</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mise-en-place-serveur-proxy">Mise en place serveur Proxy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#activation-squid-proxy">Activation Squid Proxy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-squidgard">Configuration SquidGard</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-du-firewall">Configuration du firewall</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creer-firewall-aliases">Créer Firewall Aliases</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mise-en-place-portail-captif">Mise en Place Portail Captif</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id24">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#serveur-veeam-backup"><strong>Serveur VEEAM Backup</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id25">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id26">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id27">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id28">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id29">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id30">Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#connexion-au-serveur">Connexion au serveur</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ajout-dun-dossier-de-sauvegarde">Ajout d’un dossier de sauvegarde</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creation-dun-backup-job">Création d’un Backup Job</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sauvegarder-le-serveur-ad">Sauvegarder le Serveur AD</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sauvegarder-une-vm-linux">Sauvegarder une VM Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sauvegarder-une-vm-windows">Sauvegarder une VM Windows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#restaurer-dun-fichier">Restaurer d’un fichier</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#restaurer-dun-fichier-dun-vm-linux">Restaurer d’un fichier d’un VM Linux</a></li>
<li class="toctree-l4"><a class="reference internal" href="#restaurer-dun-fichier-dun-vm-windows">Restaurer d’un fichier d’un VM Windows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id31">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#serveur-exchange-2019"><strong>Serveur Exchange 2019</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id32">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id33">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id34">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id35">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id36">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration-deuxieme-controleur-de-domaine">Configuration deuxième contrôleur de domaine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id37">Fixer l’adresse IP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#entrer-le-serveur-dans-le-domaine">Entrer le serveur dans le domaine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#installation-microsoft-exchange">Installation Microsoft Exchange</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prerequis">Prérequis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installation-microsoft-exchange-iso">Installation Microsoft Exchange ISO</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-du-serveur">Configuration du serveur</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configurer-outlook">Configurer Outlook</a></li>
<li class="toctree-l4"><a class="reference internal" href="#acces-a-webmail">Accès à Webmail</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-la-messagerie-avec-thunderbird">Configuration la messagerie avec Thunderbird</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id38">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#serveur-cups-impression"><strong>Serveur CUPS (impression)</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id39">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id40">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id41">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id42">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id43">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration-cups">Configuration CUPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ajouter-une-imprimante">Ajouter une imprimante</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ajouter-une-imprimante-aux-clients">Ajouter une imprimante aux clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrer-le-serveur-dimpression-dans-active-directory">Intégrer le serveur d’impression dans Active Directory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id44">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#serveur-glpi"><strong>Serveur GLPI</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id45">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id46">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id47">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id48">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id49">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration-du-conteneur">Configuration du conteneur</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mise-a-jour-et-installation-des-paquets-necessaires">Mise à jour et installation des paquets nécessaires</a></li>
<li class="toctree-l3"><a class="reference internal" href="#telechargement-du-paquet-glpi-9-5-6">Téléchargement du paquet GLPI 9.5.6</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creation-de-la-base-de-donnees">Création de la base de données</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-du-version-glpi-10-0-2">Installation du version GLPI 10.0.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#connecter-le-serveur-glpi-avec-une-active-directory">Connecter le serveur GLPI avec une Active Directory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installation-plugin-fusioninventory-sur-glpi-9-5-6">Installation plugin fusioninventory sur GLPI 9.5.6</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#installation-fusioninventory-agent-sur-linux">Installation fusioninventory agent sur linux</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#forcer-la-synchronisation-du-lagent">Forcer la synchronisation du l’agent</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#installation-fusioninventory-agent-sur-windows">Installation fusioninventory agent sur Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrer-glpi-dans-active-directory">Intégrer GLPI dans Active Directory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id50">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#serveur-samba"><strong>Serveur SAMBA</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id51">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id52">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id53">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id54">Documentation :</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id55">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id56">Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installation-des-logiciels-dauthentification-sur-le-domaine">Installation des logiciels d’authentification sur le domaine</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creer-lespace-de-stockage-des-partages">Créer l’espace de stockage des partages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#joindre-la-machine-virtuelle-au-domaine">Joindre la machine virtuelle au domaine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installer-kerberos">Installer Kerberos</a></li>
<li class="toctree-l4"><a class="reference internal" href="#installation-samba">Installation SAMBA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#preparation-pam">Préparation PAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#montage-du-volume-logique">Montage du volume logique</a></li>
<li class="toctree-l4"><a class="reference internal" href="#definition-des-droits-dacces-avec-les-acl">Définition des droits d’accès avec les ACL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modification-du-samba">Modification du Samba</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-partage-avec-un-client-debian">Test partage avec un client Debian</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-partage-avec-un-client-windows">Test partage avec un client Windows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#integrer-samba-dans-active-directory">Intégrer Samba dans Active Directory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id57">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#serveur-zabbix"><strong>Serveur Zabbix</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id58">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id59">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id60">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id61">Documentation :</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id62">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation-de-zabbix">Installation de Zabbix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ajouter-un-host">Ajouter un Host</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linstallation-de-lagent-zabbix-sous-windows">L’installation de l’agent Zabbix sous Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#le-tableau-de-bord">Le tableau de bord</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrer-zabbix-dans-active-directory">Intégrer Zabbix dans Active Directory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id63">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#truenas"><strong>TrueNAS</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id64">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id65">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id66">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id67">Documentation :</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id68">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation-de-truenas">Installation de trueNAS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creation-dun-volume-de-stockage-dataset">Création d’un volume de stockage + dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mise-en-place-du-partage-windows-smb">Mise en place du partage Windows (SMB)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nas-et-ad">NAS et AD</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test-conclusion">TEST + Conclusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrer-truenas-dans-active-directory">Intégrer TrueNAS dans Active Directory</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#serveur-web-lamp"><strong>Serveur WEB (LAMP)</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id69">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id70">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id71">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id72">Documentation :</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id73">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation-dapache-2">Installation d’Apache 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-de-php">Installation de Php</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-de-mariadb-optionnel">Installation de MariaDB (optionnel)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rendre-disponible-une-page-web">Rendre disponible une page web</a></li>
<li class="toctree-l3"><a class="reference internal" href="#verification-de-lactivation-du-site">Vérification de l’activation du site</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrer-le-serveur-web-dans-active-directory">Intégrer le serveur WEB dans Active Directory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id74">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#freepbx"><strong>FreePBX</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id75">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id76">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id77">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id78">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id79">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation-vm-freepbx">Installation VM FreePBX</a></li>
<li class="toctree-l3"><a class="reference internal" href="#config-freepbx">Config FreePBX</a></li>
<li class="toctree-l3"><a class="reference internal" href="#freepbx-administration">FreePBX Administration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interagir-avec-le-firewall-en-ligne-de-commande">Interagir avec le firewall en ligne de commande</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ajouter-des-utilisateurs-par-extension-non-liee-a-lactive-directory">Ajouter des utilisateurs par extension (non liée à l’Active Directory)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#relier-freepbx-avec-lactive-directory">Relier FreePBX avec l’Active Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#editer-les-comptes-utilisateurs">Editer les comptes utilisateurs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#voicemail">Voicemail</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrer-freepbx-dans-active-directory">Intégrer FreePBX dans Active Directory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id80">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#serveur-ocs"><strong>Serveur OCS</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id81">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id82">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id83">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id84">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id85">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation-et-configuration-des-prerequis">Installation et configuration des prérequis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-apache2">Installation Apache2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-mariadb">Installation Mariadb</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-ocs-inventory">Installation OCS Inventory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-du-serveur">Installation du serveur</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-du-serveur-ocs">Configuration du serveur OCS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#activation-de-la-configuration-de-ocs">Activation de la configuration de OCS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parametrer-ocs">Paramétrer OCS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-ocs-avec-glpi-10-0-2">Configuration OCS avec GLPI 10.0.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ajout-serveur-ocs">Ajout serveur OCS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-ssl">Configuration SSL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-ocs-inventory-agent-sur-windows">Installation OCS Inventory agent sur Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installation-ocs-inventory-agent-sur-linux">Installation OCS Inventory agent sur Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="#importer-linventaire-dans-glpi-10-0-2">Importer l’inventaire dans GLPI 10.0.2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integrer-le-serveur-ocs-dans-active-directory">Intégrer le serveur OCS dans Active Directory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id86">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#documentation-avec-sphinx"><strong>Documentation avec Sphinx</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id87">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id88">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id89">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id90">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id91">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pandoc">Pandoc</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id92">Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conversion-dun-docx-en-markdown-avec-les-images">Conversion d’un docx en Markdown avec les images</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#secure-copy-protocol">Secure Copy Protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sphinx-python-documentation-generator">Sphinx Python Documentation Generator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#installation-de-pip">Installation de pip</a></li>
<li class="toctree-l4"><a class="reference internal" href="#documentation-de-sphinx">Documentation de sphinx</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generation-dun-projet-avec-sphinx">Génération d’un projet avec sphinx</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modifier-le-theme">Modifier le thème</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ajout-du-contenu-au-site-de-documentation-fichier-markdown">Ajout du contenu au site de documentation (fichier markdown)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id93">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#pingcastle"><strong>PingCastle</strong></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id94">Objectif et environnement</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id95">Objectif</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id96">Environnement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id97">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id98">Processus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#telechargement">Téléchargement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#realisation-dun-audit-ad">Réalisation d’un audit AD</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lecture-du-rapport-de-laudit-ad">Lecture du rapport de l’audit AD</a></li>
<li class="toctree-l3"><a class="reference internal" href="#planifier-un-audit-regulier-de-lad-avec-pingcastle">Planifier un audit régulier de l’AD avec PingCastle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id99">Conclusion</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Documentation Projet Cluster Proxmox</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li><strong>Récapitulatif des matériels et logiciels</strong></li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cluster.md.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="recapitulatif-des-materiels-et-logiciels">
<h1><strong>Récapitulatif des matériels et logiciels</strong><a class="headerlink" href="#recapitulatif-des-materiels-et-logiciels" title="Lien permanent vers cette rubrique"></a></h1>
<section id="logiciels">
<h2>Logiciels<a class="headerlink" href="#logiciels" title="Lien permanent vers cette rubrique"></a></h2>
<p><img src="./media/image1.png"
style="width:6.27014in;height:2.69444in" /></p>
</section>
<section id="materiels">
<h2>Matériels<a class="headerlink" href="#materiels" title="Lien permanent vers cette rubrique"></a></h2>
<p><img src="./media/image2.png"
style="width:6.27014in;height:1.32847in" /></p>
</section>
<section id="adressage-ip">
<h2>Adressage IP<a class="headerlink" href="#adressage-ip" title="Lien permanent vers cette rubrique"></a></h2>
<p><img src="./media/image3.png"
style="width:6.27014in;height:2.94097in" /></p>
</section>
<section id="schema-du-deploiement">
<h2>Schéma du déploiement<a class="headerlink" href="#schema-du-deploiement" title="Lien permanent vers cette rubrique"></a></h2>
<p><img src="./media/image4.png"
style="width:6.27083in;height:7.83333in" /></p>
</section>
</section>
<section id="serveur-proxmox">
<h1><strong>Serveur Proxmox</strong><a class="headerlink" href="#serveur-proxmox" title="Lien permanent vers cette rubrique"></a></h1>
<section id="objectif-et-environnement">
<h2>Objectif et environnement<a class="headerlink" href="#objectif-et-environnement" title="Lien permanent vers cette rubrique"></a></h2>
<section id="objectif">
<h3>Objectif<a class="headerlink" href="#objectif" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>Installation et configuration d’un cluster Proxmox avec trois
serveurs en haute disponibilité sur serveurs. Tolérance de panne
d’un serveur.</p></li>
</ol>
</section>
<section id="environnement">
<h3>Environnement<a class="headerlink" href="#environnement" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>3 x Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseau interne : 172.16.0.0/16</p></li>
<li><p>IP internes : 172.28.1.250, 172.28.1.250, 172.28.1.250</p></li>
<li><p>Réseau externe : 192.168.10.xx/26 (en DHCP fournie par le PEI)</p></li>
</ul>
</section>
<section id="documentation">
<h3>Documentation :<a class="headerlink" href="#documentation" title="Lien permanent vers cette rubrique"></a></h3>
<p><a class="reference external" href="https://www.youtube.com/watch?app=desktop&amp;v=Y-n73ciSsZw">https://www.youtube.com/watch?app=desktop&amp;v=Y-n73ciSsZw</a></p>
</section>
<section id="configuration-prealable">
<h3>Configuration préalable<a class="headerlink" href="#configuration-prealable" title="Lien permanent vers cette rubrique"></a></h3>
<p><strong>Nous allons utiliser des disques formattés en Ceph pour la haute
disponibilité. Ces disques doivent être non RAID ou RAID0 à 1 disque,
sinon Ceph ne pourra pas s’installer.</strong></p>
</section>
</section>
<section id="processus">
<h2>Processus<a class="headerlink" href="#processus" title="Lien permanent vers cette rubrique"></a></h2>
<section id="creation-dun-cluster">
<h3>Création d’un Cluster<a class="headerlink" href="#creation-dun-cluster" title="Lien permanent vers cette rubrique"></a></h3>
<p>Nous avons créé un cluster sur le 1<sup>er</sup>
serveur (172.28.1.250/16) :</p>
<img src="./media/image5.png" style="width:6.2092in;height:1.3231in" /><p>Nommé le cluster puis create :</p>
<p><img src="./media/image6.png"
style="width:5.24031in;height:1.77108in" /></p>
<p>Le cluster a été correctement créé :</p>
<p><img src="./media/image7.png"
style="width:6.27014in;height:1.73819in" /></p>
<p>Une fois le cluster créé, nous avons copié join information (clé
d’agrégation)</p>
<p><img src="./media/image8.png"
style="width:6.27014in;height:1.96806in" /></p>
<p>Sur le 2<sup>e</sup> serveur (pve2 : 172.28.1.251/16)</p>
<p>Menu Cluster &gt; Joindre le cluster</p>
<p><img src="./media/image9.png"
style="width:5.58148in;height:2.09313in" /></p>
<p>Le serveur est bien arrivé sur le cluster. Nous avons fait la même
manipulation pour le 3<sup>e</sup> serveur (172.28.1.252/16).</p>
<p><img src="./media/image10.png"
style="width:6.27014in;height:1.23819in" /></p>
<section id="installation-ceph">
<h4>Installation Ceph<a class="headerlink" href="#installation-ceph" title="Lien permanent vers cette rubrique"></a></h4>
<p>Installation Ceph sur les serveurs</p>
<p>Menu &gt; Ceph</p>
<p><img src="./media/image11.png"
style="width:1.88568in;height:0.89596in" /></p>
<p><img src="./media/image12.png"
style="width:3.22762in;height:2.28085in" /></p>
<p><img src="./media/image13.png"
style="width:3.97535in;height:2.80066in" /></p>
<p>Nous avons installé Ceph sur les deux autres serveurs également.</p>
<p><img src="./media/image14.png"
style="width:3.95585in;height:2.79081in" /></p>
<p><img src="./media/image15.png"
style="width:3.97031in;height:2.80635in" /></p>
</section>
<section id="ajout-des-monitors-et-managers">
<h4>Ajout des Monitors et Managers<a class="headerlink" href="#ajout-des-monitors-et-managers" title="Lien permanent vers cette rubrique"></a></h4>
<p>Cette fonctionnalité donne des droits pour afficher et manager les
différents serveurs Proxmox.</p>
<p>Menu &gt; Ceph &gt; Monitor</p>
<p><img src="./media/image16.png"
style="width:6.27014in;height:0.95278in" /></p>
<p><img src="./media/image17.png"
style="width:2.60453in;height:1.11474in" /></p>
<p><img src="./media/image18.png"
style="width:5.71955in;height:1.56272in" /></p>
<p><img src="./media/image19.png"
style="width:2.59411in;height:1.11474in" /></p>
<p><img src="./media/image20.png"
style="width:5.56328in;height:1.57314in" /></p>
</section>
<section id="creation-dun-pool-de-stockage">
<h4>Création d’un pool de stockage<a class="headerlink" href="#creation-dun-pool-de-stockage" title="Lien permanent vers cette rubrique"></a></h4>
<p>Menu Ceph &gt; OSD &gt; Create OSD</p>
<p><img src="./media/image21.png"
style="width:5.25073in;height:1.76066in" /></p>
<p><img src="./media/image22.png"
style="width:6.27014in;height:0.97778in" /></p>
<p>Nous avons effectué la même manipulation sur les deux autres serveurs.</p>
<p><img src="./media/image23.png"
style="width:6.27014in;height:1.49722in" /></p>
</section>
<section id="creation-dun-pool">
<h4>Création d’un pool<a class="headerlink" href="#creation-dun-pool" title="Lien permanent vers cette rubrique"></a></h4>
<p>Menu &gt; Ceph &gt; Pools</p>
<p><img src="./media/image24.png"
style="width:5.24031in;height:2.50035in" /></p>
<p><img src="./media/image25.png"
style="width:5.82092in;height:2.34861in" /></p>
<p>Ceph stockage a été créé.</p>
</section>
<section id="mise-en-place-de-la-haute-disponibilite-ha">
<h4>Mise en place de la haute disponibilité (HA)<a class="headerlink" href="#mise-en-place-de-la-haute-disponibilite-ha" title="Lien permanent vers cette rubrique"></a></h4>
<p>Menu &gt; HA &gt; Groups</p>
<p><img src="./media/image26.png"
style="width:3.28802in;height:2.70624in" /></p>
<p><img src="./media/image27.png"
style="width:3.23946in;height:2.64051in" /></p>
<p><img src="./media/image28.png"
style="width:3.43048in;height:2.80738in" /></p>
</section>
<section id="test-de-la-migration-dune-vm">
<h4>Test de la migration d’une VM<a class="headerlink" href="#test-de-la-migration-dune-vm" title="Lien permanent vers cette rubrique"></a></h4>
<p>Nous avons créé un conteneur test sur le pve1</p>
<p><img src="./media/image29.png"
style="width:5.24031in;height:1.29185in" /></p>
<p>Nous avons ajouté le conteneur dans la haute disponibilité pve1-ha</p>
<p><img src="./media/image30.png"
style="width:3.79412in;height:1.60029in" /></p>
<p><img src="./media/image31.png"
style="width:6.27014in;height:1.82083in" /></p>
<p>Nous avons arrêté le pve1.</p>
<p><img src="./media/image32.png"
style="width:2.26268in;height:2.59265in" /></p>
<p>Le conteneur est bien arrivé sur le pv3. Par la suite nous avons rallumé
pve1.</p>
<p><img src="./media/image33.png"
style="width:2.47951in;height:2.20864in" /></p>
<p>Le conteneur est retourné automatiquement sur pve1(3 min après avoir
démarré pv1).</p>
</section>
<section id="test-de-la-haute-disponibilite-lors-dune-coupure-dun-serveur">
<h4>Test de la haute disponibilité lors d’une coupure d’un serveur<a class="headerlink" href="#test-de-la-haute-disponibilite-lors-dune-coupure-dun-serveur" title="Lien permanent vers cette rubrique"></a></h4>
<p>Nous avons lancé une copie d’un fichier volumineux à partir de la
partition D:\ du l’AD sur le pve1 vers un dossier partage se trouvant
sur le serveur SAMBA sur le pve3.</p>
<p><img src="./media/image34.png"
style="width:3.76525in;height:1.29167in" /><img src="./media/image35.png"
style="width:1.97291in;height:3.69502in" /></p>
<p><img src="./media/image36.png"
style="width:5.50339in;height:2.41433in" /></p>
<p>En paralelle, nous avons lancé un ping continue depuis CLI-DEB-01 sur
pve3 vers <a class="reference external" href="http://www.google.com">www.google.com</a>. Le client accède à
l’internet via FW-PROXY se trouvant sur le pve1.</p>
<p><img src="./media/image37.png"
style="width:4.29037in;height:1.52445in" /></p>
<p><strong>NB</strong> : chaque VM possède un snapshot avec sa dernière bonne
configuration. Lors d’une migration, la VM bascule avec son snapshot !</p>
<p>Configuration des groupes HA</p>
<p><img src="./media/image38.png"
style="width:5.20906in;height:1.22934in" /></p>
<p>Ajout des ressources pour effectuer le test</p>
<p><img src="./media/image39.png"
style="width:6.27014in;height:1.54375in" /></p>
<p><img src="./media/image40.png"
style="width:6.27014in;height:1.40903in" /></p>
<p>Etape1</p>
<p><img src="./media/image41.png"
style="width:3.97972in;height:1.46895in" /></p>
<p><img src="./media/image42.png"
style="width:4.81317in;height:0.64592in" /></p>
<p>Les VM sont arrivées sur le pve3</p>
<p><img src="./media/image43.png"
style="width:2.52119in;height:3.02126in" /></p>
<p><img src="./media/image44.png"
style="width:4.82359in;height:0.90638in" /></p>
<p><img src="./media/image45.png"
style="width:6.27014in;height:3.70486in" /></p>
<p>Nous avons rejoué la séquence en rebranchent le pve1</p>
<p><img src="./media/image46.png"
style="width:6.27014in;height:1.89514in" /></p>
<p><strong>Etape2</strong></p>
<p>Les VM AD et PROXY sont en état <strong>migrate</strong></p>
<p><img src="./media/image47.png"
style="width:6.27014in;height:1.94028in" /></p>
<p>Pendant la copie la migration du l’AD n’a pas été effective.</p>
<p><strong>Etape 3</strong></p>
<p>Pf a basculé complètement sans aucune coupure</p>
<p><img src="./media/image48.png"
style="width:6.27014in;height:1.61319in" /></p>
<p><img src="./media/image49.png"
style="width:6.27014in;height:1.63472in" /></p>
<p><strong>Etape 4</strong></p>
<p>Fin de la copie du fichier depuis l’AD vers le partage SAMBA.</p>
<p><img src="./media/image50.png"
style="width:6.27014in;height:1.14444in" /></p>
<p>Pendant la migration l’AD continue fournir des services, notamment la
résolution DNS. L’AD est toujours 100% fonctionnel.</p>
<p><img src="./media/image51.png"
style="width:5.53202in;height:0.76052in" /></p>
<p><strong>Etape 5</strong></p>
<p>La migration du l’AD est effective</p>
<p><img src="./media/image52.png"
style="width:2.30416in;height:3.04821in" /></p>
</section>
</section>
<section id="suppression-dun-cluster">
<h3>Suppression d’un cluster<a class="headerlink" href="#suppression-dun-cluster" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl stop corosync pve-cluster  
pmxcfs -l  
rm -rf /etc/corosync/<span class="se">\*</span>  
rm -rf /etc/pve/corosync.conf  
killall pmxcfs  
systemctl start pve-cluster
</pre></div>
</div>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Lien permanent vers cette rubrique"></a></h2>
<p>La mise en place d’un cluster est terminée. Les images concernées par la
haute disponibilité doivent être crées sur la partition répliquée prévue
à cette effet(ceph-stockage).</p>
<p>Sur Proxmox il y a une différence notable entre migration voulu ou
depuis et vers un serveur actif et migration automatique suite d’une
panne. Dans le premier cas (reprise d’activités), nous n’avons pas
constaté de coupure de service. La migration est plus lente. Lors de la
simulation d’une panne la migration est automatique avec des coupures de
service, néanmoins la migration est plus rapide.</p>
</section>
</section>
<section id="switch-3com">
<h1><strong>Switch 3COM</strong><a class="headerlink" href="#switch-3com" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id1">
<h2>Objectif et environnement<a class="headerlink" href="#id1" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id2">
<h3>Objectif<a class="headerlink" href="#id2" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>Configurer un VLAN, ports trunk et tagg sur switch 3COM.</p></li>
</ol>
</section>
<section id="id3">
<h3>Environnement<a class="headerlink" href="#id3" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>2 x Switch 3COM SuperStack 3 4500 26-port</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux VLAN 200 switch1 : 172.28.1.253/16</p></li>
<li><p>Réseaux VLAN 200 switch2 : 172.28.1.249/16</p></li>
</ul>
</section>
<section id="id4">
<h3>Documentation<a class="headerlink" href="#id4" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=DR5Ov2XgkAc">https://www.youtube.com/watch?v=DR5Ov2XgkAc</a></p></li>
<li><p><a class="reference external" href="https://www.manualslib.com/manual/232384/3com-5500g-Ei.html?page=19#manual">https://www.manualslib.com/manual/232384/3com-5500g-Ei.html?page=19#manual</a></p></li>
<li></li>
</ul>
</section>
</section>
<section id="id5">
<h2>Processus<a class="headerlink" href="#id5" title="Lien permanent vers cette rubrique"></a></h2>
<p>Nous sommes connectés sur le port série d’un ordinateur d’un côté et sur
le port Console du switch de l’autre.</p>
<p>Nous avons configuré PuTTY comme suite dans Connection / Serial :</p>
<p><img src="./media/image53.png"
style="width:3.18045in;height:3.10962in" /></p>
<p>Ensuite Session &gt; Open</p>
<p><img src="./media/image54.png"
style="width:3.20636in;height:3.1491in" /></p>
<p>Nous avons accédé à la console du switch</p>
<p><img src="./media/image55.png"
style="width:6.27014in;height:0.98264in" /></p>
<section id="administration-vlan-en-cli">
<h3>Administration VLAN en CLI<a class="headerlink" href="#administration-vlan-en-cli" title="Lien permanent vers cette rubrique"></a></h3>
</section>
<section id="creation-dun-vlan">
<h3>Création d’un VLAN<a class="headerlink" href="#creation-dun-vlan" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Passage en mode system</span>
<span class="n">system</span><span class="o">-</span><span class="n">view</span> <span class="n">ou</span> <span class="n">sys</span>  
  
<span class="c1"># Création du VLAN 200</span>
<span class="n">vlan</span> <span class="mi">200</span>  
  
<span class="c1"># Définition l’adresse IP/Sous-masque pour le VLAN 200</span>
<span class="c1"># Choix VLAN</span>
<span class="n">interface</span> <span class="n">vlan</span> <span class="mi">200</span> <span class="n">ou</span> <span class="nb">int</span> <span class="n">vlan</span> <span class="mi">200</span>

<span class="c1"># Renseigner l’adresse IP ainsi que le sous-masque</span>
<span class="n">ip</span> <span class="n">address</span> <span class="mf">172.28.1.253</span> <span class="mf">255.255.0.0</span>  
  
<span class="c1"># Ajout d’un port dans le VLAN, ici du 7 à 10</span>
<span class="n">port</span> <span class="n">Eth1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">7</span>  
<span class="n">port</span> <span class="n">Eth1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">8</span>  
<span class="n">port</span> <span class="n">Eth1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">9</span>  
<span class="n">port</span> <span class="n">Eth1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">10</span>
</pre></div>
</div>
<p>Afficher la configuration de VLAN’s</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">display</span> <span class="n">vlan</span> <span class="nb">all</span>
</pre></div>
</div>
<p><img src="./media/image56.png"
style="width:6.27014in;height:4.52778in" /></p>
<p>Une autre méthode pour afficher la configuration de ports en utilisant
la commande display brief interface</p>
<p><img src="./media/image57.png"
style="width:5.59453in;height:5.01112in" /></p>
</section>
<section id="supprimer-un-vlan">
<h3>Supprimer un VLAN<a class="headerlink" href="#supprimer-un-vlan" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mode system  </span>
<span class="n">system</span><span class="o">-</span><span class="n">view</span> <span class="n">ou</span> <span class="n">sys</span>  
<span class="c1"># Supprimer le VLAN 200  </span>
<span class="n">undo</span> <span class="n">VLAN</span> <span class="mi">200</span>
</pre></div>
</div>
</section>
<section id="administration-vlan-par-interface-web">
<h3>Administration VLAN par interface Web<a class="headerlink" href="#administration-vlan-par-interface-web" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’accède à l’interface web sur l’adresse 172.28.1.253/16</p>
<p><img src="./media/image58.png"
style="width:4.15449in;height:2.22242in" /></p>
<p>Menu &gt; Device &gt; VLAN &gt; Setup</p>
<p><img src="./media/image59.png"
style="width:4.17758in;height:1.76882in" /></p>
<p>Création d’un VLAN</p>
<p>Modify VLAN</p>
<p>VLAN 200 avec ses ports actifs</p>
<p><img src="./media/image60.png"
style="width:4.4318in;height:2.86356in" /></p>
</section>
<section id="configurer-dune-adresse-ip-en-gui">
<h3>Configurer d’une adresse IP en GUI<a class="headerlink" href="#configurer-dune-adresse-ip-en-gui" title="Lien permanent vers cette rubrique"></a></h3>
<p>Administration &gt; IP setup</p>
<p><img src="./media/image61.png"
style="width:2.92554in;height:2.35592in" /></p>
<p>VLAN1</p>
<p>Nous avons laissé en mode DHCP</p>
<p><img src="./media/image62.png"
style="width:3.31232in;height:2.68427in" /></p>
<p>VLAN 200</p>
<p><img src="./media/image63.png"
style="width:3.50511in;height:2.83507in" /></p>
</section>
<section id="creer-un-trunk-sur-un-port">
<h3>Créer un Trunk sur un port<a class="headerlink" href="#creer-un-trunk-sur-un-port" title="Lien permanent vers cette rubrique"></a></h3>
<p>Cela permet de faire communiquer deux switches et faire passer plusieurs
VLAN</p>
<p>Switch 1</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Choix de l’interface  </span>
<span class="n">Interface</span> <span class="n">GigabitEthernet1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">28</span>  
<span class="c1"># Changer le type de link  </span>
<span class="n">port</span> <span class="n">link</span><span class="o">-</span><span class="nb">type</span> <span class="n">trunk</span>  
<span class="c1"># Ajouter dans les VLAN souhaités  </span>
<span class="n">port</span> <span class="n">trunk</span> <span class="n">permit</span> <span class="n">vlan</span> <span class="mi">1</span> <span class="mi">200</span>
</pre></div>
</div>
<p>Configuration des ports actuel</p>
<p><img src="./media/image64.png"
style="width:5.61537in;height:5.33408in" /></p>
</section>
<section id="tagger-un-port">
<h3>Tagger un port<a class="headerlink" href="#tagger-un-port" title="Lien permanent vers cette rubrique"></a></h3>
<p>Pour interconnecter les deux switches, nous avons tagué les ports 28 sur
chacun</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">interface</span> <span class="n">GigabitEthernet1</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">28</span>
<span class="n">port</span> <span class="n">link</span><span class="o">-</span><span class="nb">type</span> <span class="n">hybrid</span>  
<span class="n">port</span> <span class="n">hybrid</span> <span class="n">vlan</span> <span class="mi">1</span> <span class="mi">200</span> <span class="n">tagged</span>
</pre></div>
</div>
</section>
<section id="cisco-packet-tracer">
<h3>Cisco Packet Tracer<a class="headerlink" href="#cisco-packet-tracer" title="Lien permanent vers cette rubrique"></a></h3>
</section>
<section id="schema-du-reseau">
<h3>Schéma du réseau<a class="headerlink" href="#schema-du-reseau" title="Lien permanent vers cette rubrique"></a></h3>
<p><img src="./media/image65.png"
style="width:3.74555in;height:4.00044in" /></p>
</section>
<section id="configuration-du-switch1-t2sr">
<h3>Configuration du Switch1 (T2SR)<a class="headerlink" href="#configuration-du-switch1-t2sr" title="Lien permanent vers cette rubrique"></a></h3>
<p>Nous avons exécuté les commandes suivantes pour créer le VLAN 200</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Entrer dans mode Privileged EXEC  </span>
<span class="n">enable</span>  

<span class="c1"># Entrer dans le mode configuration  </span>
<span class="n">config</span>  

<span class="c1"># Choix terminal </span>
<span class="n">terminal</span>  

<span class="c1"># Configuration du VLAN </span>
<span class="n">vlan</span> <span class="mi">200</span>  

<span class="c1"># Ajouter le port 0/7 dans le VLAN 200 </span>
<span class="n">interface</span> <span class="n">FastEthernet0</span><span class="o">/</span><span class="mi">7</span> 

<span class="c1"># Mettre en mode accesible</span>
<span class="n">switchport</span> <span class="n">mode</span> <span class="n">access</span> 

<span class="c1"># Donner accès au port pour le VLAN 200 </span>
<span class="n">switchport</span> <span class="n">access</span> <span class="n">vlan</span> <span class="mi">200</span> 

<span class="c1"># Quitter la configuration</span>
<span class="n">end</span>
</pre></div>
</div>
<p><img src="./media/image66.png"
style="width:5.93833in;height:1.77108in" /></p>
<p>Nous avons effectué les mêmes commandes pour les ports 8 à 10, puis nous
avons vérifié la configuration des ports avec la commande</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sh</span> <span class="n">run</span>
</pre></div>
</div>
<p><img src="./media/image67.png"
style="width:2.13572in;height:1.6669in" /></p>
<p>Nous avons créé un trunk entre vlan 1 et 200 sur le port
GigabitEthernet2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">enable</span>

<span class="n">config</span> <span class="p">(</span><span class="n">choisir</span> <span class="n">terminal</span><span class="p">)</span>

<span class="n">interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">2</span>  
<span class="n">switchport</span> <span class="n">access</span> <span class="n">vlan</span> <span class="mi">200</span>  
<span class="n">switchport</span> <span class="n">mode</span> <span class="n">trunk</span>

<span class="n">sh</span> <span class="n">run</span>
</pre></div>
</div>
<p><img src="./media/image68.png"
style="width:2.42742in;height:0.59383in" /></p>
<p>Nous pouvons obtenir les mêmes résultats en mode GUI</p>
<p><strong>Menu Config</strong></p>
<p><img src="./media/image69.png"
style="width:5.68192in;height:1.77714in" /></p>
</section>
<section id="configuration-du-switch2-t2sr2">
<h3>Configuration du Switch2 (T2SR2)<a class="headerlink" href="#configuration-du-switch2-t2sr2" title="Lien permanent vers cette rubrique"></a></h3>
<p>Nous avons exécuté les commandes suivantes pour créer le VLAN 200</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Entrer dans mode Privileged EXEC  </span>
<span class="n">enable</span> 

<span class="c1"># Entrer dans le mode configuration  </span>
<span class="n">config</span>  

<span class="c1"># Choix terminal</span>
<span class="n">terminal</span>

<span class="c1"># Configuration du VLAN </span>
<span class="n">vlan</span> <span class="mi">200</span>
</pre></div>
</div>
<p>Nous avons créé un trunk pour faire passer le VLAN 200 sur le port
FastEthernet1 et 2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">enable</span>

<span class="n">config</span> <span class="p">(</span><span class="n">choisir</span> <span class="n">terminal</span><span class="p">)</span>

<span class="n">interface</span> <span class="n">FastEthernet0</span><span class="o">/</span><span class="mi">1</span>  
<span class="n">switchport</span> <span class="n">access</span> <span class="n">vlan</span> <span class="mi">200</span>  
<span class="n">switchport</span> <span class="n">mode</span> <span class="n">trunk</span>

<span class="n">interface</span> <span class="n">FastEthernet0</span><span class="o">/</span><span class="mi">2</span>  
<span class="n">switchport</span> <span class="n">access</span> <span class="n">vlan</span> <span class="mi">200</span>  
<span class="n">switchport</span> <span class="n">mode</span> <span class="n">trunk</span>

<span class="n">sh</span> <span class="n">run</span>
</pre></div>
</div>
<p><img src="./media/image70.png"
style="width:2.19822in;height:0.88554in" /></p>
<p>Nous avons créé un trunk entre vlan 1 et 200 sur le port
GigabitEthernet2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">enable</span>

<span class="n">config</span> <span class="p">(</span><span class="n">choisir</span> <span class="n">terminal</span><span class="p">)</span>

<span class="n">interface</span> <span class="n">GigabitEthernet0</span><span class="o">/</span><span class="mi">2</span>  
<span class="n">switchport</span> <span class="n">access</span> <span class="n">vlan</span> <span class="mi">200</span>  
<span class="n">switchport</span> <span class="n">mode</span> <span class="n">trunk</span>

<span class="n">sh</span> <span class="n">run</span>
</pre></div>
</div>
<p><img src="./media/image68.png"
style="width:2.42742in;height:0.59383in" /></p>
</section>
</section>
<section id="id6">
<h2>Conclusion<a class="headerlink" href="#id6" title="Lien permanent vers cette rubrique"></a></h2>
<p>La configuration des switches est correctement déroulée. Nombreuses
tâches sont plus aisées à faire en GUI, d’autres en CLI. La
configuration en CLI est privilégiée.</p>
</section>
</section>
<section id="serveur-active-directory">
<h1><strong>Serveur Active Directory</strong><a class="headerlink" href="#serveur-active-directory" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id7">
<h2>Objectif et environnement<a class="headerlink" href="#id7" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id8">
<h3>Objectif<a class="headerlink" href="#id8" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>L’installation d’un Active Directory sur Windows Server 2019.</p></li>
</ol>
</section>
<section id="id9">
<h3>Environnement<a class="headerlink" href="#id9" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.28.0.0/16</p></li>
<li><p>Active Directory sur Windows serveur 2019 : 172.28.1.200/16</p></li>
</ul>
</section>
</section>
<section id="id10">
<h2>Processus<a class="headerlink" href="#id10" title="Lien permanent vers cette rubrique"></a></h2>
<section id="fixer-ladresse-ip">
<h3>Fixer l’adresse IP<a class="headerlink" href="#fixer-ladresse-ip" title="Lien permanent vers cette rubrique"></a></h3>
<p>Avant d’installer Active Directory, j’ai fixé l’adresse IP du serveur
somme suite</p>
<p><img src="./media/image71.png"
style="width:2.25601in;height:2.54437in" /></p>
</section>
<section id="linstallation-active-directory">
<h3>L’installation Active Directory<a class="headerlink" href="#linstallation-active-directory" title="Lien permanent vers cette rubrique"></a></h3>
<p>Dans la Gestion de serveur / Tableau de bord / Gérer / Ajouter des rôles
et fonctionnalités</p>
<p><img src="./media/image72.png"
style="width:3.12544in;height:1.57314in" /></p>
<p>J’ai choisi installation basée sur un rôle</p>
<p><img src="./media/image73.png"
style="width:4.20966in;height:2.99791in" /></p>
<p>Choix du serveur</p>
<p><img src="./media/image74.png"
style="width:3.79691in;height:2.71238in" /></p>
<p>Choix rôle AD DS (Active Directory Domain Service)</p>
<p><img src="./media/image75.png"
style="width:2.71241in;height:2.87531in" /></p>
<p>J’ai validé l’ajout du rôle</p>
<p><img src="./media/image76.png"
style="width:2.39197in;height:2.50669in" /></p>
<p><img src="./media/image77.png"
style="width:2.88996in;height:3.10824in" /></p>
<p>J’ai laissé par défaut le choix des fonctionnalités</p>
<p><img src="./media/image78.png"
style="width:2.1726in;height:2.32966in" /></p>
<p>Début de l’installation</p>
<p><img src="./media/image79.png"
style="width:3.63562in;height:1.79156in" /></p>
</section>
<section id="promouvoir-le-serveur-en-controleur-de-domaine">
<h3>Promouvoir le serveur en contrôleur de domaine<a class="headerlink" href="#promouvoir-le-serveur-en-controleur-de-domaine" title="Lien permanent vers cette rubrique"></a></h3>
<p>Une fois installé, j’ai promu le serveur en contrôleur de domaine</p>
<p><img src="./media/image80.png"
style="width:2.34083in;height:2.14464in" /></p>
<p>Le nom du domaine racine est <strong>t2sr.io</strong></p>
<p><img src="./media/image81.png"
style="width:3.78873in;height:2.79675in" /></p>
<p>J’ai décoché serveur DNS (n’est pas encore configuré) et renseigné le
mot de passe DSRM.</p>
<p><img src="./media/image82.png"
style="width:4.0016in;height:2.95256in" /></p>
<p>Le nom de domaine NetBIOS renseigné automatiquement</p>
<p><img src="./media/image83.png"
style="width:4.76108in;height:0.72927in" /></p>
<p>J’ai laissé par défaut l’emplacement de la base de données AD DS</p>
<p><img src="./media/image84.png"
style="width:5.58411in;height:1.17725in" /></p>
<p>Après vérification, j’ai lancé l’installation</p>
<p><img src="./media/image85.png"
style="width:3.68788in;height:2.70924in" /></p>
<p>A la fin de l’installation le serveur redémarre.</p>
</section>
<section id="creation-des-utilisateurs">
<h3>Création des utilisateurs<a class="headerlink" href="#creation-des-utilisateurs" title="Lien permanent vers cette rubrique"></a></h3>
<section id="creer-les-utilisateurs-manuellement">
<h4>Créer les utilisateurs manuellement<a class="headerlink" href="#creer-les-utilisateurs-manuellement" title="Lien permanent vers cette rubrique"></a></h4>
<p>Outils d’administration / Utilisateurs et ordinateurs Active Directory /
Users / Nouveau / Utilisateur</p>
<p><img src="./media/image86.png"
style="width:6.27014in;height:3.16389in" /></p>
<p><img src="./media/image87.png"
style="width:2.40625in;height:2.09375in" /></p>
<p>J’ai renseigné un mot de passe par défaut que l’utilisateur doit changer
lors de la première connexion.</p>
<p><img src="./media/image88.png"
style="width:2.42708in;height:2.10417in" /></p>
</section>
</section>
<section id="creer-automatiquement-les-utilisateurs-a-partir-dun-fichier-csv">
<h3>Créer automatiquement les utilisateurs à partir d’un fichier csv.<a class="headerlink" href="#creer-automatiquement-les-utilisateurs-a-partir-dun-fichier-csv" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’ai créé avec Microsoft Excel un tableau csv avec les stagiaires</p>
<p><img src="./media/image89.png"
style="width:6.27014in;height:2.46875in" /></p>
<p>Ensuite j’ai créé un script PowerShell pour automatiser la création des
utilisateurs.</p>
<p>Le script :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">\</span><span class="nv">$CSVFile</span> <span class="p">=</span> <span class="s2">&quot;C:\Users\Administrateur\Desktop\Annuaire.csv&quot;</span>  
<span class="p">\</span><span class="nv">$CSVData</span> <span class="p">=</span> <span class="nb">Import-CSV</span> <span class="n">-Path</span> <span class="p">\</span><span class="nv">$CSVFile</span> <span class="n">-Delimiter</span> <span class="s2">&quot;;&quot;</span> <span class="n">-Encoding</span> <span class="n">UTF8</span>  
  
<span class="k">Foreach</span><span class="p">(\</span><span class="nv">$Utilisateur</span> <span class="k">in</span> <span class="p">\</span><span class="nv">$CSVData</span><span class="p">){</span>  
  
    <span class="p">\</span><span class="nv">$Prenom</span> <span class="p">=</span> <span class="p">\</span><span class="nv">$Utilisateur</span><span class="p">.</span><span class="n">Prenom</span>  
    <span class="p">\</span><span class="nv">$Initiales</span> <span class="p">=</span> <span class="p">\</span><span class="nv">$Utilisateur</span><span class="p">.</span><span class="n">Initiales</span>  
    <span class="p">\</span><span class="nv">$Nom</span> <span class="p">=</span> <span class="p">\</span><span class="nv">$Utilisateur</span><span class="p">.</span><span class="n">Nom</span>  
    <span class="p">\</span><span class="nv">$NomComplet</span> <span class="p">=</span> <span class="p">\</span><span class="nv">$Utilisateur</span><span class="p">.</span><span class="n">NomComplet</span>  
    <span class="p">\</span><span class="nv">$Description</span> <span class="p">=</span> <span class="p">\</span><span class="nv">$Utilisateur</span><span class="p">.</span><span class="n">Description</span>  
    <span class="p">\</span><span class="nv">$Telephone</span> <span class="p">=</span> <span class="p">\</span><span class="nv">$Utilisateur</span><span class="p">.</span><span class="n">Telephone</span>  
    <span class="p">\</span><span class="nv">$Adresse</span> <span class="p">=</span> <span class="p">\</span><span class="nv">$Utilisateur</span><span class="p">.</span><span class="n">Adresse</span>  
    <span class="p">\</span><span class="nv">$Ville</span> <span class="p">=</span> <span class="p">\</span><span class="nv">$Utilisateur</span><span class="p">.</span><span class="n">Ville</span>  
    <span class="p">\</span><span class="nv">$Departement</span> <span class="p">=</span> <span class="p">\</span><span class="nv">$Utilisateur</span><span class="p">.</span><span class="n">Departement</span>  
    <span class="p">\</span><span class="nv">$CodePostale</span> <span class="p">=</span> <span class="p">\</span><span class="nv">$Utilisateur</span><span class="p">.</span><span class="n">CodePostale</span>  
    <span class="p">\</span><span class="nv">$Login</span> <span class="p">=</span> <span class="p">(\</span><span class="nv">$Prenom</span><span class="p">).</span><span class="n">Substring</span><span class="p">(</span><span class="n">0</span><span class="p">,</span><span class="n">1</span><span class="p">)</span> <span class="p">+</span> <span class="s2">&quot;.&quot;</span> <span class="p">+</span> <span class="p">\</span><span class="nv">$Nom</span>  
    <span class="p">\</span><span class="nv">$Email</span> <span class="p">=</span> <span class="s2">&quot;\$Login@t2sr.net&quot;</span>  
    <span class="p">\</span><span class="nv">$MotDePasse</span> <span class="p">=</span> <span class="s2">&quot;Azerty123+&quot;</span>  
    <span class="p">\</span><span class="nv">$Bureau</span> <span class="p">=</span> <span class="s2">&quot;T2SR&quot;</span>  
    <span class="p">\</span><span class="nv">$Pays</span> <span class="p">=</span> <span class="s2">&quot;FR&quot;</span>  
  
    <span class="p">*\</span><span class="c"># Vérifier la présence de l&#39;utilisateur dans l&#39;AD*  </span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">{</span><span class="n">SamAccountName</span> <span class="o">-eq</span> <span class="p">\</span><span class="nv">$Login</span><span class="p">})</span>  
    <span class="p">{</span>  
        <span class="nb">Write-Warning</span> <span class="s2">&quot;L&#39;identifiant \$Login existe déjà dans l&#39;AD&quot;</span>  
    <span class="p">}</span>  
    <span class="k">else</span>  
    <span class="p">{</span>  
        <span class="nb">New-ADUser</span>  <span class="n">-Name</span> <span class="s2">&quot;\$Prenom&quot;</span> <span class="p">\`</span>  
                    <span class="n">-GivenName</span> <span class="s2">&quot;\$Prenom&quot;</span> <span class="p">\`</span>  
                    <span class="n">-Initials</span> <span class="s2">&quot;\$Initiales&quot;</span> <span class="p">\`</span>  
                    <span class="n">-Surname</span> <span class="s2">&quot;\$Nom&quot;</span> <span class="p">\`</span>  
                    <span class="n">-DisplayName</span> <span class="s2">&quot;\$Prenom \$Nom&quot;</span> <span class="p">\`</span>  
                    <span class="n">-Description</span> <span class="s2">&quot;\$Description&quot;</span> <span class="p">\`</span>  
                    <span class="n">-StreetAddress</span> <span class="s2">&quot;\$Adresse&quot;</span> <span class="p">\`</span>  
                    <span class="n">-City</span> <span class="s2">&quot;\$Ville&quot;</span> <span class="p">\`</span>  
                    <span class="n">-Country</span> <span class="s2">&quot;\$Pays&quot;</span> <span class="p">\`</span>  
                    <span class="n">-OfficePhone</span> <span class="s2">&quot;\$Telephone&quot;</span> <span class="p">\`</span>  
                    <span class="n">-PostalCode</span> <span class="s2">&quot;\$CodePostale&quot;</span> <span class="p">\`</span>  
                    <span class="n">-SamAccountName</span> <span class="s2">&quot;\$Login&quot;</span> <span class="p">\`</span>  
                    <span class="n">-UserPrincipalName</span> <span class="s2">&quot;\$Login@t2sr.net&quot;</span> <span class="p">\`</span>  
                    <span class="n">-EmailAddress</span> <span class="p">\</span><span class="nv">$Email</span> <span class="p">\`</span>  
                    <span class="n">-Office</span> <span class="p">\</span><span class="nv">$Bureau</span> <span class="p">\`</span>  
                    <span class="n">-State</span> <span class="p">\</span><span class="nv">$Departement</span> <span class="p">\`</span>  
                    <span class="n">-Path</span> <span class="s2">&quot;OU=Utilisateurs,DC=t2sr,DC=net&quot;</span> <span class="p">\`</span>  
                    <span class="n">-AccountPassword</span><span class="p">(</span><span class="nb">ConvertTo-SecureString</span> <span class="p">\</span><span class="nv">$MotDePasse</span>
<span class="n">-AsPlainText</span> <span class="n">-Force</span><span class="p">)</span> <span class="p">\`</span>  
                    <span class="n">-ChangePasswordAtLogon</span> <span class="p">\</span><span class="nv">$true</span> <span class="p">\`</span>  
                    <span class="n">-Enabled</span> <span class="p">\</span><span class="nv">$true</span>  
  
        <span class="nb">Write-Output</span> <span class="s2">&quot;Création de l&#39;utilisateur : \$Login (\$Prenom)&quot;</span>  
    <span class="p">}</span>  
<span class="p">}</span>

<span class="n">Le</span> <span class="n">résultat</span> <span class="p">:</span>

<span class="p">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="p">=</span><span class="s2">&quot;./media/image90.png&quot;</span>
<span class="n">style</span><span class="p">=</span><span class="s2">&quot;width:4.09375in;height:2.14583in&quot;</span> <span class="p">/&gt;</span>

<span class="p">&lt;</span><span class="n">img</span> <span class="n">src</span><span class="p">=</span><span class="s2">&quot;./media/image91.png&quot;</span>
<span class="n">style</span><span class="p">=</span><span class="s2">&quot;width:2.09172in;height:2.20833in&quot;</span> <span class="p">/&gt;&lt;</span><span class="n">img</span> <span class="n">src</span><span class="p">=</span><span class="s2">&quot;./media/image92.png&quot;</span>
<span class="n">style</span><span class="p">=</span><span class="s2">&quot;width:2.07292in;height:2.17368in&quot;</span> <span class="p">/&gt;&lt;</span><span class="n">img</span> <span class="n">src</span><span class="p">=</span><span class="s2">&quot;./media/image93.png&quot;</span>
<span class="n">style</span><span class="p">=</span><span class="s2">&quot;width:2.08625in;height:2.19761in&quot;</span> <span class="p">/&gt;</span>
</pre></div>
</div>
<p></p>
</section>
<section id="installation-du-serveur-dns">
<h3>Installation du serveur DNS<a class="headerlink" href="#installation-du-serveur-dns" title="Lien permanent vers cette rubrique"></a></h3>
<p>Gestionnaire de serveur / Tableau de bord / Gérer / Ajouter des rôles et
fonctionnalités</p>
<p><img src="./media/image94.png"
style="width:2.73958in;height:1.2744in" /></p>
<p>J’ai choisi serveur DNS puis installation</p>
<p><img src="./media/image95.png"
style="width:3.44792in;height:1.65625in" /></p>
<p>Une fois installé, j’ai configuré dans</p>
<p>Gestionnaire DNS &gt; Zonz de recherche inversée &gt; Nouvelle Zone</p>
<p><img src="./media/image96.png"
style="width:2.90484in;height:2.41611in" /></p>
<p><img src="./media/image97.png"
style="width:3.45202in;height:2.85768in" /></p>
<p><img src="./media/image98.png"
style="width:3.49861in;height:2.92237in" /></p>
<p><img src="./media/image99.png"
style="width:3.56392in;height:2.98531in" /></p>
<p><img src="./media/image100.png"
style="width:2.89922in;height:2.43425in" /></p>
<p><img src="./media/image101.png"
style="width:2.88523in;height:2.42931in" /></p>
<p><img src="./media/image102.png"
style="width:2.9163in;height:2.43597in" /></p>
<p>J’ai répété la manipulation deux fois pour les plages 2 et 3</p>
<p><img src="./media/image103.png"
style="width:6.27014in;height:1.01042in" /></p>
</section>
<section id="joindre-un-client-linux-dans-active-directory">
<h3>Joindre un client linux dans Active Directory<a class="headerlink" href="#joindre-un-client-linux-dans-active-directory" title="Lien permanent vers cette rubrique"></a></h3>
<section id="installation-des-package-necessaires-sur-des-distributions-basees-sur-debian">
<h4>Installation des package nécessaires sur des distributions basées sur Debian<a class="headerlink" href="#installation-des-package-necessaires-sur-des-distributions-basees-sur-debian" title="Lien permanent vers cette rubrique"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt install realmd sssd sssd-tools libnss-sss libpam-sss adcli
samba-common-bin oddjob oddjob-mkhomedir packagekit -y
</pre></div>
</div>
</section>
<section id="installation-des-package-necessaires-sur-des-distributions-basees-sur-centos-freepbx">
<h4>Installation des package nécessaires sur des distributions basées sur CentOS (FreePBX)<a class="headerlink" href="#installation-des-package-necessaires-sur-des-distributions-basees-sur-centos-freepbx" title="Lien permanent vers cette rubrique"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>yum install realmd sssd sssd-tools libnss-sss libpam-sss adcli
samba-common-bin samba-common-tools oddjob oddjob-mkhomedir packagekit
-y
</pre></div>
</div>
<p>Vérifier que le domaine est joignable</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>realm discover t2sr.io
</pre></div>
</div>
<p><img src="./media/image104.png"
style="width:3.01832in;height:2.0418in" /></p>
</section>
<section id="joindre-le-serveur-ad">
<h4>Joindre le serveur AD<a class="headerlink" href="#joindre-le-serveur-ad" title="Lien permanent vers cette rubrique"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>realm join --user<span class="o">=</span>Administrateur t2sr.io
</pre></div>
</div>
<p>Vérification sur l’AD l’ensemble des ordinateurs du domaine</p>
<p><img src="./media/image105.png"
style="width:4.42971in;height:2.89927in" /></p>
<p>J’ai séparé dans deux UO les serveurs et les clients.</p>
<p>Serveurs</p>
<p><img src="./media/image106.png"
style="width:4.13475in;height:2.58704in" /></p>
<p>Clients</p>
<p><img src="./media/image107.png"
style="width:3.46606in;height:2.01869in" /></p>
<p>Groupes et utilisateurs</p>
<p><img src="./media/image108.png"
style="width:3.83871in;height:1.84858in" /></p>
</section>
</section>
</section>
<section id="id11">
<h2>Conclusion<a class="headerlink" href="#id11" title="Lien permanent vers cette rubrique"></a></h2>
<p>L’installation s’est correctement déroulée. La mise en place de l’Active
Directory doit être le premier serveur à configurer.</p>
</section>
</section>
<section id="serveur-nagios">
<h1><strong>Serveur NAGIOS</strong><a class="headerlink" href="#serveur-nagios" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id12">
<h2>Objectif et environnement<a class="headerlink" href="#id12" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id13">
<h3>Objectif<a class="headerlink" href="#id13" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>Installation NAGIOS sur un conteneur LXC de Proxmox.</p></li>
</ol>
</section>
<section id="id14">
<h3>Environnement<a class="headerlink" href="#id14" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.28.0.0/16</p></li>
<li><p>NAGIOS une VM Debian 11 : 172.28.1.207/16</p></li>
</ul>
</section>
<section id="id15">
<h3>Documentation<a class="headerlink" href="#id15" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://assets.nagios.com/downloads/nagiosxi/docs/Installing-Nagios-XI-Manually-on-Linux.pdf">https://assets.nagios.com/downloads/nagiosxi/docs/Installing-Nagios-XI-Manually-on-Linux.pdf</a></p></li>
</ul>
</section>
</section>
<section id="id16">
<h2>Processus<a class="headerlink" href="#id16" title="Lien permanent vers cette rubrique"></a></h2>
<section id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’ai téléchargé Nagios sur le dépôt officielle, décompressé et lancé le
script installation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">tmp</span>

<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">assets</span><span class="o">.</span><span class="n">nagios</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">downloads</span><span class="o">/</span><span class="n">nagiosxi</span><span class="o">/</span><span class="n">xi</span><span class="o">-</span><span class="n">latest</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>

<span class="n">tar</span> <span class="n">xzf</span> <span class="n">xi</span><span class="o">-</span><span class="n">latest</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>

<span class="n">cd</span> <span class="n">nagiosxi</span>

<span class="o">./</span><span class="n">fullinstall</span>
</pre></div>
</div>
</section>
<section id="finalisation-du-linstallation">
<h3>Finalisation du l’installation<a class="headerlink" href="#finalisation-du-linstallation" title="Lien permanent vers cette rubrique"></a></h3>
<p>Je me suis connecté sur le site <a class="reference external" href="http://172.28.1.207/nagiosxi">http://172.28.1.207/nagiosxi</a></p>
<p><img src="./media/image109.png"
style="width:3.91477in;height:2.98085in" /></p>
<p><img src="./media/image110.png"
style="width:4.96035in;height:2.52495in" /></p>
<p><img src="./media/image111.png"
style="width:4.68367in;height:1.64803in" /></p>
<p>J’ai accepté le contrat de licence</p>
<p><img src="./media/image112.png"
style="width:5.3613in;height:2.98022in" /></p>
<p>Une fois la configuration terminée, je peux entrer sur la page
principale avec le compte précédemment crée.</p>
<p><img src="./media/image113.png"
style="width:4.47568in;height:2.98412in" /></p>
<p>La page d’accueil de NAGIOS</p>
<p><img src="./media/image114.png"
style="width:6.27014in;height:2.59722in" /></p>
<p>Visualisation des services sur le localhost (Détails &gt; Statut
d’accueil)</p>
<p><img src="./media/image115.png"
style="width:6.27014in;height:1.89028in" /></p>
<p><img src="./media/image116.png"
style="width:6.27014in;height:3.05139in" /></p>
</section>
<section id="integrer-active-directory-dans-nagios">
<h3>Intégrer Active Directory dans NAGIOS<a class="headerlink" href="#integrer-active-directory-dans-nagios" title="Lien permanent vers cette rubrique"></a></h3>
<p>Utilisateurs &gt; ldap / ad intégration</p>
<p><img src="./media/image117.png"
style="width:1.95861in;height:1.11474in" /></p>
<p><img src="./media/image118.png"
style="width:6.27014in;height:1.85625in" /></p>
<p>J’ai ajouté un serveur d’authentification</p>
<p><img src="./media/image119.png"
style="width:6.27014in;height:4.25347in" /></p>
<p>Ajouter des utilisateurs</p>
<p>Utilisateurs &gt; Gérer les utilisateurs</p>
<p><img src="./media/image120.png"
style="width:1.57549in;height:0.87527in" /></p>
<p>Choix ajouter des utilisateurs à partir de LDAP/AD</p>
<p><img src="./media/image121.png"
style="width:6.27014in;height:1.34514in" /></p>
<p><img src="./media/image122.png"
style="width:3.53926in;height:1.88497in" /></p>
<p>J’ai sélectionné et ajouté les utilisateurs</p>
<p><img src="./media/image123.png"
style="width:3.22343in;height:3.5608in" /></p>
<p><img src="./media/image124.png"
style="width:6.27014in;height:1.80764in" /></p>
<p>Dans le menu éditer, on peut renseigner les paramètres de sécurité pour
les utilisateurs</p>
<p>Utilisateur simple :</p>
<p><img src="./media/image125.png"
style="width:3.4131in;height:2.26471in" /></p>
<p>Administrateur :</p>
<p><img src="./media/image126.png"
style="width:3.48461in;height:1.18779in" /></p>
<p>Préférences pour tous les utilisateurs</p>
<p><img src="./media/image127.png"
style="width:3.53408in;height:1.84705in" /></p>
<p>Une fois finalisé j’ai importé les utilisateurs</p>
<p>La liste des utilisateurs</p>
<p><img src="./media/image128.png"
style="width:6.27014in;height:2.09583in" /></p>
</section>
<section id="installation-openssh-sur-windows-serveur-2019">
<h3>Installation OpenSSH sur Windows Serveur 2019<a class="headerlink" href="#installation-openssh-sur-windows-serveur-2019" title="Lien permanent vers cette rubrique"></a></h3>
<p><strong>Paramètres &gt; Applications et fonctionnalités &gt; Gérer les
fonctionnalités facultatives</strong></p>
<p>Si manquant, ajouter Client OpenSSH et Serveur OpenSSH</p>
<p><img src="./media/image129.png"
style="width:4.78192in;height:0.6876in" /></p>
<p><img src="./media/image130.png"
style="width:4.93819in;height:0.55216in" /></p>
<p>J’ai démarré le service avec une commande PowerShell et rendu démarrage
automatique au lieu de manuel.</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Start-Service</span> <span class="n">-Name</span> <span class="s2">&quot;sshd&quot;</span>

<span class="nb">Set-Service</span> <span class="n">-Name</span> <span class="s2">&quot;sshd&quot;</span> <span class="n">-StartupType</span> <span class="n">Automatic</span>
</pre></div>
</div>
<p>J’ai vérifié à ce que ça soit bien démarré</p>
<p><img src="./media/image131.png"
style="width:3.92763in;height:1.2085in" /></p>
</section>
<section id="deployer-lagent-nagios-sur-windows-server">
<h3>Déployer l’agent Nagios sur Windows Server<a class="headerlink" href="#deployer-lagent-nagios-sur-windows-server" title="Lien permanent vers cette rubrique"></a></h3>
<p>Menu Configurer &gt; Déployer l’agent</p>
<p><img src="./media/image132.png"
style="width:6.27014in;height:3.36181in" /></p>
<p><img src="./media/image133.png"
style="width:3.98324in;height:1.37377in" /></p>
<p><img src="./media/image134.png"
style="width:3.34459in;height:1.57214in" /></p>
</section>
<section id="ajouter-un-windows-serveur-2019-adds-a-surveiller">
<h3>Ajouter un Windows serveur 2019 (ADDS) à surveiller<a class="headerlink" href="#ajouter-un-windows-serveur-2019-adds-a-surveiller" title="Lien permanent vers cette rubrique"></a></h3>
<p>Configurer &gt; Assistants de configuration &gt; Active directory</p>
<p><img src="./media/image135.png"
style="width:6.27014in;height:1.40556in" /></p>
<p>J’ai renseigné l’adresse IP du serveur AD</p>
<p><img src="./media/image136.png"
style="width:3.76029in;height:1.23483in" /></p>
<p>J’ai renseigné les données nécessaires à la connexion de l’AD</p>
<p><img src="./media/image137.png"
style="width:4.54563in;height:4.39258in" /></p>
<p>Les paramètres suivants j’ai laissé par défaut</p>
<p><img src="./media/image138.png"
style="width:4.73872in;height:2.36227in" /></p>
<p>Configuration des paramètres de notification</p>
<p><img src="./media/image139.png"
style="width:3.47933in;height:1.76188in" /></p>
<p><img src="./media/image140.png"
style="width:3.43488in;height:1.09537in" /></p>
</section>
<section id="deployer-lagent-nagios-sur-serveur-ubuntu-samba">
<h3>Déployer l’agent Nagios sur Serveur Ubuntu (SAMBA)<a class="headerlink" href="#deployer-lagent-nagios-sur-serveur-ubuntu-samba" title="Lien permanent vers cette rubrique"></a></h3>
<p>Configurer &gt; Déployer l’agent</p>
<p><img src="./media/image141.png"
style="width:3.95744in;height:3.53491in" /></p>
<p><img src="./media/image142.png"
style="width:4.00416in;height:1.68348in" /></p>
<p>J’ai choisi assistant de configuration</p>
<p>Limites d’utilisation du processeur à surveiller</p>
<p><img src="./media/image143.png"
style="width:6.13627in;height:2.61495in" /></p>
<p>Limites d’utilisation de la mémoire à surveiller</p>
<p><img src="./media/image144.png"
style="width:6.27014in;height:2.61736in" /></p>
<p>Choix des disques que je souhaite surveiller</p>
<p><img src="./media/image145.png"
style="width:4.1682in;height:4.69141in" /></p>
<p>Délais interrogation du client, puis terminer.</p>
<p><img src="./media/image146.png"
style="width:5.48219in;height:2.91566in" /></p>
<p><img src="./media/image147.png"
style="width:4.27771in;height:2.2225in" /></p>
</section>
<section id="integrer-nagios-dans-active-directory">
<h3>Intégrer Nagios dans Active Directory<a class="headerlink" href="#integrer-nagios-dans-active-directory" title="Lien permanent vers cette rubrique"></a></h3>
<p><img src="./media/image148.png"
style="width:3.27764in;height:1.64777in" /></p>
<p>NB : le procédé d’intégration est expliqué dans le chapitre <a class="reference external" href="#joindre-le-serveur-ad">création
Active Directory</a>.</p>
</section>
</section>
<section id="id17">
<h2>Conclusion<a class="headerlink" href="#id17" title="Lien permanent vers cette rubrique"></a></h2>
<p>Il est aisé d’ajouter des nouveaux hôtes à surveiller avec l’assistant
de configuration à condition d’avoir un lien SSH. Les services de
surveillance de base proposés sont ; CPU, mémoire, stockage, trafics
réseaux.</p>
</section>
</section>
<section id="serveur-pfsense">
<h1><strong>Serveur pfSense</strong><a class="headerlink" href="#serveur-pfsense" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id18">
<h2>Objectif et environnement<a class="headerlink" href="#id18" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id19">
<h3>Objectif<a class="headerlink" href="#id19" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>Installer et configurer pfSense CE 2.6.0 en tant que pare-feu, proxy
et portail captif. Il sera également le serveur DHCP de la
plateforme.</p></li>
</ol>
</section>
<section id="id20">
<h3>Environnement<a class="headerlink" href="#id20" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.2-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.28.0.0/16</p></li>
<li><p>pfSense: FW-PROXY 172.28.1.254</p></li>
<li><p>client Windows 10 : CLI-WIN-01, DHCP</p></li>
<li><p>client Linux Debian : CLI-DEB-01, DHCP</p></li>
</ul>
</section>
<section id="id21">
<h3>Documentation :<a class="headerlink" href="#id21" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=wv1qTYR3faQ&amp;t=1670s">https://www.youtube.com/watch?v=wv1qTYR3faQ&amp;t=1670s</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=tKrRAy6Rnss">https://www.youtube.com/watch?v=tKrRAy6Rnss</a></p></li>
<li><p><a class="reference external" href="https://www.it-connect.fr/cours-tutoriels/administration-reseau/pare-feu/pfsense/">https://www.it-connect.fr/cours-tutoriels/administration-reseau/pare-feu/pfsense/</a></p></li>
<li><p><a class="reference external" href="https://www.it-connect.fr/les-serveurs-proxy-et-reverse-proxy-pour-les-debutants/">https://www.it-connect.fr/les-serveurs-proxy-et-reverse-proxy-pour-les-debutants/</a></p></li>
</ul>
</section>
</section>
<section id="id22">
<h2>Processus<a class="headerlink" href="#id22" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id23">
<h3>Installation<a class="headerlink" href="#id23" title="Lien permanent vers cette rubrique"></a></h3>
<p>Nous avons téléchargé l’ISO d’installation sur le site officiel :</p>
<p><a class="reference external" href="https://www.pfsense.org/download/">https://www.pfsense.org/download/</a></p>
<p>Nous avons booté sur l’ISO :</p>
<p><img src="./media/image149.png"
style="width:4.20892in;height:2.51077in" /></p>
<p><img src="./media/image150.png"
style="width:4.22976in;height:1.76066in" /></p>
<p><img src="./media/image151.png"
style="width:4.1985in;height:1.27101in" /></p>
<p>Choix de la langue</p>
<p><img src="./media/image152.png"
style="width:3.53174in;height:1.83359in" /></p>
<p><img src="./media/image153.png"
style="width:3.62551in;height:1.45854in" /></p>
<p><img src="./media/image154.png"
style="width:3.39631in;height:1.48979in" /></p>
<p><img src="./media/image155.png"
style="width:2.77122in;height:1.35436in" /></p>
<section id="configuration-les-adresse-ip-du-pfsense">
<h4>Configuration les adresse IP du pfSense<a class="headerlink" href="#configuration-les-adresse-ip-du-pfsense" title="Lien permanent vers cette rubrique"></a></h4>
<p>Choix 2</p>
<p><img src="./media/image156.png"
style="width:6.27014in;height:1.46597in" /></p>
<p>Choix 2</p>
<p><img src="./media/image157.png"
style="width:6.27014in;height:1.52431in" /></p>
<p><img src="./media/image158.png"
style="width:6.27014in;height:0.38611in" /></p>
<p><img src="./media/image159.png"
style="width:6.27014in;height:1.07917in" /></p>
<p>J’ai choisi entrée deux fois puis <strong>n</strong> pour le serveur dhcp.</p>
<p><img src="./media/image160.png"
style="width:6.27014in;height:1.51528in" /></p>
<p>Les adresses IP sont configurées</p>
<p><img src="./media/image161.png"
style="width:6.27014in;height:0.42569in" /></p>
</section>
</section>
<section id="configuration-du-pfsense">
<h3>Configuration du pfSense<a class="headerlink" href="#configuration-du-pfsense" title="Lien permanent vers cette rubrique"></a></h3>
<p>La VM pfSense est accessible sur l’adresse 172.28.1.254/16</p>
<blockquote>
<div><p>Login par défaut : admin</p>
<p>Password par défaut : pfsense</p>
</div></blockquote>
<p><img src="./media/image162.png"
style="width:3.09418in;height:1.76066in" /></p>
<section id="configuration-generale">
<h4>Configuration générale<a class="headerlink" href="#configuration-generale" title="Lien permanent vers cette rubrique"></a></h4>
<p>System / General Setup</p>
<p><img src="./media/image163.png"
style="width:6.27014in;height:1.37778in" /></p>
<p><img src="./media/image164.png"
style="width:6.27014in;height:1.55556in" /></p>
<p><img src="./media/image165.png"
style="width:6.27014in;height:1.96319in" /></p>
</section>
<section id="configurations-acces-au-serveur">
<h4>Configurations accès au serveur<a class="headerlink" href="#configurations-acces-au-serveur" title="Lien permanent vers cette rubrique"></a></h4>
<p>Système &gt; Advanced &gt; Admin Access</p>
<p>J’ai choisi l’accès via HTTPS</p>
<p><img src="./media/image166.png"
style="width:6.27014in;height:1.73611in" /></p>
<p>J’ai activé connexion via SSH</p>
<p><img src="./media/image167.png"
style="width:6.27014in;height:1.39931in" /></p>
<p>Test de la connexion SSH</p>
<p><img src="./media/image168.png"
style="width:3.82031in;height:2.29752in" /></p>
<p>La connexion fonctionne.</p>
</section>
<section id="configuration-serveur-dhcp">
<h4>Configuration serveur DHCP<a class="headerlink" href="#configuration-serveur-dhcp" title="Lien permanent vers cette rubrique"></a></h4>
<p>Services / DHCP Server / LAN</p>
<p><img src="./media/image169.png"
style="width:6.27014in;height:0.43472in" /></p>
<p><img src="./media/image170.png"
style="width:6.27014in;height:1.20347in" /></p>
<p><img src="./media/image171.png"
style="width:6.27014in;height:1.50417in" /></p>
<p><img src="./media/image172.png"
style="width:6.27014in;height:1.37708in" /></p>
<p>Vérification sur un client</p>
<p><img src="./media/image173.png"
style="width:6.27014in;height:2.64514in" /></p>
<p><img src="./media/image174.png"
style="width:6.27014in;height:0.62431in" /></p>
<p>La carte réseau est configuré dans le réseau 172.16.0.0/16 mais il a
accès à l’internet. La passerelle par pfSense est fonctionnelle.</p>
</section>
<section id="connexion-et-authentification-par-active-directory">
<h4>Connexion et authentification par Active Directory<a class="headerlink" href="#connexion-et-authentification-par-active-directory" title="Lien permanent vers cette rubrique"></a></h4>
<p>System &gt; User Manager &gt; Authentification Servers &gt; Add</p>
<img src="./media/image175.png" style="width:6.27014in;height:0.85in" /><p><img src="./media/image176.png"
style="width:5.86351in;height:3.30354in" /></p>
<p><img src="./media/image177.png"
style="width:5.83036in;height:2.79992in" /></p>
<p>Création d’un groupe <strong>adminpfsense</strong> sur l’AD avec deux utilisateurs</p>
<p><img src="./media/image178.png"
style="width:6.27014in;height:2.37569in" /></p>
<p>Sur la VM pfSense</p>
<p>System &gt; User Manager &gt; Groups &gt; Add</p>
<p>Ajout la groupe <strong>adminpfsense</strong> que nous avons créé sur l’AD</p>
<p><img src="./media/image179.png"
style="width:6.27014in;height:2.81111in" /></p>
<p>Nous avons donné accès à ce groupe pour consulter toutes les pages</p>
<p><img src="./media/image180.png"
style="width:6.27014in;height:1.41736in" /></p>
<p>Test d’authentification</p>
<p>Diagnostics &gt; Authentification</p>
<p>Je vais tester la connexion avec un utilisateur qui fait partie du
groupe <strong>adminpfsense.</strong></p>
<p><img src="./media/image181.png"
style="width:6.27014in;height:2.95556in" /></p>
<p>Maintenant, les utilisateurs appartenant au groupe <strong>adminpfsense</strong>
peuvent administrer pfSense.</p>
<p><img src="./media/image182.png"
style="width:2.20436in;height:1.77869in" /></p>
</section>
</section>
<section id="mise-en-place-serveur-proxy">
<h3>Mise en place serveur Proxy<a class="headerlink" href="#mise-en-place-serveur-proxy" title="Lien permanent vers cette rubrique"></a></h3>
<p>Installation des packages Squid et Squidgard</p>
<p>System &gt; Package Manager &gt; Available Packages</p>
<p><img src="./media/image183.png"
style="width:6.27014in;height:1.50347in" /></p>
<p><img src="./media/image184.png"
style="width:6.27014in;height:2.49583in" /></p>
<p>Création d’un certificat de sécurité autosigné</p>
<p>System &gt; Certificate Manager &gt; Add</p>
<p><img src="./media/image185.png"
style="width:5.77676in;height:1.7345in" /></p>
<p><img src="./media/image186.png"
style="width:5.78553in;height:4.01316in" /></p>
<p><img src="./media/image187.png"
style="width:6.27014in;height:1.11597in" /></p>
<section id="activation-squid-proxy">
<h4>Activation Squid Proxy<a class="headerlink" href="#activation-squid-proxy" title="Lien permanent vers cette rubrique"></a></h4>
<p>Services &gt; Squid Proxy Server</p>
<p>Configuration Local Cache</p>
<p><img src="./media/image188.png"
style="width:6.27014in;height:1.17639in" /></p>
<p><img src="./media/image189.png"
style="width:6.27014in;height:1.44861in" /></p>
<p>General</p>
<p><img src="./media/image190.png"
style="width:6.27014in;height:2.85556in" /></p>
<p><img src="./media/image191.png"
style="width:6.27014in;height:2.00069in" /></p>
<p><img src="./media/image192.png"
style="width:6.27014in;height:3.85278in" /></p>
<p><img src="./media/image193.png"
style="width:6.27014in;height:0.51389in" /></p>
<p><img src="./media/image194.png"
style="width:6.27014in;height:1.22986in" /></p>
<p>Spécifier les réseaux qui ont accès au proxy</p>
<p>ACLs</p>
<p><img src="./media/image195.png"
style="width:6.27014in;height:1.06181in" /></p>
<p>J’ai exporté le certificat et j’ai installé sur mes clients</p>
<p><img src="./media/image196.png"
style="width:6.27014in;height:3.00208in" /></p>
<p>Test avec un client Windows</p>
<p>Installer certificat</p>
<p>Double clic sur le certificat puis installer</p>
<p><img src="./media/image197.png"
style="width:2.55575in;height:3.2419in" /></p>
<p><img src="./media/image198.png"
style="width:6.27014in;height:0.90903in" /></p>
<p><img src="./media/image199.png"
style="width:5.68829in;height:1.25017in" /></p>
<p><img src="./media/image200.png"
style="width:6.27014in;height:3.38264in" /></p>
<p>Test avec le client Linux</p>
<p>J’ai créé un dossier pour accueillir notre certificat</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir /usr/local/share/ce-certificates/t2sr

cp t2sr_ssl_cert.crt /usr/local/share/ce-certificates/t2sr
</pre></div>
</div>
<p>J’ai installé le certificat</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>update-ca-certificates
</pre></div>
</div>
<p><img src="./media/image201.png"
style="width:6.27014in;height:0.80764in" /></p>
<p>Je test avec la page d’accueil Facebook</p>
<p>Avant l’application du blacklist</p>
<p><img src="./media/image202.png"
style="width:6.27014in;height:3.27153in" /></p>
<p>Apres l’application du blacklist</p>
<p><img src="./media/image203.png"
style="width:6.27014in;height:3.36042in" /></p>
</section>
<section id="configuration-squidgard">
<h4>Configuration SquidGard<a class="headerlink" href="#configuration-squidgard" title="Lien permanent vers cette rubrique"></a></h4>
<p>Une autre manière de créer de site blacklisté est d’utiliser SquidGard</p>
<p>Services &gt; SquidGard Proxy Filter</p>
<p>Target Catégories</p>
<p>J’ai créé un target nommé test avec un nom domaine à refuser</p>
<p><img src="./media/image204.png"
style="width:6.27014in;height:2.74236in" /></p>
<p>Le résultat</p>
<p><img src="./media/image205.png"
style="width:6.27014in;height:2.73681in" /></p>
<p>Blacklist sous SquidGard</p>
<p>Nous pouvons uploader une blacklist archive. Il s’agit d’une collection
des sites non désirables. J’ai utilisé celui créé par l’université de
Toulouse :</p>
<p><a class="reference external" href="http://dsi.ut-capitole.fr/blacklists/download/blacklists_for_pfsense.tar.gz">http://dsi.ut-capitole.fr/blacklists/download/blacklists_for_pfsense.tar.gz</a></p>
<p>Une fois renseigné j’ai cliqué sur download</p>
<p><img src="./media/image206.png"
style="width:6.27014in;height:2.69861in" /></p>
<p>Common ACL</p>
<p>Nous retrouvons le target catégorie test que nous avons créé et
également la liste importée que nous pouvons peaufiner par la suite.</p>
<p><img src="./media/image207.png"
style="width:6.27014in;height:4.10208in" /></p>
<p>Nous pouvons visualiser la liste de ses sites si besoin</p>
<p><img src="./media/image208.png"
style="width:3.29146in;height:3.44026in" /><img src="./media/image209.png"
style="width:2.1289in;height:3.48599in" /></p>
</section>
<section id="configuration-du-firewall">
<h4>Configuration du firewall<a class="headerlink" href="#configuration-du-firewall" title="Lien permanent vers cette rubrique"></a></h4>
<p>Firewall &gt; Roules &gt; LAN</p>
<p><img src="./media/image210.png"
style="width:6.27014in;height:2.85347in" /></p>
<p>J’ai désactivé l’accès en IPv6 (nous utilisons que des adresses en IPv4)</p>
<p><img src="./media/image211.png"
style="width:6.27014in;height:1.65069in" /></p>
</section>
<section id="creer-firewall-aliases">
<h4>Créer Firewall Aliases<a class="headerlink" href="#creer-firewall-aliases" title="Lien permanent vers cette rubrique"></a></h4>
<p>Firewall &gt; Rules &gt; LAN</p>
<p>L’état actuel du Firewall</p>
<p><img src="./media/image212.png"
style="width:6.27014in;height:2.53472in" /></p>
<p>Tous les ports sont ouverts pour une communication vers l’extérieur (LAN
vers WAN).</p>
<p>Nous allons autoriser uniquement les ports suivants :</p>
<ul class="simple">
<li><p>80 : http</p></li>
<li><p>443 : https</p></li>
<li><p>22 : ssh</p></li>
<li><p>53 : dns (tcp/udp)</p></li>
<li><p>123 : ntp</p></li>
</ul>
<p>Ajout des ports TCP</p>
<p>Firewall &gt; Aliases &gt; Ports &gt; Add</p>
<p><img src="./media/image213.png"
style="width:6.27014in;height:3.67986in" /></p>
<p>Ajout des ports UDP</p>
<p><img src="./media/image214.png"
style="width:6.27014in;height:3.00486in" /></p>
<p>J’ai choisi <strong>Apply changes</strong></p>
<p><img src="./media/image215.png"
style="width:6.27014in;height:2.66111in" /></p>
<p>Firewall &gt; Rules &gt; LAN &gt; Add</p>
<p><img src="./media/image216.png"
style="width:6.27014in;height:2.74514in" /></p>
<p>J’ai choisi comme destination la TCP_standard_Sortie précédemment crée.</p>
<p><img src="./media/image217.png"
style="width:6.27014in;height:1.09722in" /></p>
<p>J’ai ajouté un commentaire, puis j’ai sauvegardé</p>
<p><img src="./media/image218.png"
style="width:6.27014in;height:2.10556in" /></p>
<p>La règle a été crée</p>
<p><img src="./media/image219.png"
style="width:6.27014in;height:2.05903in" /></p>
<p>J’ai ajouté une deuxième règle pour DNS(UDP) et NTP</p>
<p><img src="./media/image220.png"
style="width:5.2674in;height:2.69525in" /></p>
<p><img src="./media/image221.png"
style="width:5.66033in;height:0.99615in" /></p>
<p><img src="./media/image222.png"
style="width:5.66809in;height:1.8833in" /></p>
<p>Création d’une troisième règle qui refusera tous les autres ports :</p>
<p>Firewall &gt; Rules &gt; LAN</p>
<p><img src="./media/image223.png"
style="width:5.66204in;height:2.90658in" /></p>
<p><img src="./media/image224.png"
style="width:5.72041in;height:0.43716in" /></p>
<p>J’ai ajouté un commentaire, puis cliqué sur Save.</p>
<p><img src="./media/image225.png"
style="width:5.30116in;height:1.75551in" /></p>
</section>
<section id="mise-en-place-portail-captif">
<h4>Mise en Place Portail Captif<a class="headerlink" href="#mise-en-place-portail-captif" title="Lien permanent vers cette rubrique"></a></h4>
<p>Services &gt; Captive Portal &gt; Add</p>
<p><img src="./media/image226.png"
style="width:6.27014in;height:1.56597in" /></p>
<p><img src="./media/image227.png"
style="width:6.27014in;height:2.27708in" /></p>
<p><img src="./media/image228.png"
style="width:6.27014in;height:1.94792in" /></p>
<p><img src="./media/image229.png"
style="width:6.27014in;height:2.46736in" /></p>
<p>Pour valider la configuration j’ai cliqué sur Save.</p>
<p>Adresse du portail captif : <a class="reference external" href="http://172.28.1.254:8002">http://172.28.1.254:8002</a></p>
<p><img src="./media/image230.png"
style="width:1.35131in;height:1.84958in" />
<img src="./media/image231.png"
style="width:2.1425in;height:1.0011in" /></p>
<p><img src="./media/image232.png"
style="width:1.42305in;height:1.76168in" /></p>
</section>
</section>
</section>
<section id="id24">
<h2>Conclusion<a class="headerlink" href="#id24" title="Lien permanent vers cette rubrique"></a></h2>
<p>La configuration du pfSense s’est bien déroulée. L’utilisation du
portail captif nécessite d’avoir une carte réseaux supplémentaire afin
de ne pas interférer avec les VM sur le réseau de production.</p>
</section>
</section>
<section id="serveur-veeam-backup">
<h1><strong>Serveur VEEAM Backup</strong><a class="headerlink" href="#serveur-veeam-backup" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id25">
<h2>Objectif et environnement<a class="headerlink" href="#id25" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id26">
<h3>Objectif<a class="headerlink" href="#id26" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>Installation Veeam backup sur une VM Windows Serveur 2019</p></li>
</ol>
</section>
<section id="id27">
<h3>Environnement<a class="headerlink" href="#id27" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.16.0.0/16</p></li>
<li><p>Serveur Windows 2019 : VEEAM 172.28.1.204/16</p></li>
<li><p>Serveur AD – Windows serveur 2019 : 172.28.1.200/16</p></li>
<li><p>Client Linux Debian 11 : DHCP</p></li>
<li><p>Client Windows Win 10 Pro : DHCP</p></li>
<li><p>Helper Host (pour la restauration) Ubuntu serveur 22.04 :
172.28.1.202/16</p></li>
</ul>
</section>
<section id="id28">
<h3>Documentation<a class="headerlink" href="#id28" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.youtube.com/c/veeam">https://www.youtube.com/c/veeam</a></p></li>
</ul>
</section>
</section>
<section id="id29">
<h2>Processus<a class="headerlink" href="#id29" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id30">
<h3>Installation<a class="headerlink" href="#id30" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’ai téléchargé l’image sur le site officielle :</p>
<p><a class="reference external" href="https://www.veeam.com/">https://www.veeam.com/</a></p>
<p>Choix Veeam Backup &amp; Replication</p>
<p><img src="./media/image233.png"
style="width:6.27014in;height:4.37431in" /></p>
<p><img src="./media/image234.png"
style="width:4.26101in;height:1.60439in" /></p>
<p>J’ai cliqué sur OK pour l’installer le paquet manquant</p>
<p><img src="./media/image235.png"
style="width:4.02943in;height:2.8456in" /></p>
<p><img src="./media/image236.png"
style="width:4.04618in;height:2.82497in" /></p>
<p>J’ai choisi Install pour installer les prérequis manquants</p>
<p><img src="./media/image237.png"
style="width:3.999in;height:2.80222in" /></p>
<p><img src="./media/image238.png"
style="width:3.97211in;height:2.76383in" /></p>
<p><img src="./media/image239.png"
style="width:4.00986in;height:2.82963in" /></p>
<p><img src="./media/image240.png"
style="width:4.26605in;height:2.99168in" /></p>
<section id="connexion-au-serveur">
<h4>Connexion au serveur<a class="headerlink" href="#connexion-au-serveur" title="Lien permanent vers cette rubrique"></a></h4>
<p>J’ai lancé l’application</p>
<p><img src="./media/image241.png"
style="width:0.8647in;height:1.00014in" /></p>
<p><img src="./media/image242.png"
style="width:3.34328in;height:2.69229in" /></p>
<p>Choix Apply</p>
<p><img src="./media/image243.png"
style="width:6.26875in;height:4.43264in" /></p>
<p><img src="./media/image244.png"
style="width:6.26875in;height:4.47778in" /></p>
</section>
<section id="ajout-dun-dossier-de-sauvegarde">
<h4>Ajout d’un dossier de sauvegarde<a class="headerlink" href="#ajout-dun-dossier-de-sauvegarde" title="Lien permanent vers cette rubrique"></a></h4>
<p>Backup Infrastructure / Backup Repositories / Add Repository</p>
<p><img src="./media/image245.png"
style="width:5.33972in;height:1.35903in" /></p>
<p><img src="./media/image246.png"
style="width:5.67557in;height:1.47091in" /></p>
<p><img src="./media/image247.png"
style="width:6.26875in;height:2.92569in" /></p>
<p>J’ai cliqué sur <strong>Browse</strong> pour sélectionner la nouvelle partition de
partage</p>
<p><img src="./media/image248.png"
style="width:6.27014in;height:1.78403in" /></p>
<p>Choix partition <strong>F:\</strong> précédemment préparé (Partition REFS/64ko).</p>
<p><img src="./media/image249.png"
style="width:4.05972in;height:1.67153in" /></p>
<p>En cliquant sur <strong>Populate</strong>, nous pouvons voir la capacité du disque et
l’espace libre restant.</p>
<p><img src="./media/image250.png"
style="width:5.80289in;height:1.12516in" /></p>
<p><img src="./media/image251.png"
style="width:6.26875in;height:2.77639in" /></p>
<p>A la fin de configuration j’ai cliqué sur <strong>Apply</strong></p>
<p><img src="./media/image252.png"
style="width:4.75346in;height:3.33621in" /></p>
<p><img src="./media/image253.png"
style="width:4.26495in;height:2.47761in" /></p>
<p>Choix Oui</p>
<p><img src="./media/image254.png"
style="width:4.7715in;height:1.27101in" /></p>
<p>Sauvegarder des VM</p>
</section>
<section id="creation-dun-backup-job">
<h4>Création d’un Backup Job<a class="headerlink" href="#creation-dun-backup-job" title="Lien permanent vers cette rubrique"></a></h4>
</section>
<section id="sauvegarder-le-serveur-ad">
<h4>Sauvegarder le Serveur AD<a class="headerlink" href="#sauvegarder-le-serveur-ad" title="Lien permanent vers cette rubrique"></a></h4>
<p><img src="./media/image255.png"
style="width:6.27014in;height:3.14861in" /></p>
<p>Ajouter ordinateurs pour sauvegarder</p>
<p><img src="./media/image256.png"
style="width:6.27014in;height:1.56389in" /></p>
<p><img src="./media/image257.png"
style="width:4.02083in;height:2.44792in" /></p>
<p><img src="./media/image258.png"
style="width:5.02153in;height:2.86498in" /></p>
<p><img src="./media/image259.png"
style="width:6.26042in;height:2.63542in" /></p>
<p><img src="./media/image260.png"
style="width:6.27014in;height:2.62847in" /></p>
<p><img src="./media/image261.png"
style="width:6.19878in;height:0.9793in" /></p>
<p><img src="./media/image262.png"
style="width:6.18836in;height:4.97986in" /></p>
<p>Laissé par défaut</p>
<p><img src="./media/image263.png"
style="width:6.17795in;height:1.95861in" /></p>
<p>Possibilité de programmer l’exécution du <strong>Job</strong></p>
<p><img src="./media/image264.png"
style="width:4.13596in;height:2.21469in" /></p>
<p>Une fois le Job est lancé, nous pouvons suivre son évolution</p>
<p><img src="./media/image265.png"
style="width:6.27014in;height:1.37986in" /></p>
<p><img src="./media/image266.png"
style="width:6.27083in;height:1.02083in" /></p>
<p><img src="./media/image267.png"
style="width:5.26866in;height:3.49783in" /></p>
</section>
<section id="sauvegarder-une-vm-linux">
<h4>Sauvegarder une VM Linux<a class="headerlink" href="#sauvegarder-une-vm-linux" title="Lien permanent vers cette rubrique"></a></h4>
<p>Créer un nouveau job &gt; Linux Computer</p>
<p><img src="./media/image268.png"
style="width:1.4093in;height:1.89656in" /></p>
<p>Choix <strong>Server &gt; Managed by backup server</strong></p>
<p><img src="./media/image269.png"
style="width:4.72519in;height:2.17498in" /></p>
<p><img src="./media/image270.png"
style="width:4.98507in;height:2.19808in" /></p>
<p>J’ai ajouté la VM en question</p>
<p><img src="./media/image271.png"
style="width:3.2192in;height:1.40645in" /></p>
<p>N’ayant pas déclaré dans le DNS, j’ai utilisé son adresse IP.
Credentials (droits) &gt; Add &gt; Linux Account</p>
<p><img src="./media/image272.png"
style="width:3.92537in;height:1.99653in" /></p>
<p><img src="./media/image273.png"
style="width:2.58007in;height:2.4446in" /></p>
<p><img src="./media/image274.png"
style="width:4.01042in;height:2.4375in" /></p>
<p>J’ai choisi sauvegarder la VM en entier</p>
<p><img src="./media/image275.png"
style="width:4.65524in;height:1.53594in" /></p>
<p>J’ai choisi de garder les deux derniers points de restauration</p>
<p><img src="./media/image276.png"
style="width:4.51878in;height:1.72664in" /></p>
<p>J’ai laissé ses options désélectionné (par défaut)</p>
<p><img src="./media/image277.png"
style="width:6.27014in;height:2.17917in" /></p>
<p>J’ai choisi une sauvegarde mensuelle</p>
<p><img src="./media/image278.png"
style="width:6.27014in;height:1.69097in" /></p>
<p>Le récapitulatif du job et lancement de la sauvegarde</p>
<p><img src="./media/image279.png"
style="width:2.6875in;height:2.11458in" /></p>
<p><img src="./media/image280.png"
style="width:2.06279in;height:0.30213in" /></p>
<p>Lancement du job, début de la sauvegarde</p>
<p><img src="./media/image281.png"
style="width:6.27083in;height:1.26042in" /></p>
<p>Le serveur va lancer un scan et automatiquement installer
automatiquement un client VEEAM sur la VM Debian si manquant (ici c’est
le cas)</p>
<p><img src="./media/image282.png"
style="width:6.27083in;height:2.34375in" /></p>
<p>Une fois l’agent est installé nous avons une réponse succès</p>
<p><img src="./media/image283.png"
style="width:6.27083in;height:1.98958in" /></p>
<p>J’ai installé les paquets nécessaires pour linux (Debian)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install dkms gcc make perl openssh-server
linux-headers-<span class="se">\$</span><span class="o">(</span>uname -r<span class="o">)</span> libudev-dev libacl1 libattr1 lvm2 libfuse-dev
libfuse2 libncurses5 dmidecode default-libmysqlclient-dev libpq5 python3
isolinux btrfs-progs squashfs-tools wget xorriso
</pre></div>
</div>
<p>Ensuite j’ai téléchargé et installé VEEAM</p>
<p><a class="reference external" href="http://repository.veeam.com/.private/deb/veeam/">http://repository.veeam.com/.private/deb/veeam/</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">dpkg</span> <span class="o">-</span><span class="n">i</span> <span class="n">veeam_5</span><span class="mf">.0.2.4567</span><span class="n">_amd64</span><span class="o">.</span><span class="n">deb</span>
</pre></div>
</div>
<p>Début de la sauvegarde</p>
<p><img src="./media/image284.png"
style="width:5.1194in;height:2.29138in" /></p>
<p>Fin de la sauvegarde</p>
<p><img src="./media/image285.png"
style="width:4.77612in;height:3.17084in" /></p>
</section>
<section id="sauvegarder-une-vm-windows">
<h4>Sauvegarder une VM Windows<a class="headerlink" href="#sauvegarder-une-vm-windows" title="Lien permanent vers cette rubrique"></a></h4>
<p>Création d’un nouveau job &gt; Windows computer</p>
<p><img src="./media/image286.png"
style="width:1.8064in;height:2.18669in" /></p>
<p>Server &gt; Managed by agent</p>
<p><img src="./media/image287.png"
style="width:6.26042in;height:2.30208in" /></p>
<p>Add &gt; Individual computer</p>
<p><img src="./media/image288.png"
style="width:6.27014in;height:1.41319in" /></p>
<p>J’ai renseigné l’host et les droits d’accès</p>
<img src="./media/image289.png" style="width:4in;height:2.44792in" /><p>Nous avons la possibilité de renseigner directement l’utilisateur et son
mot de passe ou passer par <strong>browse</strong> et chercher sur l’AD.</p>
<p><img src="./media/image290.png"
style="width:3.19601in;height:1.81019in" /></p>
<p>J’ai choisi <strong>browse</strong></p>
<p><img src="./media/image291.png"
style="width:2.83571in;height:1.61872in" /></p>
<p><img src="./media/image292.png"
style="width:3.22817in;height:1.49836in" /></p>
<p>Puis avancé et renseigner l’accès à l’AD</p>
<p><img src="./media/image293.png"
style="width:2.46737in;height:2.0978in" /></p>
<p>Puis trouver l’utilisateur qu’on souhaite</p>
<p><img src="./media/image294.png"
style="width:3.10315in;height:2.64008in" /></p>
<p><img src="./media/image295.png"
style="width:3.64516in;height:1.72629in" /></p>
<p><img src="./media/image296.png"
style="width:3.68436in;height:2.10644in" /></p>
<p><img src="./media/image297.png"
style="width:3.98958in;height:2.4375in" /></p>
<p>Choix Volume level backup</p>
<p><img src="./media/image298.png"
style="width:6.27014in;height:2.03958in" /></p>
<p>Choix de objets avec Add &gt; OS volume (je veux sauvegarder uniquement le
volume contenant l’OS)</p>
<p><img src="./media/image299.png"
style="width:6.27014in;height:0.93681in" /></p>
<p>J’ai choisi Veeam backup repository (crée au début du TP)</p>
<p><img src="./media/image300.png"
style="width:6.27014in;height:2.56458in" /></p>
<p>Le nom DNS est automatiquement rempli</p>
<p><img src="./media/image301.png"
style="width:1.90625in;height:0.59375in" /></p>
<p>Choix de 2 points de restauration</p>
<p><img src="./media/image302.png"
style="width:6.26042in;height:1.67708in" /></p>
<p>Je ne choisis pas de créer une cache</p>
<p><img src="./media/image303.png"
style="width:6.25087in;height:0.93763in" /></p>
<p>J’ai laissé par défaut application-aware processing (traitement sensible
aux applications)</p>
<p><img src="./media/image304.png"
style="width:6.16753in;height:1.02098in" /></p>
<p>J’ai choisi une sauvegarde par mois</p>
<p><img src="./media/image305.png"
style="width:4.3339in;height:2.08751in" /></p>
<p>Le récapitulatif</p>
<p><img src="./media/image306.png"
style="width:2.46875in;height:2.21875in" /></p>
<p>VEEAM lance son scan vers le client et installe l’agent si nécessaire</p>
<p><img src="./media/image307.png"
style="width:4.22388in;height:3.51522in" /></p>
<p>Début de la sauvegarde</p>
<p><img src="./media/image308.png"
style="width:4.29355in;height:2.22547in" /></p>
<p>Fin de la sauvegarde</p>
<p><img src="./media/image309.png"
style="width:6.26042in;height:4.15625in" /></p>
</section>
</section>
<section id="restaurer-dun-fichier">
<h3>Restaurer d’un fichier<a class="headerlink" href="#restaurer-dun-fichier" title="Lien permanent vers cette rubrique"></a></h3>
<section id="restaurer-dun-fichier-dun-vm-linux">
<h4>Restaurer d’un fichier d’un VM Linux<a class="headerlink" href="#restaurer-dun-fichier-dun-vm-linux" title="Lien permanent vers cette rubrique"></a></h4>
<p>Pour tester la restauration d’un fichier, j’ai créé un fichier test.odt
puis j’ai effectué une sauvegarde. Par la suite j’ai supprimé le fichier
pour pouvoir restaurer à partir de la sauvegarde.</p>
<p><img src="./media/image310.png"
style="width:3.7922in;height:0.96889in" /></p>
<p>Choix restore</p>
<p><img src="./media/image311.png"
style="width:3.80008in;height:1.17934in" /></p>
<p>Choix guest files restore</p>
<p><img src="./media/image312.png"
style="width:2.74506in;height:2.19248in" /></p>
<p><img src="./media/image313.png"
style="width:6.27014in;height:0.67569in" /></p>
<p>Choix de la machine virtuelle sur laquelle je veux restaurer le fichier
supprimé.</p>
<p><img src="./media/image314.png"
style="width:5.95522in;height:1.5656in" /></p>
<p>Choix du point de restauration</p>
<p><img src="./media/image315.png"
style="width:5.73134in;height:2.07547in" /></p>
<p>Choix du linux serveur sur lequel on va « monter » notre VM debcli2</p>
<p>Linux server &gt; Add</p>
<p><img src="./media/image316.png"
style="width:6.27014in;height:2.17917in" /></p>
<p>J’ai choisi comme helper host un Ubuntu serveur 22.04</p>
<p><img src="./media/image317.png"
style="width:6.27083in;height:2.16667in" /></p>
<p>Credentials &gt; Add &gt; Linux Account</p>
<p><img src="./media/image318.png"
style="width:6.27014in;height:1.49583in" /></p>
<p><img src="./media/image319.png"
style="width:2.57979in;height:2.45635in" /></p>
<p>Choix <strong>Oui</strong></p>
<p><img src="./media/image320.png"
style="width:4.64179in;height:1.05653in" /></p>
<p>Les composants manquants seront automatiquement installés sur le Helper
host</p>
<p><img src="./media/image321.png"
style="width:5.11001in;height:1.89991in" /></p>
<p><img src="./media/image322.png"
style="width:4.01756in;height:2.85666in" /></p>
<p>Récapitulatif</p>
<p><img src="./media/image323.png"
style="width:3.15625in;height:2.22917in" /></p>
<p>On peut renseigner une raison pour laquelle on effectue une
restauration.</p>
<p><img src="./media/image324.png"
style="width:4.58987in;height:1.54182in" /></p>
<p>Choix Browse</p>
<p><img src="./media/image325.png"
style="width:6.27083in;height:4.1875in" /></p>
<p>La sauvegarde linux a été correctement monté, on peut rechercher le
fichier supprimé</p>
<p><img src="./media/image326.png"
style="width:6.27014in;height:2.39444in" /></p>
<p>J’ai effectué un clic droit sur le fichier à restaurer :</p>
<p><img src="./media/image327.png"
style="width:6.27014in;height:0.59514in" /></p>
<p>Restauration en cours</p>
<p><img src="./media/image328.png"
style="width:5.90707in;height:1.93777in" /></p>
<p>Restauration effectuée</p>
<p><img src="./media/image329.png"
style="width:5.95833in;height:4.92708in" /></p>
<p>Je me suis reconnecté sur le client <strong>debcli01</strong> pour vérifier si la
restauration a bien été effectué.</p>
<p><img src="./media/image330.png"
style="width:5.19864in;height:0.59383in" /></p>
<p>Le fichier a été correctement restauré. Une fois la fenêtre fermée, le
client est automatiquement démonté du serveur.</p>
<p><img src="./media/image331.png"
style="width:6.27014in;height:2.03125in" /></p>
</section>
<section id="restaurer-dun-fichier-dun-vm-windows">
<h4>Restaurer d’un fichier d’un VM Windows<a class="headerlink" href="#restaurer-dun-fichier-dun-vm-windows" title="Lien permanent vers cette rubrique"></a></h4>
<p>Je supprime un fichier du dossier téléchargement</p>
<p><img src="./media/image332.png"
style="width:5.31462in;height:1.19136in" /></p>
<p>Choix Restore</p>
<p><img src="./media/image333.png"
style="width:3.47201in;height:1.10004in" /></p>
<p>Choix Guest files restore</p>
<p><img src="./media/image334.png"
style="width:4.18808in;height:0.70843in" /></p>
<p>Choix Microsoft Windows</p>
<p><img src="./media/image335.png"
style="width:5.83415in;height:0.83345in" /></p>
<p>J’ai choisi la machine CLIWIN01</p>
<p><img src="./media/image336.png"
style="width:6.26042in;height:1.6875in" /></p>
<p><img src="./media/image337.png"
style="width:6.27083in;height:1.79167in" /></p>
<p><img src="./media/image338.png"
style="width:5.96849in;height:1.8152in" /></p>
<p>Récapitulatif. J’ai cliqué sur <strong>Browse</strong>.</p>
<p><img src="./media/image339.png"
style="width:6.26042in;height:4.41667in" /></p>
<p>J’ai recherché le fichier manquant</p>
<p><img src="./media/image340.png"
style="width:5.3309in;height:2.52877in" /></p>
<p>J’ai choisi le fichier à restaurer</p>
<p><img src="./media/image341.png"
style="width:6.27014in;height:1.03403in" /></p>
<p>Le fichier a été correctement restauré</p>
<p><img src="./media/image342.png"
style="width:5.35321in;height:4.43284in" /></p>
<p>J’ai vérifié sur la VM si le fichier a bien été récupéré. Le fichier a
été correctement restauré.</p>
<p><img src="./media/image343.png"
style="width:6.27014in;height:1.28611in" /></p>
</section>
</section>
</section>
<section id="id31">
<h2>Conclusion<a class="headerlink" href="#id31" title="Lien permanent vers cette rubrique"></a></h2>
<p>VEEAM est un outil complet proposant une multitude de possibilité de
sauvegarde. Il est très performant même dans sa version Community
Edition. La restauration d’une VM entier actuellement n’est compatible
qu’avec VMWare et HYPER-V mais pas des VM Proxmox.</p>
</section>
</section>
<section id="serveur-exchange-2019">
<h1><strong>Serveur Exchange 2019</strong><a class="headerlink" href="#serveur-exchange-2019" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id32">
<h2>Objectif et environnement<a class="headerlink" href="#id32" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id33">
<h3>Objectif<a class="headerlink" href="#id33" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>L’installation d’un serveur exchange 2019.</p></li>
</ol>
</section>
<section id="id34">
<h3>Environnement<a class="headerlink" href="#id34" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.16.0.0/16</p></li>
<li><p>Serveur Samba et impression : SRV-W19-EXC 172.28.1.201/16</p></li>
<li><p>Client Debian 1 : clideb1 172.16.2.1/16</p></li>
</ul>
</section>
<section id="id35">
<h3>Documentation<a class="headerlink" href="#id35" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://rdr-it.com/exchange2019-installation/2/">https://rdr-it.com/exchange2019-installation/2/</a></p></li>
</ul>
</section>
</section>
<section id="id36">
<h2>Processus<a class="headerlink" href="#id36" title="Lien permanent vers cette rubrique"></a></h2>
<section id="configuration-deuxieme-controleur-de-domaine">
<h3>Configuration deuxième contrôleur de domaine<a class="headerlink" href="#configuration-deuxieme-controleur-de-domaine" title="Lien permanent vers cette rubrique"></a></h3>
<section id="id37">
<h4>Fixer l’adresse IP<a class="headerlink" href="#id37" title="Lien permanent vers cette rubrique"></a></h4>
<p><img src="./media/image344.png"
style="width:2.51295in;height:2.86773in" /></p>
</section>
<section id="entrer-le-serveur-dans-le-domaine">
<h4>Entrer le serveur dans le domaine<a class="headerlink" href="#entrer-le-serveur-dans-le-domaine" title="Lien permanent vers cette rubrique"></a></h4>
<p><img src="./media/image345.png"
style="width:2.04167in;height:2.48256in" /></p>
<p><img src="./media/image346.png"
style="width:2.23824in;height:1.60024in" /></p>
<p><img src="./media/image347.png"
style="width:2.28071in;height:1.04282in" /></p>
<p><img src="./media/image348.png"
style="width:3.69843in;height:1.94819in" /></p>
</section>
</section>
<section id="installation-microsoft-exchange">
<h3>Installation Microsoft Exchange<a class="headerlink" href="#installation-microsoft-exchange" title="Lien permanent vers cette rubrique"></a></h3>
<section id="prerequis">
<h4>Prérequis<a class="headerlink" href="#prerequis" title="Lien permanent vers cette rubrique"></a></h4>
<p>Installation Microsoft Visual C++ 2013</p>
<p><img src="./media/image349.png"
style="width:3.79825in;height:2.35811in" /></p>
<p>Installation des fonctionnalités sur Windows serveur</p>
<p>Exécuter la commande suivante en Powershell</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Install-WindowsFeature</span> <span class="n">Server-Media-Foundation</span><span class="p">,</span>
<span class="n">NET-Framework</span><span class="p">-</span><span class="n">45-Features</span><span class="p">,</span> <span class="n">RPC-over-HTTP-proxy</span><span class="p">,</span> <span class="n">RSAT-Clustering</span><span class="p">,</span>
<span class="n">RSAT-Clustering-CmdInterface</span><span class="p">,</span> <span class="n">RSAT-Clustering-Mgmt</span><span class="p">,</span>
<span class="n">RSAT-Clustering-PowerShell</span><span class="p">,</span> <span class="n">WAS-Process-Model</span><span class="p">,</span> <span class="n">Web-Asp-Net45</span><span class="p">,</span>
<span class="n">Web-Basic-Auth</span><span class="p">,</span> <span class="n">Web-Client-Auth</span><span class="p">,</span> <span class="n">Web-Digest-Auth</span><span class="p">,</span> <span class="n">Web-Dir-Browsing</span><span class="p">,</span>
<span class="n">Web-Dyn-Compression</span><span class="p">,</span> <span class="n">Web-Http-Errors</span><span class="p">,</span> <span class="n">Web-Http-Logging</span><span class="p">,</span>
<span class="n">Web-Http-Redirect</span><span class="p">,</span> <span class="n">Web-Http-Tracing</span><span class="p">,</span> <span class="n">Web-ISAPI-Ext</span><span class="p">,</span> <span class="n">Web-ISAPI-Filter</span><span class="p">,</span>
<span class="n">Web-Lgcy-Mgmt-Console</span><span class="p">,</span> <span class="n">Web-Metabase</span><span class="p">,</span> <span class="n">Web-Mgmt-Console</span><span class="p">,</span> <span class="n">Web-Mgmt-Service</span><span class="p">,</span>
<span class="n">Web-Net-Ext45</span><span class="p">,</span> <span class="n">Web-Request-Monitor</span><span class="p">,</span> <span class="n">Web-Server</span><span class="p">,</span> <span class="n">Web-Stat-Compression</span><span class="p">,</span>
<span class="n">Web-Static-Content</span><span class="p">,</span> <span class="n">Web-Windows-Auth</span><span class="p">,</span> <span class="n">Web-WMI</span><span class="p">,</span>
<span class="n">Windows-Identity-Foundation</span><span class="p">,</span> <span class="n">RSAT-ADDS</span>
</pre></div>
</div>
<p><img src="./media/image350.png"
style="width:6.26129in;height:1.0939in" /></p>
</section>
<section id="installation-microsoft-exchange-iso">
<h4>Installation Microsoft Exchange ISO<a class="headerlink" href="#installation-microsoft-exchange-iso" title="Lien permanent vers cette rubrique"></a></h4>
<p>Exécution Setup an tant Administrateur</p>
<p><img src="./media/image351.png"
style="width:6.27014in;height:4.80417in" /></p>
<p><img src="./media/image352.png"
style="width:6.27014in;height:2.85486in" /></p>
<p><img src="./media/image353.png"
style="width:4.38941in;height:3.29363in" /></p>
<img src="./media/image354.png" style="width:5.98in;height:2.42742in" /><p><img src="./media/image355.png"
style="width:5.30282in;height:2.1253in" /></p>
<p><img src="./media/image356.png"
style="width:5.48794in;height:2.13889in" /></p>
<p><img src="./media/image357.png"
style="width:5.51204in;height:2.34181in" /></p>
<p><img src="./media/image358.png"
style="width:5.48094in;height:4.6669in" /></p>
<p>Installation complémentaire des prérequis nécessaires :</p>
<ul class="simple">
<li><p>.Net Framework 4.8</p></li>
<li><p>Microsoft Unified Communications Managed API 4.0, Core Runtime 64-Bit</p></li>
<li><p>URL Rewrite (module de réécriture d’URL IIS)</p></li>
</ul>
<p><img src="./media/image359.png"
style="width:6.27014in;height:5.36875in" /></p>
<p><img src="./media/image360.png"
style="width:6.27014in;height:2.34167in" /></p>
<p><img src="./media/image361.png"
style="width:4.25415in;height:3.81925in" /></p>
</section>
<section id="configuration-du-serveur">
<h4>Configuration du serveur<a class="headerlink" href="#configuration-du-serveur" title="Lien permanent vers cette rubrique"></a></h4>
<p>Configuration langue et l’heure</p>
<p><img src="./media/image362.png"
style="width:6.27014in;height:4.45764in" /></p>
<p><img src="./media/image363.png"
style="width:6.27014in;height:3.64931in" /></p>
<p>Créer une boite à lettre</p>
<p><img src="./media/image364.png"
style="width:5.57769in;height:1.96569in" /></p>
<p>Parcourir</p>
<p><img src="./media/image365.png"
style="width:2.42506in;height:3.0256in" /></p>
<p><img src="./media/image366.png"
style="width:2.57456in;height:3.46258in" /></p>
<p><img src="./media/image367.png"
style="width:2.56659in;height:2.76541in" /></p>
<p><img src="./media/image368.png"
style="width:6.27014in;height:2.20139in" /></p>
</section>
<section id="configurer-outlook">
<h4>Configurer Outlook<a class="headerlink" href="#configurer-outlook" title="Lien permanent vers cette rubrique"></a></h4>
<p>Ouvrir application Outlook</p>
<p><img src="./media/image369.png"
style="width:2.52224in;height:2.85428in" /></p>
<p>Choix exchange</p>
<p><img src="./media/image370.png"
style="width:2.49078in;height:2.80528in" /></p>
<p><img src="./media/image371.png"
style="width:3.75972in;height:2.52874in" /></p>
<p>J’ai installé les certificats</p>
<p><img src="./media/image372.png"
style="width:2.74425in;height:3.5195in" /></p>
<p>J’ai envoyé un message test entre deux compte Outlook</p>
<img src="./media/image373.png" style="width:6.27014in;height:2.45in" /><p>L’échange de mail fonctionne correctement.</p>
</section>
<section id="acces-a-webmail">
<h4>Accès à Webmail<a class="headerlink" href="#acces-a-webmail" title="Lien permanent vers cette rubrique"></a></h4>
<p>Je me suis rendu avec le client linux sur l’adresse
<a class="reference external" href="https://srv-w19-exc/owa/">https://srv-w19-exc/owa/</a></p>
<p><img src="./media/image374.png"
style="width:3.68508in;height:1.615in" /></p>
<p>Un fois les accès renseignés, j’accède aux mails</p>
<p><img src="./media/image375.png"
style="width:3.66552in;height:2.58442in" /></p>
</section>
<section id="configuration-la-messagerie-avec-thunderbird">
<h4>Configuration la messagerie avec Thunderbird<a class="headerlink" href="#configuration-la-messagerie-avec-thunderbird" title="Lien permanent vers cette rubrique"></a></h4>
<p>Tout d’abords il faut démarrer et laisser en mode automatique le service
IMAP4 sur le serveur exchange</p>
<p><img src="./media/image376.png"
style="width:3.52132in;height:4.44854in" /></p>
<p>Les paramètres de ma configuration</p>
<p><img src="./media/image377.png"
style="width:1.74204in;height:1.01717in" /></p>
<p>Puis configuration manuelle</p>
<p><img src="./media/image378.png"
style="width:3.11458in;height:4.22407in" /></p>
<p>Puis cliqué sur terminer</p>
<p>J’ai confirmé l’exception de sécurité</p>
<p><img src="./media/image379.png"
style="width:4.70363in;height:2.80455in" /></p>
<p><img src="./media/image380.png"
style="width:2.62384in;height:2.98735in" /></p>
<p><img src="./media/image381.png"
style="width:6.27014in;height:2.05556in" /></p>
<p>Thunderbird est ainsi configuré.</p>
</section>
</section>
</section>
<section id="id38">
<h2>Conclusion<a class="headerlink" href="#id38" title="Lien permanent vers cette rubrique"></a></h2>
<p>Le serveur de messagerie est fonctionnel, néanmoins Thunderbird ne
récupère pas automatiquement le carnet d’adresse. Ils existent des
solutions payantes comme ExQuilla for Microsoft Echange plugin pour
pallier ce problème.</p>
</section>
</section>
<section id="serveur-cups-impression">
<h1><strong>Serveur CUPS (impression)</strong><a class="headerlink" href="#serveur-cups-impression" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id39">
<h2>Objectif et environnement<a class="headerlink" href="#id39" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id40">
<h3>Objectif<a class="headerlink" href="#id40" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>L’installation d’un serveur d’impression sur linux (SAMBA). Ce
serveur est colocalisé avec le serveur de fichier.</p></li>
</ol>
</section>
<section id="id41">
<h3>Environnement<a class="headerlink" href="#id41" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.28.0.0/16</p></li>
<li><p>Serveur SRV-UBU-SMB(SAMBA) : 172.28.1.202</p></li>
</ul>
</section>
<section id="id42">
<h3>Documentation<a class="headerlink" href="#id42" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="http://www.unixmaniax.fr/wiki/index.php?title=Samba_-_serveur_d%27impression#:~:text=sur%20le%20serveur-,Principe,connect%C3%A9es%20en%20direct%20au%20serveur">http://www.unixmaniax.fr/wiki/index.php?title=Samba_-_serveur_d%27impression#:~:text=sur%20le%20serveur-,Principe,connect%C3%A9es%20en%20direct%20au%20serveur</a>).</p></li>
</ul>
</section>
</section>
<section id="id43">
<h2>Processus<a class="headerlink" href="#id43" title="Lien permanent vers cette rubrique"></a></h2>
<p>Pour l’installation nous avons utilisé le VM serveur de fichier ou SAMBA
est déjà installé.</p>
<section id="configuration-cups">
<h3>Configuration CUPS<a class="headerlink" href="#configuration-cups" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt install cups cups-client
</pre></div>
</div>
<p>Sauvegarder le fichier de configuration CUPS avant de le modifier :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp /etc.cups/cupsd.conf /etc.cups/cupsd.conf.bkp
</pre></div>
</div>
<p>Le fichier cupsd.conf</p>
<p><img src="./media/image382.png"
style="width:4.47979in;height:1.17725in" /></p>
<p><img src="./media/image383.png"
style="width:3.84429in;height:4.44854in" /></p>
<p>Ajout du serveur d’impression dans SAMBA</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nano /etc/samba.smb.conf
</pre></div>
</div>
<p><img src="./media/image384.png"
style="width:5.92791in;height:2.95875in" /></p>
<p>Redémarrer les services</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl restart cups smbd nmdb
</pre></div>
</div>
<p>L’administration du CUPS est accessible sur le port 631.</p>
<p><img src="./media/image385.png"
style="width:6.26042in;height:2.79167in" /></p>
</section>
<section id="ajouter-une-imprimante">
<h3>Ajouter une imprimante<a class="headerlink" href="#ajouter-une-imprimante" title="Lien permanent vers cette rubrique"></a></h3>
<p>Pour pouvoir tester l’imprimante du PEI, nous avons ajouté
temporairement une carte réseau au VM dans le réseau 192.168.10.0/24 en
dhcp.</p>
<p><img src="./media/image386.png"
style="width:4.79569in;height:2.89473in" /></p>
<p><img src="./media/image387.png"
style="width:5.75416in;height:3.10746in" /></p>
<p><img src="./media/image388.png"
style="width:3.78209in;height:2.31165in" /></p>
<p>J’ai choisi une pilote générique, puis continuer</p>
<p><img src="./media/image389.png"
style="width:2.61659in;height:2.71746in" /></p>
<p>Choix PCL laser printer, puis ajouter une imprimante</p>
<p><img src="./media/image390.png"
style="width:2.98717in;height:3.03604in" /></p>
<p><img src="./media/image391.png"
style="width:2.49958in;height:0.68432in" /></p>
<p>Pour tester, il suffit d’imprimer une page de test</p>
<p><img src="./media/image392.png"
style="width:4.2366in;height:1.61365in" /></p>
</section>
<section id="ajouter-une-imprimante-aux-clients">
<h3>Ajouter une imprimante aux clients<a class="headerlink" href="#ajouter-une-imprimante-aux-clients" title="Lien permanent vers cette rubrique"></a></h3>
<p>L’imprimante partagée est automatiquement reconnue sur le réseau :</p>
<p>Linux</p>
<p><img src="./media/image393.png"
style="width:3.9842in;height:1.36983in" /></p>
<p>Windows</p>
<p><img src="./media/image394.png"
style="width:2.70417in;height:1.70062in" /></p>
</section>
<section id="integrer-le-serveur-dimpression-dans-active-directory">
<h3>Intégrer le serveur d’impression dans Active Directory<a class="headerlink" href="#integrer-le-serveur-dimpression-dans-active-directory" title="Lien permanent vers cette rubrique"></a></h3>
<p><img src="./media/image148.png"
style="width:3.27764in;height:1.64777in" /></p>
<p>NB : le procédé d’intégration est expliqué dans le chapitre <a class="reference external" href="#joindre-un-client-linux-dans-active-directory">création
Active Directory</a>.</p>
</section>
</section>
<section id="id44">
<h2>Conclusion<a class="headerlink" href="#id44" title="Lien permanent vers cette rubrique"></a></h2>
<p>CUPS est un outil léger pour ajouter une imprimante en réseaux,
néanmoins l’ajout de pilotes propriétaires peut être fastidieux.</p>
</section>
</section>
<section id="serveur-glpi">
<h1><strong>Serveur GLPI</strong><a class="headerlink" href="#serveur-glpi" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id45">
<h2>Objectif et environnement<a class="headerlink" href="#id45" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id46">
<h3>Objectif<a class="headerlink" href="#id46" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>L’installation d’un serveur GLPI sur un conteneur Debian 11.3.</p></li>
</ol>
</section>
<section id="id47">
<h3>Environnement<a class="headerlink" href="#id47" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.28.0.0/16</p></li>
<li><p>Serveur GLPI : 172.28.1.205</p></li>
</ul>
</section>
<section id="id48">
<h3>Documentation<a class="headerlink" href="#id48" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://rdr-it.com/glpi-liaison-avec-un-active-directory/">https://rdr-it.com/glpi-liaison-avec-un-active-directory/</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=5cThhFcGwc0&amp;t=4s">https://www.youtube.com/watch?v=5cThhFcGwc0&amp;t=4s</a></p></li>
</ul>
</section>
</section>
<section id="id49">
<h2>Processus<a class="headerlink" href="#id49" title="Lien permanent vers cette rubrique"></a></h2>
<section id="configuration-du-conteneur">
<h3>Configuration du conteneur<a class="headerlink" href="#configuration-du-conteneur" title="Lien permanent vers cette rubrique"></a></h3>
<p>Ressources</p>
<p><img src="./media/image395.png"
style="width:4.24017in;height:1.07307in" /></p>
<p>Network</p>
<p><img src="./media/image396.png"
style="width:6.27014in;height:0.23819in" /></p>
<p>DNS</p>
<p><img src="./media/image397.png"
style="width:2.96916in;height:0.80219in" /></p>
</section>
<section id="mise-a-jour-et-installation-des-paquets-necessaires">
<h3>Mise à jour et installation des paquets nécessaires<a class="headerlink" href="#mise-a-jour-et-installation-des-paquets-necessaires" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mise à jour</span>
apt update <span class="o">&amp;&amp;</span> apt upgrade -y  
  
<span class="c1"># Installation Apache2 Php et Mariadb  </span>
apt install apache2 perl php mariadb-server -y
</pre></div>
</div>
<p>Autoriser le serveur apache et mariadb pour se lancer au démarrage du
l’ordinateur</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl <span class="nb">enable</span> apache2 mariadb
</pre></div>
</div>
<p>Installation des paquets nécessaires pour glpi</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt install
php-<span class="o">{</span>ldap,imap,apcu,xmlrpc,cas,mysqli,mbstring,curl,simplexml,xml,intl,zip,bz2<span class="o">}</span>
-y

<span class="c1"># Redémarrer le serveur apache</span>

systemctl restart apache2
</pre></div>
</div>
</section>
<section id="telechargement-du-paquet-glpi-9-5-6">
<h3>Téléchargement du paquet GLPI 9.5.6<a class="headerlink" href="#telechargement-du-paquet-glpi-9-5-6" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget github.com/glpi-project/glpi/releases/download/9.5.6/glpi-9.5.6.tgz
</pre></div>
</div>
<p>Décompression du fichier dans l’emplacement prévu</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tar -xvf glpi-9.5.6.tgz -C /var/www/html/
</pre></div>
</div>
<p>J’ai ensuite changé le propriétaire du dossier téléchargé et ajouter des
droits</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>chown -R www-data:www-data /var/www/html/glpi  
chmod -R <span class="m">775</span> /var/www/html/glpi
</pre></div>
</div>
</section>
<section id="creation-de-la-base-de-donnees">
<h3>Création de la base de données<a class="headerlink" href="#creation-de-la-base-de-donnees" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mysql  
create database glpi <span class="p">;</span>  
create user glpi@localhost identified by ‘Azerty123+’ <span class="p">;</span>  
grant all privileges on glpi.<span class="se">\*</span> to glpi@localhost<span class="p">;</span>

flush privileges <span class="p">;</span>

<span class="nb">exit</span> <span class="p">;</span>
</pre></div>
</div>
<p>Je suis allé sur la page internet <a class="reference external" href="http://172.28.1.212/glpi">http://172.28.1.212/glpi</a></p>
<p><img src="./media/image398.png"
style="width:6.27014in;height:1.86944in" /></p>
<p><img src="./media/image399.png"
style="width:6.27014in;height:3.99861in" /></p>
<p><img src="./media/image400.png"
style="width:6.27014in;height:2.49514in" /></p>
<p><img src="./media/image401.png"
style="width:4.67107in;height:5.7518in" /></p>
<blockquote>
<div><p>Serveur SQL : localhost</p>
<p>Utilisateur SQL : glpi</p>
<p>Mot de passe SQL : glpi</p>
</div></blockquote>
<p><img src="./media/image402.png"
style="width:6.27014in;height:3.31875in" /></p>
<p><img src="./media/image403.png"
style="width:6.27014in;height:3.04653in" /></p>
<p><img src="./media/image404.png"
style="width:6.27014in;height:1.50556in" /></p>
<p><img src="./media/image405.png"
style="width:6.27014in;height:2.11389in" /></p>
<p><img src="./media/image406.png"
style="width:6.27014in;height:3.88125in" /></p>
<p><img src="./media/image407.png"
style="width:6.27014in;height:3.02986in" /></p>
<p><img src="./media/image408.png"
style="width:6.27014in;height:2.68681in" /></p>
<p><img src="./media/image409.png"
style="width:3.70885in;height:3.7922in" /></p>
</section>
<section id="installation-du-version-glpi-10-0-2">
<h3>Installation du version GLPI 10.0.2<a class="headerlink" href="#installation-du-version-glpi-10-0-2" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget github.com/glpi-project/glpi/releases/download/10.0.2/glpi-10.0.2.tgz
</pre></div>
</div>
<p>Les étapes restantes sont identiques à l’étape précédente.</p>
<p>Je suis allé sur la page internet <a class="reference external" href="http://127.0.0.1/glpi">http://127.0.0.1/glpi</a></p>
<p><img src="./media/image410.png"
style="width:4.74418in;height:1.54059in" /></p>
<p><img src="./media/image411.png"
style="width:4.77564in;height:3.10424in" /></p>
<p><img src="./media/image412.png"
style="width:4.82015in;height:1.93521in" /></p>
<p><img src="./media/image413.png"
style="width:6.27014in;height:5.81736in" /></p>
<p>Une extension est absente</p>
<p><img src="./media/image414.png"
style="width:6.27014in;height:0.53472in" /></p>
<p>J’ai installé extension</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt install php7.4-gd
systemctl restart apache2
</pre></div>
</div>
<p>J’ai réessayé la configuration</p>
<p><img src="./media/image415.png"
style="width:6.27014in;height:0.92778in" /></p>
<p>La configuration est correcte</p>
<p><img src="./media/image416.png"
style="width:6.27014in;height:0.55833in" /></p>
<p>C’est avertissement n’est pas bloquante</p>
<p><img src="./media/image417.png"
style="width:6.27014in;height:0.73472in" /></p>
<p><img src="./media/image418.png"
style="width:5.54408in;height:3.31024in" /></p>
<p><img src="./media/image419.png"
style="width:5.08718in;height:3.44479in" /></p>
<p><img src="./media/image420.png"
style="width:6.27014in;height:2.21875in" /></p>
<p><img src="./media/image421.png"
style="width:4.37904in;height:3.99832in" /></p>
<p><img src="./media/image422.png"
style="width:3.67727in;height:2.23104in" /></p>
<p><img src="./media/image423.png"
style="width:4.31776in;height:2.20073in" /></p>
<p><img src="./media/image424.png"
style="width:4.31847in;height:3.02326in" /></p>
<p><img src="./media/image425.png"
style="width:6.27014in;height:3.47708in" /></p>
</section>
<section id="connecter-le-serveur-glpi-avec-une-active-directory">
<h3>Connecter le serveur GLPI avec une Active Directory<a class="headerlink" href="#connecter-le-serveur-glpi-avec-une-active-directory" title="Lien permanent vers cette rubrique"></a></h3>
<p>Menu Configuration &gt; Authentification</p>
<p><img src="./media/image426.png"
style="width:1.5137in;height:2.97476in" /></p>
<p>Annuaire LDAP, puis ajouter</p>
<p><img src="./media/image427.png"
style="width:2.79947in;height:2.05887in" /></p>
<p><img src="./media/image428.png"
style="width:6.27014in;height:0.36181in" /></p>
<p>Nous avons utilisé cette configuration :</p>
<p><img src="./media/image429.png"
style="width:6.2407in;height:4.78645in" /></p>
<p>OU administrateurs contient l’ensemble des utilisateurs qu’on souhaite
importer. Un fois la configuration faite, nous pouvons la tester :</p>
<p><img src="./media/image430.png"
style="width:6.27014in;height:1.19444in" /></p>
<p><img src="./media/image431.png"
style="width:6.27014in;height:1.03889in" /></p>
<p>Importer les utilisateurs</p>
<p>Administration &gt; Utilisateurs &gt; Liaison annuaire LDAP</p>
<p><img src="./media/image432.png"
style="width:6.27014in;height:0.85972in" /></p>
<p>Puis importation de nouveaux utilisateurs &gt; Rechercher</p>
<p><img src="./media/image433.png"
style="width:6.27014in;height:1.13681in" /></p>
<p>J’ai sélectionné les utilisateurs, puis importer.</p>
<p><img src="./media/image434.png"
style="width:5.50518in;height:2.15354in" /></p>
<section id="installation-plugin-fusioninventory-sur-glpi-9-5-6">
<h4>Installation plugin fusioninventory sur GLPI 9.5.6<a class="headerlink" href="#installation-plugin-fusioninventory-sur-glpi-9-5-6" title="Lien permanent vers cette rubrique"></a></h4>
<p>Pour pallier le problème du lien entre OCS inventory et GLPI, j’ai
installé le plugin fusioninventory sur GLPI 9.5.6. Au moment de la
rédaction du document, fusioninventory n’est pas compatible avec GLPI
10.0.2.</p>
<p>Installation du plugin</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget https://github.com/fusioninventory/fusioninventory-for-glpi/releases/download/glpi9.5%2B4.2
</pre></div>
</div>
<p>J’ai décompressé le fichier dans /var/www/html/plugins</p>
<p>Puis installé avec la commande suivante :</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">php bin/console glpi:plugin:install --username=glpi fusioninventory  </span>
<span class="x">php bin/console glpi:plugin:activate fusioninventory</span>
</pre></div>
</div>
<p>Accueil &gt; Configuration &gt; Plugins</p>
<p><img src="./media/image435.png"
style="width:6.27014in;height:1.67639in" /></p>
<p>Accueil &gt; Administration &gt; Entités &gt; Entité racine &gt; Fusioninventory</p>
<p><img src="./media/image436.png"
style="width:6.27014in;height:3.06944in" /></p>
</section>
</section>
<section id="installation-fusioninventory-agent-sur-linux">
<h3>Installation fusioninventory agent sur linux<a class="headerlink" href="#installation-fusioninventory-agent-sur-linux" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt install -y fusioninventory-agent
</pre></div>
</div>
<p>J’ai modifié le fichier <strong>/etc/fusioninventory/agent.cfg</strong></p>
<p><img src="./media/image437.png"
style="width:5.43826in;height:0.38547in" /></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl restart fusioninventory-agent.service
</pre></div>
</div>
<section id="forcer-la-synchronisation-du-lagent">
<h4>Forcer la synchronisation du l’agent<a class="headerlink" href="#forcer-la-synchronisation-du-lagent" title="Lien permanent vers cette rubrique"></a></h4>
<p>Pour vérifier que le plugin fonctionne correctement, on peut se rendre
sur sa page d’accueil dans un navigateur.</p>
<p><a class="reference external" href="http://localhost%C2%A0:62354">http://localhost :62354</a></p>
<p><img src="./media/image438.png"
style="width:6.27014in;height:3.59653in" /></p>
<p>Pour forcer la synchronistation je suis allé sur le site</p>
<p><a class="reference external" href="http://localhost:62354/now">http://localhost:62354/now</a></p>
<p>Ce message d’erreur apparut</p>
<p><img src="./media/image439.png"
style="width:5.19864in;height:0.94805in" /></p>
<p>J’ai modifié le fichier <strong>/etc/fusioninventory/agent.cfg</strong></p>
<p><img src="./media/image440.png"
style="width:4.25059in;height:0.41672in" /></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl restart fusioninventory-agent.service
</pre></div>
</div>
<p><img src="./media/image441.png"
style="width:4.45252in;height:0.90166in" /></p>
<p><img src="./media/image442.png"
style="width:6.27014in;height:0.99375in" /></p>
</section>
</section>
<section id="installation-fusioninventory-agent-sur-windows">
<h3>Installation fusioninventory agent sur Windows<a class="headerlink" href="#installation-fusioninventory-agent-sur-windows" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’ai téléchargé l’installateur sur le site de GitHub</p>
<p><a class="reference external" href="https://github.com/fusioninventory/fusioninventory-agent/releases/tag/2.6">https://github.com/fusioninventory/fusioninventory-agent/releases/tag/2.6</a></p>
<p><img src="./media/image443.png"
style="width:2.96916in;height:1.58355in" /><img src="./media/image444.png"
style="width:3.01798in;height:2.33318in" /></p>
<p><img src="./media/image445.png"
style="width:2.97044in;height:2.29643in" /><img src="./media/image446.png"
style="width:2.99842in;height:2.32605in" /></p>
<p><img src="./media/image447.png"
style="width:3.08173in;height:2.37964in" /><img src="./media/image448.png"
style="width:3.10219in;height:2.39062in" /></p>
<p><img src="./media/image449.png"
style="width:3.05119in;height:2.36973in" /><img src="./media/image450.png"
style="width:3.15734in;height:2.46068in" /></p>
<p><img src="./media/image451.png"
style="width:2.93893in;height:2.29046in" /><img src="./media/image452.png"
style="width:2.92579in;height:2.26513in" /></p>
<p><img src="./media/image453.png"
style="width:3.06827in;height:2.40234in" /><img src="./media/image454.png"
style="width:2.99915in;height:2.32734in" /></p>
<p><img src="./media/image455.png"
style="width:2.98284in;height:2.31799in" />
<img src="./media/image456.png"
style="width:3.01747in;height:2.34083in" /></p>
<p><img src="./media/image457.png"
style="width:6.27014in;height:0.85903in" /></p>
<p><img src="./media/image458.png"
style="width:6.27014in;height:1.87708in" /></p>
<p><img src="./media/image459.png"
style="width:6.27014in;height:1.91111in" /></p>
</section>
<section id="integrer-glpi-dans-active-directory">
<h3>Intégrer GLPI dans Active Directory<a class="headerlink" href="#integrer-glpi-dans-active-directory" title="Lien permanent vers cette rubrique"></a></h3>
<p><img src="./media/image148.png"
style="width:3.27764in;height:1.64777in" /></p>
<p>NB : le procédé d’intégration est expliqué dans le chapitre <a class="reference external" href="#joindre-un-client-linux-dans-active-directory">création
Active Directory</a>.</p>
</section>
</section>
<section id="id50">
<h2>Conclusion<a class="headerlink" href="#id50" title="Lien permanent vers cette rubrique"></a></h2>
<p>L’installation du serveur GLPI est correctement déroulée sur un
conteneur Debian 11.3 ainsi que l’intégration du l’agent fusion
inventory.</p>
</section>
</section>
<section id="serveur-samba">
<h1><strong>Serveur SAMBA</strong><a class="headerlink" href="#serveur-samba" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id51">
<h2>Objectif et environnement<a class="headerlink" href="#id51" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id52">
<h3>Objectif<a class="headerlink" href="#id52" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>L’installation et configuration un serveur de partage de fichier
SAMBA et impression sur Ubuntu serveur.</p></li>
</ol>
</section>
<section id="id53">
<h3>Environnement<a class="headerlink" href="#id53" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.16.0.0/16</p></li>
<li><p>Serveur Samba et impression : SRV-UBU-SMB 172.28.1.202/16</p></li>
<li><p>Client Debian 1 : clideb1 172.28.2.1/16</p></li>
</ul>
</section>
<section id="id54">
<h3>Documentation :<a class="headerlink" href="#id54" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://linuxfr.org/news/creation-d-un-serveur-de-fichiers-sous-ubuntu#toc-introduction">https://linuxfr.org/news/creation-d-un-serveur-de-fichiers-sous-ubuntu#toc-introduction</a></p></li>
</ul>
</section>
</section>
<section id="id55">
<h2>Processus<a class="headerlink" href="#id55" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id56">
<h3>Installation<a class="headerlink" href="#id56" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’ai créé une sauvegarde en faisant :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo cp /etc/netplan/00-installer-config.yaml
/etc/netplan//00-installer-config.yaml.bkp
</pre></div>
</div>
<p>Dans le fichier /etc/netplan/00-installer-config.yaml</p>
<p><img src="./media/image460.png"
style="width:3.69843in;height:1.88568in" /></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo netplan apply
</pre></div>
</div>
<section id="installation-des-logiciels-dauthentification-sur-le-domaine">
<h4>Installation des logiciels d’authentification sur le domaine<a class="headerlink" href="#installation-des-logiciels-dauthentification-sur-le-domaine" title="Lien permanent vers cette rubrique"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install acl realmd libnss-winbind winbind
</pre></div>
</div>
</section>
<section id="creer-lespace-de-stockage-des-partages">
<h4>Créer l’espace de stockage des partages<a class="headerlink" href="#creer-lespace-de-stockage-des-partages" title="Lien permanent vers cette rubrique"></a></h4>
<p><img src="./media/image461.png"
style="width:6.27083in;height:1.89583in" /></p>
<p>Création nouvelle partition</p>
<p><img src="./media/image462.png"
style="width:6.27083in;height:2.80208in" /></p>
<p>Créer le groupe de volumes LVM</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vgcreate samba /dev/sdb1
</pre></div>
</div>
<p><img src="./media/image463.png"
style="width:6.26042in;height:1.01042in" /></p>
</section>
</section>
<section id="joindre-la-machine-virtuelle-au-domaine">
<h3>Joindre la machine virtuelle au domaine<a class="headerlink" href="#joindre-la-machine-virtuelle-au-domaine" title="Lien permanent vers cette rubrique"></a></h3>
<section id="installer-kerberos">
<h4>Installer Kerberos<a class="headerlink" href="#installer-kerberos" title="Lien permanent vers cette rubrique"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install krb5-user
</pre></div>
</div>
<p><img src="./media/image464.png"
style="width:6.27014in;height:1.82569in" /></p>
<p><img src="./media/image465.png"
style="width:6.26042in;height:1.42708in" /></p>
<p><img src="./media/image466.png"
style="width:6.26042in;height:1.46875in" /></p>
<p>On a édité le fichier /etc/krb5.conf</p>
<p><img src="./media/image467.png"
style="width:3.17434in;height:0.44991in" /></p>
<p><img src="./media/image468.png"
style="width:3.58383in;height:0.91679in" /></p>
<p><img src="./media/image469.png"
style="width:2.74731in;height:2.27296in" /></p>
</section>
<section id="installation-samba">
<h4>Installation SAMBA<a class="headerlink" href="#installation-samba" title="Lien permanent vers cette rubrique"></a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt update <span class="o">&amp;&amp;</span> sudo apt upgrade -y

sudo apt install -y samba
</pre></div>
</div>
<p>Modifier le fichier /etc/samba/smb.conf</p>
<p><img src="./media/image470.png"
style="width:5.42019in;height:3.73692in" /></p>
<p><img src="./media/image471.png"
style="width:3.6776in;height:2.11488in" /></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install -y ntp
</pre></div>
</div>
<p>On a modifié le fichier /etc/ntp.conf comme suite :</p>
<p>Redémarrer ntp et smbd</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>service ntp restart  
service smbd restart
</pre></div>
</div>
<p>Nous avons rentré notre serveur samba dans le domaine</p>
<p><img src="./media/image472.png"
style="width:6.27014in;height:0.18889in" /></p>
<p>Configurer NSS</p>
<p>service winbind restart</p>
<p>Nous avons modifié le fichier /etc/nsswitch.conf</p>
<p><img src="./media/image473.png"
style="width:2.63926in;height:0.43341in" /></p>
<p>Pour vérifier si tout est fonctionnel jusqu’au présent</p>
<p><img src="./media/image474.png"
style="width:3.81182in;height:2.66828in" /></p>
</section>
<section id="preparation-pam">
<h4>Préparation PAM<a class="headerlink" href="#preparation-pam" title="Lien permanent vers cette rubrique"></a></h4>
<p><img src="./media/image475.png"
style="width:5.90707in;height:0.73969in" /></p>
<p>pam-auth-update</p>
<p><img src="./media/image476.png"
style="width:6.27014in;height:1.62083in" /></p>
<p>Nous avons sélectionné <strong>Non</strong>.</p>
<p>Nous avons modifié le fichier /etc/pam.d/common-auth</p>
<p><img src="./media/image477.png"
style="width:6.27014in;height:0.57292in" /></p>
<p>Nous avons modifié le fichier /etc/pam.d/common-password</p>
<p><img src="./media/image478.png"
style="width:6.27014in;height:0.43889in" /></p>
<p>Nous avons modifié le fichier /etc/pam.d/common-session</p>
<p><img src="./media/image479.png"
style="width:6.27014in;height:1.17708in" /></p>
<p>Configuration du fuseau horaire (choix France/Paris)</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo dpkg-reconfigure tzdata
sudo reboot
</pre></div>
</div>
<p>Vérification espace de partage disponible</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo vgdisplay <span class="se">\&gt;</span> vgdisplay.txt  
vim vgdisplay.txt
</pre></div>
</div>
<p><img src="./media/image480.png"
style="width:4.13081in;height:2.74686in" /></p>
<p>Création du partage</p>
<p><img src="./media/image481.png"
style="width:4.06307in;height:0.89596in" /></p>
<p>Création du volume logique</p>
<p><img src="./media/image482.png"
style="width:6.26042in;height:0.59375in" /></p>
<p>Formatage de la partition</p>
<p><img src="./media/image483.png"
style="width:6.27083in;height:2.05208in" /></p>
</section>
<section id="montage-du-volume-logique">
<h4>Montage du volume logique<a class="headerlink" href="#montage-du-volume-logique" title="Lien permanent vers cette rubrique"></a></h4>
<p>Récupération ID du disque</p>
<p><img src="./media/image484.png"
style="width:6.27014in;height:1.19792in" /></p>
<p>Nous avons ajouté le fichier /etc/fstab pour un montage automatique</p>
<p><img src="./media/image485.png"
style="width:6.27014in;height:0.26389in" /></p>
<p>Montage de toutes les partitions et vérifier le montage</p>
<p><img src="./media/image486.png"
style="width:5.07362in;height:1.64606in" /></p>
<p>Retirer l’espace réservé pour root (inutile)</p>
<p><img src="./media/image487.png"
style="width:6.27083in;height:0.72917in" /></p>
</section>
<section id="definition-des-droits-dacces-avec-les-acl">
<h4>Définition des droits d’accès avec les ACL<a class="headerlink" href="#definition-des-droits-dacces-avec-les-acl" title="Lien permanent vers cette rubrique"></a></h4>
<p><img src="./media/image488.png"
style="width:4.05265in;height:1.06265in" /></p>
<p>Création d’un groupe sur l’Active Directory</p>
<p>En prévision des définitions ACL j’ai créé un groupe nommé <strong>partage</strong>
sur l’AD</p>
<p><img src="./media/image489.png"
style="width:6.27014in;height:4.41944in" /></p>
<p>Puis j’ai ajouté deux membres</p>
<p><img src="./media/image490.png"
style="width:3.8311in;height:1.88428in" /></p>
<p>Définition ACL sur la racine du partage</p>
<p>Attention ! T2SR\<strong>smbpartage</strong> – partage correspond au nom groupe
précédemment créé</p>
<p><img src="./media/image491.png"
style="width:6.04251in;height:0.25003in" /></p>
<p>Définition ACL par défaut du partage</p>
<p><img src="./media/image492.png"
style="width:6.16753in;height:0.16669in" /></p>
</section>
<section id="modification-du-samba">
<h4>Modification du Samba<a class="headerlink" href="#modification-du-samba" title="Lien permanent vers cette rubrique"></a></h4>
<p><img src="./media/image493.png"
style="width:3.01084in;height:1.60439in" /></p>
<p>Redémarrage le service Samba</p>
<p>sudo systemctl restart smbd</p>
</section>
<section id="test-partage-avec-un-client-debian">
<h4>Test partage avec un client Debian<a class="headerlink" href="#test-partage-avec-un-client-debian" title="Lien permanent vers cette rubrique"></a></h4>
<p>+ Autre emplacements</p>
<p><img src="./media/image494.png"
style="width:2.82963in;height:2.96936in" /></p>
<p>Nous avons renseigné le dossier partage</p>
<img src="./media/image495.png" style="width:6.27014in;height:0.35in" /><p>Si le fichier /etc/hosts est bien renseigné, on peut se connecter par le
nom aussi</p>
<p><img src="./media/image496.png"
style="width:6.27014in;height:0.23958in" /></p>
<p><img src="./media/image497.png"
style="width:3.30857in;height:2.40569in" /></p>
<p><img src="./media/image498.png"
style="width:2.70052in;height:1.25457in" /></p>
</section>
<section id="test-partage-avec-un-client-windows">
<h4>Test partage avec un client Windows<a class="headerlink" href="#test-partage-avec-un-client-windows" title="Lien permanent vers cette rubrique"></a></h4>
<p>J’ai ajouté un emplacement réseau</p>
<p><img src="./media/image499.png"
style="width:5.91749in;height:2.43784in" /></p>
<p><img src="./media/image500.png"
style="width:5.69871in;height:1.90652in" /></p>
<p><img src="./media/image501.png"
style="width:4.27769in;height:2.12938in" /></p>
</section>
</section>
<section id="integrer-samba-dans-active-directory">
<h3>Intégrer Samba dans Active Directory<a class="headerlink" href="#integrer-samba-dans-active-directory" title="Lien permanent vers cette rubrique"></a></h3>
<p><img src="./media/image148.png"
style="width:3.27764in;height:1.64777in" /></p>
<p>NB : le procédé d’intégration est expliqué dans le chapitre <a class="reference external" href="#joindre-un-client-linux-dans-active-directory">création
Active Directory</a>.</p>
</section>
</section>
<section id="id57">
<h2>Conclusion<a class="headerlink" href="#id57" title="Lien permanent vers cette rubrique"></a></h2>
<p>La mise en place d’un serveur de partage est complexe si on souhaite
synchroniser les accès et droits avec un Active Directory.</p>
</section>
</section>
<section id="serveur-zabbix">
<h1><strong>Serveur Zabbix</strong><a class="headerlink" href="#serveur-zabbix" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id58">
<h2>Objectif et environnement<a class="headerlink" href="#id58" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id59">
<h3>Objectif<a class="headerlink" href="#id59" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>L’installation et configuration d’un serveur Zabbix</p></li>
</ol>
</section>
<section id="id60">
<h3>Environnement<a class="headerlink" href="#id60" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.16.0.0/16</p></li>
<li><p>Serveur FreePBX : SRV-UBU-ZBX 172.28.1.210/16</p></li>
</ul>
</section>
<section id="id61">
<h3>Documentation :<a class="headerlink" href="#id61" title="Lien permanent vers cette rubrique"></a></h3>
<p>- <a class="reference external" href="https://www.zabbix.com/">https://www.zabbix.com/</a></p>
<p>- <a class="reference external" href="https://repo.zabbix.com/zabbix/6.0/">https://repo.zabbix.com/zabbix/6.0/</a></p>
</section>
</section>
<section id="id62">
<h2>Processus<a class="headerlink" href="#id62" title="Lien permanent vers cette rubrique"></a></h2>
<section id="installation-de-zabbix">
<h3>Installation de Zabbix<a class="headerlink" href="#installation-de-zabbix" title="Lien permanent vers cette rubrique"></a></h3>
<p>Nous avons créé une VM avec l’ISO de Zabbix 6.0 LTS puis lancé
l’installation</p>
<p><img src="./media/image502.png"
style="width:4.89652in;height:3.35463in" /></p>
<p>L’installation se déroule automatiquement</p>
<p><img src="./media/image503.png"
style="width:4.75463in;height:1.66825in" /></p>
<p>Une fois l’installation est terminée, nous pouvons accéder à Zabbix via
le navigateur web :</p>
<p><a class="reference external" href="http://172.28.1.210/zabbix">http://172.28.1.210/zabbix</a></p>
<p>Utilisateur par défaut : Admin</p>
<p>Mot de passe par défaut : zabbix</p>
<p><img src="./media/image504.png"
style="width:1.93335in;height:1.97538in" /></p>
</section>
<section id="ajouter-un-host">
<h3>Ajouter un Host<a class="headerlink" href="#ajouter-un-host" title="Lien permanent vers cette rubrique"></a></h3>
<p>Dans la barre latérale Configuration &gt; Hôtes</p>
<p><img src="./media/image505.png"
style="width:1.29947in;height:3.55807in" /></p>
<p>Créer un hôte</p>
<p><img src="./media/image506.png"
style="width:4.47811in;height:2.78636in" /></p>
<p>L’installation de l’agent Zabbix sous Linux</p>
<p>J’ai téléchargé la package zabbix correspondant à la VM depuis le site
officiel :</p>
<p><img src="./media/image507.png"
style="width:6.27014in;height:0.17361in" /></p>
<p>Installation du package et démarrage du service</p>
<p><img src="./media/image508.png"
style="width:4.34436in;height:1.06265in" /></p>
<p>Modification du fichier de configuration :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nano /etc/zabbix/zabbix_agentd.conf
</pre></div>
</div>
<p>Server doit correspond à l’adresse ip du serveur zabbix.</p>
<p><img src="./media/image509.png"
style="width:2.00028in;height:0.58341in" /></p>
<p>Puis j’ai redémarré le service</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl restart zabbix-agent
</pre></div>
</div>
<p>Le serveur GLPI a correctement monté :</p>
<p><img src="./media/image510.png"
style="width:6.27014in;height:0.36875in" /></p>
<p>J’ai effectué les mêmes manipulations pour tous les serveurs de type
linux.</p>
<p><img src="./media/image511.png"
style="width:6.27014in;height:0.73889in" /></p>
</section>
<section id="linstallation-de-lagent-zabbix-sous-windows">
<h3>L’installation de l’agent Zabbix sous Windows<a class="headerlink" href="#linstallation-de-lagent-zabbix-sous-windows" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’ai téléchargé l’agent sur le site officiel correspondant à Windows:</p>
<p><a class="reference external" href="https://www.zabbix.com/download_agents?version=6.0+LTS&amp;release=6.0.7&amp;os=Windows&amp;os_version=Any&amp;hardware=amd64&amp;encryption=OpenSSL&amp;packaging=MSI&amp;show_legacy=0">https://www.zabbix.com/download_agents?version=6.0+LTS&amp;release=6.0.7&amp;os=Windows&amp;os_version=Any&amp;hardware=amd64&amp;encryption=OpenSSL&amp;packaging=MSI&amp;show_legacy=0</a></p>
<p><img src="./media/image512.png"
style="width:3.69632in;height:2.88971in" /></p>
<p><img src="./media/image513.png"
style="width:3.67987in;height:3.06947in" /></p>
<p><img src="./media/image514.png"
style="width:3.73568in;height:2.91046in" /></p>
<p>Menu Configuration &gt; Hôte &gt; Ajouter</p>
<p><img src="./media/image515.png"
style="width:6.27014in;height:3.69028in" /></p>
<p>Environ 60s plus tard le serveur ajouté devient disponible</p>
<p><img src="./media/image516.png"
style="width:6.27014in;height:0.18542in" /></p>
</section>
<section id="le-tableau-de-bord">
<h3>Le tableau de bord<a class="headerlink" href="#le-tableau-de-bord" title="Lien permanent vers cette rubrique"></a></h3>
<p><img src="./media/image517.png"
style="width:5.03392in;height:3.42099in" /></p>
<p>Les serveurs surveillés</p>
<p><img src="./media/image518.png"
style="width:6.27014in;height:1.80903in" /></p>
</section>
<section id="integrer-zabbix-dans-active-directory">
<h3>Intégrer Zabbix dans Active Directory<a class="headerlink" href="#integrer-zabbix-dans-active-directory" title="Lien permanent vers cette rubrique"></a></h3>
<p><img src="./media/image148.png"
style="width:3.27764in;height:1.64777in" /></p>
<p>NB : le procédé d’intégration est expliqué dans le chapitre <a class="reference external" href="#joindre-un-client-linux-dans-active-directory">création
Active Directory</a>.</p>
</section>
</section>
<section id="id63">
<h2>Conclusion<a class="headerlink" href="#id63" title="Lien permanent vers cette rubrique"></a></h2>
<p>La configuration du serveur Zabbix avec le déploiement des agents est
terminée.</p>
</section>
</section>
<section id="truenas">
<h1><strong>TrueNAS</strong><a class="headerlink" href="#truenas" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id64">
<h2>Objectif et environnement<a class="headerlink" href="#id64" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id65">
<h3>Objectif<a class="headerlink" href="#id65" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>L’installation et configuration d’un serveur TrueNAS</p></li>
</ol>
</section>
<section id="id66">
<h3>Environnement<a class="headerlink" href="#id66" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.16.0.0/16</p></li>
<li><p>Serveur SRV-NAS : SRV-PBX-VOIP 172.28.1.209/16</p></li>
</ul>
</section>
<section id="id67">
<h3>Documentation :<a class="headerlink" href="#id67" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.truenas.com/">https://www.truenas.com/</a></p></li>
</ul>
</section>
</section>
<section id="id68">
<h2>Processus<a class="headerlink" href="#id68" title="Lien permanent vers cette rubrique"></a></h2>
<section id="installation-de-truenas">
<h3>Installation de trueNAS<a class="headerlink" href="#installation-de-truenas" title="Lien permanent vers cette rubrique"></a></h3>
<img src="./media/image519.png" style="width:6.3in;height:3.8375in" /><p>Je choisis la première option</p>
<img src="./media/image520.png" style="width:6.3in;height:1.98125in" /><p>Je choisis la première option</p>
<p><img src="./media/image521.png"
style="width:5.8654in;height:1.96902in" /></p>
<p>Je sélectionne le disque sur lequel l’os va s’installé</p>
<img src="./media/image522.png" style="width:6.3in;height:2.13056in" /><p>Je choisie « yes »</p>
<p><img src="./media/image523.png"
style="width:4.83401in;height:1.88568in" /></p>
<p>Je mets un mot de passe au compte root</p>
<img src="./media/image524.png" style="width:6.3in;height:1.3875in" /><p>Je choisie de boot en BIOS, puis j’attends la fin de l’installation</p>
<img src="./media/image525.png" style="width:6.3in;height:1.06042in" /><p>Je redémarre le serveur NAS</p>
<p><img src="./media/image526.png"
style="width:3.30254in;height:3.04209in" /></p>
<p>Je configure l’adresse IP du NAS en sélectionnant l’option 1, puis je
suis les instructions.</p>
<p>J’ai aussi configuré les routes statiques et l’adresse de DNS.</p>
<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="header">
<th><p><img src="./media/image527.png"
style="width:2.025in;height:2.49653in" />Je tape l’adresse IP du serveur
NAS pour accéder à sa page web de gestion et je me connecte avec
l’utilisateur root.</p>
<p>Ci-dessous l’interface web.</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><img src="./media/image528.png"
style="width:4.3748in;height:3.36405in" /></td>
</tr>
</tbody>
</table></section>
<section id="creation-dun-volume-de-stockage-dataset">
<h3>Création d’un volume de stockage + dataset<a class="headerlink" href="#creation-dun-volume-de-stockage-dataset" title="Lien permanent vers cette rubrique"></a></h3>
<p>Dans le menu à gauche dans <strong>Stockage</strong> &gt; <strong>Volumes</strong>.</p>
<p><img src="./media/image529.png"
style="width:2.13623in;height:0.8886in" /></p>
<p>Je créer un nouveau volume.</p>
<p><img src="./media/image530.png"
style="width:4.64094in;height:0.98374in" /></p>
<p><img src="./media/image531.png"
style="width:4.63745in;height:2.27579in" /></p>
<p>Je nome le nouveau volume et je sélectionne les disques disponibles qui
y seront rattaché.</p>
<p><img src="./media/image532.png"
style="width:4.63996in;height:3.17105in" /></p>
<p>Pour le TP nous avons ajouté un troisième disque a notre serveur qui est
externe en USB.</p>
<p><img src="./media/image533.png"
style="width:6.44872in;height:4.7747in" /></p>
<p>Je sélectionne un seconde fois le disque et je force la création du vdev
du volume.</p>
<img src="./media/image534.png" style="width:2.65542in;height:1.23069in" /><img src="./media/image535.png" style="width:3.27299in;height:1.23524in" /><p>A deux reprises j’ai un message me demandant si je suis sûr d’effectuer
la manipulation, chose que je confirme.</p>
<img src="./media/image536.png" style="width:2.68788in;height:1.92735in" /><p>Le volume est en cours de création, cela peut prendre plusieurs minutes.</p>
<p>Une fois le volume créer, je créer mes dataset.</p>
<img src="./media/image537.png" style="width:5.4049in;height:2.40039in" /><p>J’ai créé deux dataset, ISO et BACKUP avec la même configuration.</p>
<img src="./media/image538.png" style="width:4.32793in;height:3.36664in" /><blockquote>
<div><p><strong>Il faut changer le type de partage en SMB</strong></p>
</div></blockquote>
<img src="./media/image539.png" style="width:6.3in;height:1.70139in" /><p>Mes deux dataset son créer.</p>
</section>
<section id="mise-en-place-du-partage-windows-smb">
<h3>Mise en place du partage Windows (SMB)<a class="headerlink" href="#mise-en-place-du-partage-windows-smb" title="Lien permanent vers cette rubrique"></a></h3>
<img src="./media/image540.png" style="width:2.20278in;height:2.70972in" /><p>Dans le menu à gauche, <strong>Partage</strong> &amp; <strong>SMB</strong></p>
<p>Je créer un partage pour chaque dataset que j’ai créé dans le volume t2sr_storage.</p>
<img src="./media/image541.png" style="width:6.31228in;height:2.77206in" /><img src="./media/image542.png" style="width:6.3in;height:1.14861in" /><p>Mes deux partages sont créés et activé.</p>
</section>
<section id="nas-et-ad">
<h3>NAS et AD<a class="headerlink" href="#nas-et-ad" title="Lien permanent vers cette rubrique"></a></h3>
<img src="./media/image543.png" style="width:0.82986in;height:1.18819in" /><p>Dans le menu à gauche, <strong>Services d’annuaire</strong> &amp; <strong>Active Directory</strong></p>
<p>Je renseigne les informations pour joindre le domaine.</p>
<img src="./media/image544.png" style="width:3.19355in;height:1.78924in" /><p>Cela permet au NAS de connaitre les utilisateurs de l’AD et leur permet de se connecter à lui sans devoir passer par un compte local propre au NAS.</p>
</section>
<section id="test-conclusion">
<h3>TEST + Conclusion<a class="headerlink" href="#test-conclusion" title="Lien permanent vers cette rubrique"></a></h3>
<p>Je me connecte au partage :</p>
<img src="./media/image545.png" style="width:2.63458in;height:1.94254in" /><img src="./media/image546.png" style="width:2.63096in;height:1.94393in" /><img src="./media/image547.png" style="width:2.7608in;height:0.94805in" /><img src="./media/image548.png" style="width:5.19621in;height:1.5427in" /><p>Connection au partage réussi.</p>
</section>
<section id="integrer-truenas-dans-active-directory">
<h3>Intégrer TrueNAS dans Active Directory<a class="headerlink" href="#integrer-truenas-dans-active-directory" title="Lien permanent vers cette rubrique"></a></h3>
<p><img src="./media/image148.png"
style="width:3.27764in;height:1.64777in" /></p>
<p>NB : le procédé d’intégration est expliqué dans le chapitre <a class="reference external" href="#joindre-un-client-linux-dans-active-directory">création
Active Directory</a>.</p>
</section>
</section>
</section>
<section id="serveur-web-lamp">
<h1><strong>Serveur WEB (LAMP)</strong><a class="headerlink" href="#serveur-web-lamp" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id69">
<h2>Objectif et environnement<a class="headerlink" href="#id69" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id70">
<h3>Objectif<a class="headerlink" href="#id70" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>L’installation et configuration d’un serveur LAMP.</p></li>
</ol>
</section>
<section id="id71">
<h3>Environnement<a class="headerlink" href="#id71" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.16.0.0/16</p></li>
<li><p>Serveur CT-DEB-WEB : 172.28.1.208/16</p></li>
</ul>
</section>
<section id="id72">
<h3>Documentation :<a class="headerlink" href="#id72" title="Lien permanent vers cette rubrique"></a></h3>
<p>Un serveur LAMP c’est quoi ?</p>
<p><img src="./media/image549.png"
style="width:1.632in;height:0.86203in" /></p>
<p>Fonctionnement de l’arborescence d’apache</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><img src="./media/image550.png"
style="width:2.02609in;height:2.50827in" /></th>
<th><p>Il y a deux arborescences à prendre en compte :</p>
<ul>
<li><p>/var/www/</p></li>
</ul>
<blockquote>
<p>De préférence, il est recommandé de placer les sites internet à cet
endroit. Celui par défaut d’apache est le dossier html, c’est le fichier
index.html qui est visé et afficher lorsque je tape l’adresse du
serveur.</p>
<p>Pour le TP j’ai rajouté un second dossier avec les fichiers
nécessaire pour un site internet.</p>
</blockquote>
<ul>
<li><p>/etc/apache2 :</p></li>
</ul>
<blockquote>
<p>C’est là que ce trouve les fichiers conf qui constitue le service
web.</p>
<p>Le fichier chuck-norris.conf est représenté car il est utilisé dans
le cadre du TP pour montrer la mise en place d’un site (<a
href="#_Rendre_disponible_une">cf.</a>).</p>
</blockquote></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
</tr>
</tbody>
</table><img src="./media/image551.png" style="width:6.3in;height:2.46458in" /><p>Illustration des éléments prendre en compte dans /etc/apache2</p>
<p>Il y a dans apache une notion de fichier « <strong>disponible</strong> » et
« <strong>actif</strong> », les fichiers conf dit <em>disponible</em> doivent être activé
pour être consultable sur le navigateur internet (sans avoir a tapé
l’URL).</p>
<p>Par exemple dans le cas du fichier 000-default.conf qui est disponible
et activé, tout changement édité sur le fichier dans un des deux
dossiers sera effectué sur son homologue.</p>
</section>
</section>
<section id="id73">
<h2>Processus<a class="headerlink" href="#id73" title="Lien permanent vers cette rubrique"></a></h2>
<section id="installation-dapache-2">
<h3>Installation d’Apache 2<a class="headerlink" href="#installation-dapache-2" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’installe apache avec un module qui permet de gérer PHP.</p>
<p>apt <strong>install</strong> apache2 libapache2-mod-php</p>
<p>Je vérifier le bon fonctionnement du serveur web qui normalement renvoie
la page d’accueil de apache2 (version Debian).</p>
<p><img src="./media/image552.png"
style="width:5.08479in;height:3.50868in" /></p>
<p>Je configure le service apache2 pour qu’il démarre automatiquement au
démarrage du centenaire.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl <span class="nb">enable</span> apache2
</pre></div>
</div>
<p>J’active des modules apaches :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>a2enmod rewrite  
a2enmod deflate  
a2enmod headers
</pre></div>
</div>
<p>Puis je recharge la configuration avec la commande suivante :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl reload apache2
</pre></div>
</div>
<p>Cette commande permet de recharger la configuration d’apache sans pour
autant avoir besoin de relancer entièrement le service.</p>
<p>Pour voir la liste des modules activé je vais dans /etc/apache2/modes
enabled</p>
<img src="./media/image553.png" style="width:6.3in;height:0.85625in" /><p>Comme on peut le voir avant et après l’activation de certains modules,
le contenu du dossier a changé.</p>
</section>
<section id="installation-de-php">
<h3>Installation de Php<a class="headerlink" href="#installation-de-php" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’installe les packages de Php ainsi que les modules php les plus
courants :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt install php php-cli  
apt install php-<span class="o">{</span>curl,gd,intl,memcache,xml,zip,mbstring,json<span class="o">}</span>
</pre></div>
</div>
<p>Pour interagir avec SQL :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt install php-mysql
</pre></div>
</div>
<p>Pour tester le bon fonctionnement de Php je crée un fichier test.php</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">echo &quot;\</span><span class="cp">&lt;?php</span> <span class="nb">phpinfo</span><span class="p">();</span> <span class="o">?</span><span class="nx">\</span><span class="o">&gt;</span><span class="s2">&quot; \&gt; /var/www/html/test.php</span>
</pre></div>
</div>
<img src="./media/image554.png" style="width:6.3in;height:0.84106in" /><p>Dans la barre de recherche d’un navigateur je tape l’adresse de mon
serveur web suivant de test.php, soit :</p>
<p>http://172.28.1.206/test.php</p>
<img src="./media/image555.png" style="width:6.3in;height:1.816in" /><p>Il s’agit de la page récapitulant la configuration de php (version
7.4.30).</p>
<p>Je peux éditer les options de PHP via le fichier
<em><strong>/etc/php/7.4/apache2/php.ini</strong></em> ou créer un fichier personnalisé dans
<em><strong>/etc/php/7.4/apache2/conf.d</strong></em>.</p>
<p>Mais je n’ai pas l’utilité de changer les options, je laisse donc php en
configuration par défaut.</p>
</section>
<section id="installation-de-mariadb-optionnel">
<h3>Installation de MariaDB (optionnel)<a class="headerlink" href="#installation-de-mariadb-optionnel" title="Lien permanent vers cette rubrique"></a></h3>
<p>Je choisis d’installer et utiliser MariaDB pour la base de données du
serveur LAMP.</p>
<p>MariaDB étant le fork<sup>1</sup> de mySQL, le fonctionnement de MariaDB
fonctionnement est similaire a mySQL.</p>
<blockquote>
<div><p><sup>1</sup> <sup>Un fork (terme anglais signifiant « fourche », «
bifurcation », « embranchement ») désigne dans le jargon informatique,
un nouveau logiciel créé à partir du code source d”un logiciel
existant.</sup></p>
</div></blockquote>
<p>J’installe le package :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">install</span> <span class="n">mariadb</span><span class="o">-</span><span class="n">server</span>
</pre></div>
</div>
<p>Je démarre l’installation :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mysql_secure_installation

Change the root password? <span class="se">\[</span>Y/n<span class="se">\]</span> **Y**  
New password: **Azerty123+**  
Re-enter new password: **Azerty123+**  
*Password updated successfully!*  
Remove anonymous users? <span class="se">\[</span>Y/n<span class="se">\]</span> **Y**  
Disallow root login remotely? <span class="se">\[</span>Y/n<span class="se">\]</span> **Y**  
Remove <span class="nb">test</span> database and access to it? <span class="se">\[</span>Y/n<span class="se">\]</span> **Y**  
Reload privilege tables now? <span class="se">\[</span>Y/n<span class="se">\]</span> **Y**
</pre></div>
</div>
<p>Pour entrer dans la base de données :</p>
<img src="./media/image556.png" style="width:6.3in;height:1.63403in" /><p>Création d’un utilisateur admin.</p>
<img src="./media/image557.png" style="width:6.3in;height:1.07014in" /><p>J’active mariaDB au démarrage :</p>
<img src="./media/image558.png" style="width:6.3in;height:0.32569in" /><p><span id="_Rendre_disponible_une" class="anchor"></span></p>
</section>
<section id="rendre-disponible-une-page-web">
<h3>Rendre disponible une page web<a class="headerlink" href="#rendre-disponible-une-page-web" title="Lien permanent vers cette rubrique"></a></h3>
<p>Je dois créer un fichier conf contenant le virtualhosts du site
chuck-norris à mettre en place.</p>
<p>Exemple avec le fichier 000-default.conf :</p>
<p><img src="./media/image559.png"
style="width:4.93037in;height:3.3217in" /></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nano /etc/apache2/sites-available/chuck-norris.conf
</pre></div>
</div>
<p>Fichier chuck-norris.conf créer :</p>
<p><img src="./media/image560.png"
style="width:3.47965in;height:2.10446in" /></p>
<p>En suite avec la commande suivante j’active le site :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>a2ensite chuck-norris

a2dissite pour le désactivé
</pre></div>
</div>
<p>Puis je recharge apache 2 :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl reload apache2
</pre></div>
</div>
</section>
<section id="verification-de-lactivation-du-site">
<h3>Vérification de l’activation du site<a class="headerlink" href="#verification-de-lactivation-du-site" title="Lien permanent vers cette rubrique"></a></h3>
<p>Apache par défaut cherche automatiquement un fichier index.html à
afficher.</p>
<p>Ceci est propre à la configuration du réseau de production sur lequel je
suis, cependant il faut bien renseigner le DNS pour rendre accessible le
site sans avoir a tapé l’adresse IP.</p>
<p><img src="./media/image561.png"
style="width:4.95903in;height:0.39589in" /></p>
<p>Le CNAME est <em><strong>www</strong></em> car il est renseigné ainsi dans le virtualhost du
fichier chuck-norris.conf :</p>
<p><img src="./media/image562.png"
style="width:2.71913in;height:0.47923in" /></p>
<p>Je n’aborderai pas dans cette documentation la possibilité du faire du
multisites sur ce service web.</p>
<p>Je renseigne l’adresse du site et vérifie sa disponibilité.</p>
<p><img src="./media/image563.png"
style="width:4.21231in;height:2.98465in" /></p>
<p>La page est bien chargée et affichée, il ne s’agit que d’une page html
basique afin de vérifier le bon fonctionnement du service web délivré
par serveur LAMP sous conteneur.</p>
</section>
<section id="integrer-le-serveur-web-dans-active-directory">
<h3>Intégrer le serveur WEB dans Active Directory<a class="headerlink" href="#integrer-le-serveur-web-dans-active-directory" title="Lien permanent vers cette rubrique"></a></h3>
<p><img src="./media/image148.png"
style="width:3.27764in;height:1.64777in" /></p>
<p>NB : le procédé d’intégration est expliqué dans le chapitre <a class="reference external" href="#joindre-un-client-linux-dans-active-directory">création
Active Directory</a>.</p>
</section>
</section>
<section id="id74">
<h2>Conclusion<a class="headerlink" href="#id74" title="Lien permanent vers cette rubrique"></a></h2>
<p>Le serveur LAMP est installé et configuré. Actuellement le serveur web
n’utilise pas de base de données, mail elle est installé en mesure
d’être configuré pour une utilisation ultérieure.</p>
</section>
</section>
<section id="freepbx">
<h1><strong>FreePBX</strong><a class="headerlink" href="#freepbx" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id75">
<h2>Objectif et environnement<a class="headerlink" href="#id75" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id76">
<h3>Objectif<a class="headerlink" href="#id76" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>L’installation et configuration d’un serveur FreePBX</p></li>
</ol>
</section>
<section id="id77">
<h3>Environnement<a class="headerlink" href="#id77" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
<li><p>Routeur WIFI TP-LINK TL-WA801ND</p></li>
<li><p>2 x tablettes sous LENOVO tab 7 essential sous Android</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.16.0.0/16</p></li>
<li><p>Serveur FreePBX : SRV-PBX-VOIP 172.28.1.208/16</p></li>
</ul>
</section>
<section id="id78">
<h3>Documentation<a class="headerlink" href="#id78" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.freepbx.org/">https://www.freepbx.org/</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=Ef-ZNHMJ78k">https://www.youtube.com/watch?v=Ef-ZNHMJ78k</a></p></li>
</ul>
</section>
</section>
<section id="id79">
<h2>Processus<a class="headerlink" href="#id79" title="Lien permanent vers cette rubrique"></a></h2>
<section id="installation-vm-freepbx">
<h3>Installation VM FreePBX<a class="headerlink" href="#installation-vm-freepbx" title="Lien permanent vers cette rubrique"></a></h3>
<p>Je choisis l’installation recommandé</p>
<img src="./media/image564.png" style="width:5in;height:1.875in" /><p>Je choisis le “graphic install – output to VGA” puis “FreePBX standard”</p>
<img src="./media/image565.png" style="width:5in;height:1.875in" /><img src="./media/image566.png" style="width:5in;height:1.85417in" /><p>Pendant l’installation je configure le mdp root : “<strong>azerty123+</strong>”</p>
<img src="./media/image567.png" style="width:5in;height:1.29167in" /><img src="./media/image568.png" style="width:5in;height:1.39583in" /><p>Je redémarré à la fin de l’installation</p>
<p>Je me connecte</p>
<p><img src="./media/image569.png"
style="width:2.92413in;height:0.8555in" /></p>
<p><img src="./media/image570.png"
style="width:5.53202in;height:5.27157in" /></p>
<p>J’ai ensuite modifié la langue du clavier en AZERTY :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>system-config-keyboard
</pre></div>
</div>
<p><img src="./media/image571.png"
style="width:2.26791in;height:1.69286in" /></p>
<p>Puis j’ai fixé l’adresse IP de la façon suivante :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nano /etc/sysconfig/network-scripts/ifcfg-eth0
</pre></div>
</div>
<p><img src="./media/image572.png"
style="width:5.89666in;height:3.30254in" /></p>
<p>Redémarrage du service réseau</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>systemctl restart network
</pre></div>
</div>
</section>
<section id="config-freepbx">
<h3>Config FreePBX<a class="headerlink" href="#config-freepbx" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’accède à la page de configuration sur l’adresse <a class="reference external" href="http://172.28.1.208">http://172.28.1.208</a></p>
<p>Initial Setup</p>
<p><img src="./media/image573.png"
style="width:5.51378in;height:3.18894in" /></p>
<img src="./media/image574.png" style="width:6.27014in;height:2.15in" /></section>
<section id="freepbx-administration">
<h3>FreePBX Administration<a class="headerlink" href="#freepbx-administration" title="Lien permanent vers cette rubrique"></a></h3>
<p>Choix du langage (laissé en anglais)</p>
<p><img src="./media/image575.png"
style="width:6.27014in;height:1.31736in" /></p>
<p>Pour la configuration pare-feu j”ai laissé les paramètres par défaut.</p>
<p><img src="./media/image576.png"
style="width:6.19375in;height:2.91667in" /></p>
<img src="./media/image577.png" style="width:5in;height:1.07292in" /><p>Le pare feu passe en vert</p>
<p><img src="./media/image578.png"
style="width:3.47917in;height:2.71806in" /></p>
</section>
<section id="interagir-avec-le-firewall-en-ligne-de-commande">
<h3>Interagir avec le firewall en ligne de commande<a class="headerlink" href="#interagir-avec-le-firewall-en-ligne-de-commande" title="Lien permanent vers cette rubrique"></a></h3>
<p>Arrêter</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>fwconsole firewall stop
</pre></div>
</div>
<p>Démarrer</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>fwconsole firewall start
</pre></div>
</div>
<p>Ajouter une zone de confiance</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>fwconsole firewall trust <span class="m">172</span>.28.0.0/16
</pre></div>
</div>
<p>Retirer une adresse de confiance</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>fwconsole firewall untrust <span class="m">172</span>.28.2.3/32
</pre></div>
</div>
<p>Lister les adresses de confiance</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>fwconsole firewall list trusted
</pre></div>
</div>
</section>
<section id="ajouter-des-utilisateurs-par-extension-non-liee-a-lactive-directory">
<h3>Ajouter des utilisateurs par extension (non liée à l’Active Directory)<a class="headerlink" href="#ajouter-des-utilisateurs-par-extension-non-liee-a-lactive-directory" title="Lien permanent vers cette rubrique"></a></h3>
<p>Menu Application &gt; Extension &gt; Add Extention</p>
<p><img src="./media/image579.png"
style="width:6.27014in;height:1.28403in" /></p>
<p>Add new SIP</p>
<p><img src="./media/image580.png"
style="width:2.68317in;height:1.54593in" /></p>
<p>J’ai ajout user extension 1001 puis cliqué sur <strong>Submit</strong>. (Répéter la
manipulation par utilisateur)</p>
<p><img src="./media/image581.png"
style="width:6.27014in;height:4.38819in" /></p>
<p>Les deux utilisateurs peuvent désormais communiquer</p>
<p><img src="./media/image582.png"
style="width:6.27014in;height:1.38542in" /></p>
</section>
<section id="relier-freepbx-avec-lactive-directory">
<h3>Relier FreePBX avec l’Active Directory<a class="headerlink" href="#relier-freepbx-avec-lactive-directory" title="Lien permanent vers cette rubrique"></a></h3>
<p>Menu &gt; User Manager &gt; Directory &gt; Add</p>
<p><img src="./media/image583.png"
style="width:6.27014in;height:3.1875in" /></p>
<p><img src="./media/image584.png"
style="width:6.27014in;height:0.82014in" /></p>
<p><img src="./media/image585.png"
style="width:6.27014in;height:2.64722in" /></p>
<p>Dans l’exemple, les numéros d’appels sont automatiquement récupérés
depuis l’AD.</p>
<p><img src="./media/image586.png"
style="width:3.75636in;height:3.96305in" /></p>
<p>Les postes sont automatiquement créés</p>
<p><img src="./media/image587.png"
style="width:6.27014in;height:1.62708in" /></p>
<p>Mettre l’Active Directory par défaut</p>
<p>Menu User Manager choix par défaut</p>
<p><img src="./media/image588.png"
style="width:6.27014in;height:2.39792in" /></p>
</section>
<section id="editer-les-comptes-utilisateurs">
<h3>Editer les comptes utilisateurs<a class="headerlink" href="#editer-les-comptes-utilisateurs" title="Lien permanent vers cette rubrique"></a></h3>
<p>Menu Applications &gt; Extentions &gt; Choix Utilisteur</p>
<p><img src="./media/image589.png"
style="width:5.84571in;height:3.88592in" /></p>
<p>On peut attribuer un mot de passe par défaut ou changer la langue dans
le menu général.</p>
</section>
<section id="voicemail">
<h3>Voicemail<a class="headerlink" href="#voicemail" title="Lien permanent vers cette rubrique"></a></h3>
<p>Accéder sur le téléphone par le bouton enveloppe ou sur une application
en composant <strong>*97.</strong></p>
<p>Pour appeler depuis un autre téléphone, appeler *98 et suivez les
instructions.</p>
<p><img src="./media/image590.png"
style="width:6.27014in;height:1.90347in" /></p>
<p>Mot de passe pour le répondeur : <strong>1234</strong></p>
<p>NB : Il faut configurer le répondeur du premier appel.</p>
</section>
<section id="integrer-freepbx-dans-active-directory">
<h3>Intégrer FreePBX dans Active Directory<a class="headerlink" href="#integrer-freepbx-dans-active-directory" title="Lien permanent vers cette rubrique"></a></h3>
<p><img src="./media/image148.png"
style="width:3.27764in;height:1.64777in" /></p>
<p>NB : le procédé d’intégration est expliqué dans le chapitre <a class="reference external" href="#joindre-un-client-linux-dans-active-directory">création
Active Directory</a>.</p>
</section>
</section>
<section id="id80">
<h2>Conclusion<a class="headerlink" href="#id80" title="Lien permanent vers cette rubrique"></a></h2>
<p>L’installation et la configuration basique du serveur FreePBX s’est bien
déroulée.</p>
</section>
</section>
<section id="serveur-ocs">
<h1><strong>Serveur OCS</strong><a class="headerlink" href="#serveur-ocs" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id81">
<h2>Objectif et environnement<a class="headerlink" href="#id81" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id82">
<h3>Objectif<a class="headerlink" href="#id82" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>L’installation et configuration d’un serveur OCS Inventory dur un
containeur Debian 11.</p></li>
</ol>
</section>
<section id="id83">
<h3>Environnement<a class="headerlink" href="#id83" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.16.0.0/16</p></li>
<li><p>Serveur OCS : CT-DEB-GLPI 172.28.1.205/16 (colocalisé avec GLPI)</p></li>
</ul>
</section>
<section id="id84">
<h3>Documentation<a class="headerlink" href="#id84" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.infotrucs.fr/tuto-installer-glpi-et-ocsinventory-sous-debian-11-sans-erreur/">https://www.infotrucs.fr/tuto-installer-glpi-et-ocsinventory-sous-debian-11-sans-erreur/</a></p></li>
</ul>
</section>
</section>
<section id="id85">
<h2>Processus<a class="headerlink" href="#id85" title="Lien permanent vers cette rubrique"></a></h2>
<section id="installation-et-configuration-des-prerequis">
<h3>Installation et configuration des prérequis<a class="headerlink" href="#installation-et-configuration-des-prerequis" title="Lien permanent vers cette rubrique"></a></h3>
</section>
<section id="installation-apache2">
<h3>Installation Apache2<a class="headerlink" href="#installation-apache2" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt update
apt install apache2 -y  
systemctl <span class="nb">enable</span> apache2
</pre></div>
</div>
<p>Création la configuration fqdn</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nano /etc/apache2/conf-available/fqdn.conf  
<span class="c1"># remplissez hostname  </span>
ServerName CT-DEB-GLPI  
a2enconf fqdn  
systemctl reload apache2
</pre></div>
</div>
<p>Installation Php</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt install php -y
</pre></div>
</div>
<p>Créer index.php</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nano /var/www/html/index.php  
</pre></div>
</div>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x"># le contenu du fichier</span>
<span class="x">\&lt; ?php  </span>
<span class="x">Phpinfo() ;  </span>
<span class="x">?\&gt;</span>
</pre></div>
</div>
<p>Vérifiez dans le navigateur</p>
<p><a class="reference external" href="http://172.28.1.211/index.php">http://172.28.1.211/index.php</a></p>
<p><img src="./media/image591.png"
style="width:6.27014in;height:3.60417in" /></p>
<p>Supprimer les fichiers inutiles</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rm /var/www/html/index.php
systemctl restart apache2
</pre></div>
</div>
</section>
<section id="installation-mariadb">
<h3>Installation Mariadb<a class="headerlink" href="#installation-mariadb" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt install mariadb-server mariadb-client -y
systemctl <span class="nb">enable</span> mariadb.service
</pre></div>
</div>
<p>Création de la base de données</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mariadb -u root
</pre></div>
</div>
<p><img src="./media/image592.png"
style="width:6.27014in;height:3.1875in" /></p>
</section>
<section id="installation-ocs-inventory">
<h3>Installation OCS Inventory<a class="headerlink" href="#installation-ocs-inventory" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt install apache2-dev libmariadb-dev-compat php-soap cpanminus
libnet-ssleay-perl libio-socket-ssl-perl -y

cpan install YAML <span class="c1"># répondre yes</span>

cpan install –f CPAN <span class="c1"># répondre yes</span>

cpan install XML::Simple Compress::Zlib DBI DBD::mysql Apache::DBI
Net::IP Archive::Zip XML::Entities

apt install libxml-simple-perl libperl5.32 libdbi-perl libdbd-mysql-perl
libapache-dbi-perl libnet-ip-perl libsoap-lite-perl libarchive-zip-perl
make build-essential php-pclzip php-mbstring php-mysql php-curl php-xml
php-zip php-gd -y

cpan install Apache2::SOAP  
cpan install Mojolicious::Lite Switch Plack::Handler
</pre></div>
</div>
</section>
<section id="installation-du-serveur">
<h3>Installation du serveur<a class="headerlink" href="#installation-du-serveur" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’ai téléchargé ocsinventory sur ce site :
download.ocsinventory-ng.org/nightly</p>
<p>cd /tmp<br />wget
http://download.ocsinventory-ng.org/nightly/OCSNG_UNIX_SERVER_2.10.0-nightly-2022-08-19.tar.gz</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tar xzf OCSNG_UNIX_SERVER_2.10.0-nightly-2022-08-19.tar.gz  
<span class="nb">cd</span> OCSNG_UNIX_SERVER
systemctl restart apache2  
sh setup.sh <span class="c1"># Tapez entrée à chaque question</span>
</pre></div>
</div>
</section>
<section id="configuration-du-serveur-ocs">
<h3>Configuration du serveur OCS<a class="headerlink" href="#configuration-du-serveur-ocs" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nano /etc/apache2/conf-available/z-ocsinventory-server.conf
</pre></div>
</div>
<p>J’ai modifié ses deux lignes pour faire correspond avec la configuration
de notre base de données</p>
<p><img src="./media/image593.png"
style="width:3.49007in;height:0.56258in" /></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nano /etc/apache2/conf-available/zz-ocsinventory-restapi.conf
</pre></div>
</div>
<p><img src="./media/image594.png"
style="width:3.20878in;height:0.40631in" /></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>chown root:www-data /var/lib/ocsinventory-reports  
chmod <span class="m">775</span> /var/lib/ocsinventory-reports
</pre></div>
</div>
</section>
<section id="activation-de-la-configuration-de-ocs">
<h3>Activation de la configuration de OCS<a class="headerlink" href="#activation-de-la-configuration-de-ocs" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>a2enconf z-ocsinventory-server  
a2enconf ocsinventory-reports  
a2enconf zz-ocsinventory-restapi
systemctl restart apache2
</pre></div>
</div>
<p>On accède aux restes des configurations via le navigateur</p>
<p><a class="reference external" href="http://172.28.1.205/ocsreports">http://172.28.1.205/ocsreports</a></p>
<p><img src="./media/image595.png"
style="width:6.27014in;height:4.11944in" /></p>
<p>OCS va peupler la base de données</p>
<p><img src="./media/image596.png"
style="width:6.27014in;height:0.79375in" /></p>
<p><img src="./media/image597.png"
style="width:6.27014in;height:0.61389in" /></p>
<p>J’ai cliqué sur « <strong>Click here to enter OCS-NG GUI »</strong></p>
<p><img src="./media/image598.png"
style="width:6.27014in;height:0.99097in" /></p>
<p>J’ai cliqué sur « <strong>perform the update »</strong></p>
<p><img src="./media/image599.png"
style="width:6.27014in;height:1.21736in" /></p>
<p>Choix de langue en français login: admin, mdp. : admin</p>
<p><img src="./media/image600.png"
style="width:6.27014in;height:5.18681in" /></p>
</section>
<section id="parametrer-ocs">
<h3>Paramétrer OCS<a class="headerlink" href="#parametrer-ocs" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’ai supprimé le fichier indiqué et crée un nouvel utilisateur avec un
différente mot de passe.</p>
<p><img src="./media/image601.png"
style="width:6.27014in;height:0.60208in" /></p>
<p>Menu Configuration &gt; Utilisateurs &gt; Créer un utilisateur</p>
<p><img src="./media/image602.png"
style="width:6.27014in;height:2.45347in" /></p>
<p><img src="./media/image603.png"
style="width:6.27014in;height:0.65278in" /></p>
<p>J’ai supprimé le compte créé par défaut</p>
<p><img src="./media/image604.png"
style="width:6.27014in;height:0.46875in" /></p>
<p>J’ai supprimé également le fichier install.php</p>
<p><img src="./media/image605.png"
style="width:6.27014in;height:0.17222in" /></p>
<p>Une fois la page rafraîchi, l’ALERTE SECURITE disparait.</p>
<p>Menu Configuration &gt; General Configuration &gt; Serveur</p>
<p>J’ai activé TRACE_DELETED (à cause de l’interconnexion avec GLPI)</p>
<p><img src="./media/image606.png"
style="width:6.27014in;height:0.76389in" /></p>
</section>
<section id="configuration-ocs-avec-glpi-10-0-2">
<h3>Configuration OCS avec GLPI 10.0.2<a class="headerlink" href="#configuration-ocs-avec-glpi-10-0-2" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’ai créé un compte gratuit sur <a class="reference external" href="https://services.glpi-network.com/">https://services.glpi-network.com/</a></p>
<p>Ensuite j’ai copié la clé d’enregistrement</p>
<p><img src="./media/image607.png"
style="width:6.29166in;height:1.76298in" /></p>
<p>J’ai copié la clé dans</p>
<p>Menu Configuration &gt; Générale &gt; GLPI Network</p>
<p><img src="./media/image608.png"
style="width:6.27014in;height:3.21528in" /></p>
<p>J’ai accédé GLPI marketplace et téléchargé le plugin OCS Inventory NG</p>
<p>Configuration &gt; Plugins</p>
<p><img src="./media/image609.png"
style="width:6.27014in;height:2.93264in" /></p>
<p>J’ai cliqué sur configurer</p>
<p><img src="./media/image610.png"
style="width:4.03181in;height:2.32324in" /></p>
<p>Serveurs OCSNG</p>
<p><img src="./media/image611.png"
style="width:5.59453in;height:1.05223in" /></p>
<p><img src="./media/image612.png"
style="width:5.43826in;height:0.573in" /></p>
</section>
<section id="ajout-serveur-ocs">
<h3>Ajout serveur OCS<a class="headerlink" href="#ajout-serveur-ocs" title="Lien permanent vers cette rubrique"></a></h3>
<p><img src="./media/image613.png"
style="width:4.10915in;height:3.82972in" /></p>
<p>Tester</p>
<p><img src="./media/image614.png"
style="width:6.27014in;height:1.63264in" /></p>
<p>Menu Outils &gt; OCS Inventory NG</p>
<p><img src="./media/image615.png"
style="width:6.27014in;height:2.35347in" /></p>
<p>Cliqué sur</p>
<p><img src="./media/image616.png"
style="width:4.38603in;height:1.31268in" /></p>
<p>OCS est désormais lié, nous pouvons importer un inventaire.</p>
<img src="./media/image617.png" style="width:4.479in;height:2.2715in" /></section>
<section id="configuration-ssl">
<h3>Configuration SSL<a class="headerlink" href="#configuration-ssl" title="Lien permanent vers cette rubrique"></a></h3>
<p>Création un dossier pour stocker le certificat</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir /etc/apache2/ssl  
<span class="c1"># installation openssl si ce n’est pas déjà le cas*  </span>
apt install openssl
</pre></div>
</div>
<p>Génération d’une clé RSA</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>openssl genrsa <span class="m">2048</span> <span class="se">\&gt;</span> /etc/apache2/ssl/gestparc.key
</pre></div>
</div>
<p>Création du certificat</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>openssl req -new -key /etc/apache2/ssl/gestparc.key -x509 -days <span class="m">365</span> -out
/etc/apache2/ssl/gestparc.crt
</pre></div>
</div>
<p>A la question Common Name, j’ai mis : CT-DEB-GLPI</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Ensuite j’ai édité le fichier
/etc/apache2/sites-available/default-ssl.conf
</pre></div>
</div>
<p><img src="./media/image618.png"
style="width:5.24031in;height:0.51049in" /></p>
<p>J’ai activé SSL</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>a2enmod ssl  
a2ensuite default-ssl  
systemctl restart apache2
</pre></div>
</div>
<p>J’accède à la page GLPI en https</p>
<p><img src="./media/image619.png"
style="width:5.16739in;height:0.92721in" /></p>
</section>
<section id="installation-ocs-inventory-agent-sur-windows">
<h3>Installation OCS Inventory agent sur Windows<a class="headerlink" href="#installation-ocs-inventory-agent-sur-windows" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’ai téléchargé l’agent sur le site officiel :</p>
<p><a class="reference external" href="https://github.com/OCSInventory-NG/WindowsAgent/releases/tag/2.9.2.0">https://github.com/OCSInventory-NG/WindowsAgent/releases/tag/2.9.2.0</a></p>
<p>J’ai installé l’agent</p>
<p><img src="./media/image620.png"
style="width:5.46264in;height:1.46775in" /></p>
<p>J’ai lancé l’installateur</p>
<p><img src="./media/image621.png"
style="width:3.68007in;height:2.85981in" /></p>
<p><img src="./media/image622.png"
style="width:3.63107in;height:2.8301in" /></p>
<p><img src="./media/image623.png"
style="width:3.8079in;height:2.98478in" /></p>
<p><img src="./media/image624.png"
style="width:3.7841in;height:2.92155in" /></p>
<p>J’ai lancé l’installation</p>
<p><img src="./media/image625.png"
style="width:3.71899in;height:2.86936in" /></p>
<p>Ensuite j’ai copié le fichier gestparc.crt dans c:\ProgramData\OCS
Inventory NG\Agent.</p>
<p>Puis j’ai renommé en cacert.pem.</p>
<p><img src="./media/image626.png"
style="width:4.36208in;height:2.33977in" /></p>
<p>J’ai arrêté puis redémarré le service OCS Inventory</p>
<p><img src="./media/image627.png"
style="width:2.87933in;height:3.64948in" /></p>
<p>Notre client apparait dans OCS inventory</p>
<p><img src="./media/image628.png"
style="width:6.27014in;height:0.21597in" /></p>
</section>
<section id="installation-ocs-inventory-agent-sur-linux">
<h3>Installation OCS Inventory agent sur Linux<a class="headerlink" href="#installation-ocs-inventory-agent-sur-linux" title="Lien permanent vers cette rubrique"></a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt update
apt install libmodule-install-perl dmidecode libxml-simple-perl
libcompress-zlib-perl libnet-ip-perl libwww-perl libdigest-md5-perl
libdata-uuid-perl
apt install ocsinventory-agent
</pre></div>
</div>
<p><strong>Choix http</strong></p>
<p>J’ai rentré l’adresse de mon serveur OCS :
<a class="reference external" href="https://glpi-ocs.t2sr.io/ocsinventory">https://glpi-ocs.t2sr.io/ocsinventory</a></p>
<p>J’ai mis à jour le serveur (mis à jour manuel)</p>
<p>ocsinventory-agent –server https://glpi-ocs.t2sr.io/ocsinventory</p>
<p>J’ai modifié de manière que l’agent soit mis à jour par heure :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mv /etc/cron.daily/ocsinventory-agent /etc/cron.hourly
</pre></div>
</div>
<p>Le client Debian est bien arrivé sur OCS</p>
<p><img src="./media/image629.png"
style="width:6.27014in;height:2.27778in" /></p>
</section>
<section id="importer-linventaire-dans-glpi-10-0-2">
<h3>Importer l’inventaire dans GLPI 10.0.2<a class="headerlink" href="#importer-linventaire-dans-glpi-10-0-2" title="Lien permanent vers cette rubrique"></a></h3>
<p>Menu Outils &gt; OCS Inventroy NG &gt; Import de l’inventaire &gt; Importer et
lier des ordinateurs</p>
<p><img src="./media/image630.png"
style="width:6.27014in;height:1.91319in" /></p>
<p><img src="./media/image631.png"
style="width:6.27014in;height:2.525in" /></p>
</section>
<section id="integrer-le-serveur-ocs-dans-active-directory">
<h3>Intégrer le serveur OCS dans Active Directory<a class="headerlink" href="#integrer-le-serveur-ocs-dans-active-directory" title="Lien permanent vers cette rubrique"></a></h3>
<p><img src="./media/image148.png"
style="width:3.27764in;height:1.64777in" /></p>
<p>NB : le procédé d’intégration est expliqué dans le chapitre <a class="reference external" href="#joindre-un-client-linux-dans-active-directory">création
Active Directory</a>.</p>
</section>
</section>
<section id="id86">
<h2>Conclusion<a class="headerlink" href="#id86" title="Lien permanent vers cette rubrique"></a></h2>
<p>L’importation des ordinateurs ne s’est pas déroulée correctement. J’ai
créé une issue sur la page GitHub du développeur.</p>
<p><a class="reference external" href="https://github.com/pluginsGLPI/ocsinventoryng/issues/329">https://github.com/pluginsGLPI/ocsinventoryng/issues/329</a></p>
</section>
</section>
<section id="documentation-avec-sphinx">
<h1><strong>Documentation avec Sphinx</strong><a class="headerlink" href="#documentation-avec-sphinx" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id87">
<h2>Objectif et environnement<a class="headerlink" href="#id87" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id88">
<h3>Objectif<a class="headerlink" href="#id88" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>L’installation et configuration d’un site web documentaire avec
Sphinx.</p></li>
</ol>
</section>
<section id="id89">
<h3>Environnement<a class="headerlink" href="#id89" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.16.0.0/16</p></li>
<li><p>Serveur OCS : CT-DEB-WEB 172.28.1.206/16</p></li>
</ul>
</section>
<section id="id90">
<h3>Documentation<a class="headerlink" href="#id90" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.sphinx-doc.org/en/master/">https://www.sphinx-doc.org/en/master/</a></p></li>
</ul>
</section>
</section>
<section id="id91">
<h2>Processus<a class="headerlink" href="#id91" title="Lien permanent vers cette rubrique"></a></h2>
<section id="pandoc">
<h3>Pandoc<a class="headerlink" href="#pandoc" title="Lien permanent vers cette rubrique"></a></h3>
<p>Je télécharge l’exécutable d’installation de Pandoc sur le site :
<a class="reference external" href="https://pandoc.org/installing.html">https://pandoc.org/installing.html</a>.</p>
<p>Puis je l’exécute.</p>
<section id="id92">
<h4>Installation<a class="headerlink" href="#id92" title="Lien permanent vers cette rubrique"></a></h4>
<p><img src="./media/image632.png"
style="width:2.81658in;height:2.19958in" /></p>
<p>J’accepte les thermes de la licence et j’installe Pandoc pour tous les
utilisateurs</p>
<p><img src="./media/image633.png"
style="width:2.81579in;height:2.22369in" /><img src="./media/image634.png"
style="width:2.80833in;height:1.45108in" /></p>
<p>J’attends la fin de l’installation.</p>
<p><img src="./media/image635.png"
style="width:2.82569in;height:2.18689in" /></p>
<p>Pandoc est bien installé sur mon système d’exploitation, pour l’utiliser
il me suffit dans un cmd ou PowerShell de faire appel à lui parle biais
de la commande <em>pandoc</em>.</p>
</section>
<section id="conversion-dun-docx-en-markdown-avec-les-images">
<h4>Conversion d’un docx en Markdown avec les images<a class="headerlink" href="#conversion-dun-docx-en-markdown-avec-les-images" title="Lien permanent vers cette rubrique"></a></h4>
<p>Je place le fichier docx : Cluster t2sr.io par Pierre et Zoltan ; dans
un dossier sur lequel je vais travailler (dossier pandoc).</p>
<p>Dans un cmd je me place dans mon dossier où se trouve mon fichier docx.
Puis j’exécute la commande suivante :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">pandoc</span> <span class="p">-</span><span class="n">-extract-media</span><span class="p">=./</span> <span class="n">-w</span> <span class="n">gfm</span> <span class="s2">&quot;Cluster t2sr.io par Pierre et</span>
<span class="s2">Zoltan.docx&quot;</span> <span class="n">-o</span> <span class="s2">&quot;Cluster t2sr.io par Pierre et Zoltan.md&quot;</span>
</pre></div>
</div>
<p><img src="./media/image636.png"
style="width:2.63578in;height:0.91679in" /></p>
<p>Pandoc va créer un dossier media avec toutes les images qui sont dans le
docx ainsi qu’un fichier Markdown où il modifie pour chaque image le
chemin d’accès afin qu’elle soit affichée dans le fichier Markdown
lorsqu’il est compiler.</p>
<p>Dans Visual Studio Code grâce à l’extension Markdown, je peux afficher
des fichiers de cette extension et les compiler pour visualiser le
rendu.</p>
<p><img src="./media/image637.png"
style="width:3.56586in;height:2.36231in" /></p>
<p>Voici le rendu du fichier Markdown qui est beaucoup plus simple en mise
en page.</p>
<img src="./media/image638.png" style="width:6.3in;height:2.83958in" /></section>
</section>
<section id="secure-copy-protocol">
<h3>Secure Copy Protocol<a class="headerlink" href="#secure-copy-protocol" title="Lien permanent vers cette rubrique"></a></h3>
<p>Mon réseau de production étant 172.28.0.0/16, j’ai donné temporairement
accès au réseau 192.168.0.0/26 avec un deuxième carte réseau à mon
container WEB.</p>
<p><img src="./media/image639.png"
style="width:4.44183in;height:2.74481in" /></p>
<p>Depuis l’invite de commande de ma machine dans le réseau 192.168.0.0/26,
sur lequel est hébergé mes fichiers de documentations.</p>
<p>J’utilise la commande suivante :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>scp -r <span class="s2">&quot;doc t2sr.io&quot;</span> root@192.168.10.66:/root
</pre></div>
</div>
<img src="./media/image640.png" style="width:6.3in;height:1.41042in" /><p>Sur mon container :</p>
<p><img src="./media/image641.png"
style="width:5.15697in;height:0.3438in" /></p>
</section>
<section id="sphinx-python-documentation-generator">
<h3>Sphinx Python Documentation Generator<a class="headerlink" href="#sphinx-python-documentation-generator" title="Lien permanent vers cette rubrique"></a></h3>
<section id="installation-de-pip">
<h4>Installation de pip<a class="headerlink" href="#installation-de-pip" title="Lien permanent vers cette rubrique"></a></h4>
<p>Sur le serveur LAMP du container WEB qui a python3 j’ai installé le
module pip (package installer for python).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install python3-pip
</pre></div>
</div>
<p>Je vérifie la version de pip :</p>
<p><img src="./media/image642.png"
style="width:5.94875in;height:0.35422in" /></p>
</section>
<section id="documentation-de-sphinx">
<h4>Documentation de sphinx<a class="headerlink" href="#documentation-de-sphinx" title="Lien permanent vers cette rubrique"></a></h4>
<p><a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/installation.html">https://www.sphinx-doc.org/en/master/usage/installation.html</a></p>
<p><a class="reference external" href="https://www.sphinx-doc.org/en/master/tutorial/getting-started.html">https://www.sphinx-doc.org/en/master/tutorial/getting-started.html</a></p>
</section>
<section id="generation-dun-projet-avec-sphinx">
<h4>Génération d’un projet avec sphinx<a class="headerlink" href="#generation-dun-projet-avec-sphinx" title="Lien permanent vers cette rubrique"></a></h4>
<p>Pour générer un site de documentation en HTML, j’utilise Sphinx.</p>
<p>J’installe son package sur le container WEB</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt-get install python3-sphinx
</pre></div>
</div>
<p>je vérifie la version de sphinx :</p>
<p><img src="./media/image643.png"
style="width:4.29227in;height:0.33338in" /></p>
<p>Puis je créer l’arborescence d’un nouveau projet dans <em><strong>/var/www/</strong></em> :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sphinx-quickstart docs
</pre></div>
</div>
<p><img src="./media/image644.png"
style="width:5.7492in;height:3.94941in" /></p>
<p>Une fois créer je vais générer une page html par défaut :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sphinx-build -b html ./docs/source/ ./docs/build/html
</pre></div>
</div>
<p><img src="./media/image645.png"
style="width:6.41511in;height:3.60143in" /></p>
<p>Le dossier html a bien été généré avec son arborescence.</p>
<p><img src="./media/image646.png"
style="width:3.00605in;height:4.9616in" /></p>
<p>Je vérifie la page html généré dans un navigateur d’une VM de mon réseau
de production.</p>
<p>Pour ce faire je renseigne l’adresse suivante pour mon cas :</p>
<img src="./media/image647.png" style="width:6.3in;height:2.01806in" /></section>
<section id="modifier-le-theme">
<h4>Modifier le thème<a class="headerlink" href="#modifier-le-theme" title="Lien permanent vers cette rubrique"></a></h4>
<p>J’installe les packages du thème « Reads the Docs Sample » :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install sphinx-rtd-theme
</pre></div>
</div>
<img src="./media/image648.png" style="width:6.3in;height:0.85625in" /><p>Dans <em><strong>/var/www/docs/source</strong></em> je modifie la ligne « <em>html_theme =</em>
<strong>‘<em><strong>alabaster</strong></em>’</strong> » dans le fichier conf.py</p>
<p><img src="./media/image649.png"
style="width:3.87554in;height:0.39589in" /></p>
<p><img src="./media/image650.png"
style="width:3.5403in;height:3.95466in" /></p>
<p>Je replace la valeur <strong>‘<em><strong>alabaster</strong></em>’</strong> par :
<strong>‘<em><strong>sphinx_rtd_theme</strong></em>’</strong>.</p>
<p>Après avoir modifier le fichier dans la racine de docs
(<strong>/var/www/docs</strong>) je fais cette commande pour générer un nouveau
fichier html :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make html
</pre></div>
</div>
<p><img src="./media/image651.png"
style="width:6.08418in;height:3.75052in" /></p>
<p>Je recharge la page html de mon navigateur internet :</p>
<img src="./media/image652.png" style="width:6.3in;height:2.6625in" /><p>Le thème est appliqué correctement.</p>
</section>
<section id="ajout-du-contenu-au-site-de-documentation-fichier-markdown">
<h4>Ajout du contenu au site de documentation (fichier markdown)<a class="headerlink" href="#ajout-du-contenu-au-site-de-documentation-fichier-markdown" title="Lien permanent vers cette rubrique"></a></h4>
<p>J’installe recommonmark</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install --upgrade recommonmark
</pre></div>
</div>
<img src="./media/image653.png" style="width:6.3in;height:1.22847in" /><p>Les deux sont des parser pour markdown</p>
<p>J’édite le fichier conf.py dans <em><strong>/var/www/docs/source</strong></em></p>
<img src="./media/image654.png" style="width:6.3in;height:2.20347in" /><p>Je place dans le dossier <em>source</em> les fichiers markdown</p>
<p><img src="./media/image655.png"
style="width:6.57917in;height:0.52516in" /></p>
<p>Puis j’édite le fichier <strong>index.rst</strong> situé à la racine de <em>source</em></p>
<p><img src="./media/image656.png"
style="width:1.99194in;height:2.18316in" /></p>
<p>J’ai écrit les noms de mes fichier markdown dans le « <strong>..
toctree ::</strong> »</p>
<p>A la racine du dossier <em>docs</em> je fais la commande suivant pour générer
de nouveau le site en html</p>
<p><strong>make html</strong></p>
<img src="./media/image657.png" style="width:6.3in;height:2.49028in" /><p>Puis je vérifie le site de documentation sur le navigateur :</p>
<img src="./media/image658.png" style="width:6.3in;height:5.14306in" /></section>
</section>
</section>
<section id="id93">
<h2>Conclusion<a class="headerlink" href="#id93" title="Lien permanent vers cette rubrique"></a></h2>
<p>Le site de documentation est fonctionnel, cependant il faut faire
attention à ce que les fichiers en markdown s’il y a de l’indexation
avec des titres soit bien indexé et organisé.</p>
</section>
</section>
<section id="pingcastle">
<h1><strong>PingCastle</strong><a class="headerlink" href="#pingcastle" title="Lien permanent vers cette rubrique"></a></h1>
<section id="id94">
<h2>Objectif et environnement<a class="headerlink" href="#id94" title="Lien permanent vers cette rubrique"></a></h2>
<section id="id95">
<h3>Objectif<a class="headerlink" href="#id95" title="Lien permanent vers cette rubrique"></a></h3>
<ol class="simple">
<li><p>L’installation PingCastle pour auditer le serveur Active Directory.</p></li>
</ol>
</section>
<section id="id96">
<h3>Environnement<a class="headerlink" href="#id96" title="Lien permanent vers cette rubrique"></a></h3>
<p>Matériels :</p>
<ul class="simple">
<li><p>Dell PowerEdge r240 avec Proxmox 7.1-7</p></li>
</ul>
<p>Adressage des VMS :</p>
<ul class="simple">
<li><p>Réseaux : 172.16.0.0/16</p></li>
<li><p>Le logiciel PingCastle est installé directement sur la VM du l’Active
Directory</p></li>
</ul>
</section>
<section id="id97">
<h3>Documentation<a class="headerlink" href="#id97" title="Lien permanent vers cette rubrique"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.it-connect.fr/comment-auditer-lactive-directory-avec-pingcastle/">https://www.it-connect.fr/comment-auditer-lactive-directory-avec-pingcastle/</a></p></li>
<li><p><a class="reference external" href="https://techexpert.tips/fr/powershell-fr/powershell-renommer-un-fichier/">https://techexpert.tips/fr/powershell-fr/powershell-renommer-un-fichier/</a></p></li>
<li><p><a class="reference external" href="https://docs.microsoft.com/fr-fr/powershell/module/microsoft.powershell.management/?view=powershell-7.2">https://docs.microsoft.com/fr-fr/powershell/module/microsoft.powershell.management/?view=powershell-7.2</a></p></li>
<li><p><a class="reference external" href="https://techexpert.tips/fr/windows-fr/gpo-creer-une-tache-planifiee/">https://techexpert.tips/fr/windows-fr/gpo-creer-une-tache-planifiee/</a></p></li>
<li></li>
</ul>
</section>
</section>
<section id="id98">
<h2>Processus<a class="headerlink" href="#id98" title="Lien permanent vers cette rubrique"></a></h2>
<section id="telechargement">
<h3>Téléchargement<a class="headerlink" href="#telechargement" title="Lien permanent vers cette rubrique"></a></h3>
<p>Lien de téléchargement :</p>
<p><a class="reference external" href="https://www.pingcastle.com/download/">https://www.pingcastle.com/download/</a></p>
<p>J’ai téléchargé l’archive et je l’ai extrait.</p>
<p><img src="./media/image659.png"
style="width:4.75475in;height:2.45636in" /></p>
</section>
<section id="realisation-dun-audit-ad">
<h3>Réalisation d’un audit AD<a class="headerlink" href="#realisation-dun-audit-ad" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’exécute l’application <em>PingCastle.exe</em></p>
<p><img src="./media/image660.png"
style="width:5.12509in;height:1.97558in" /></p>
<p>Je me place sur le premier choix et j’appuie sur la touche <em>Entrer</em></p>
<p><img src="./media/image661.png"
style="width:5.09184in;height:1.69443in" /></p>
<p>PingCastle a reconnu le domaine t2sr.io, j’appuie donc de nouveau sur
<em>Entrer</em> car il s’agit du choix par défaut.</p>
<p><img src="./media/image662.png"
style="width:6.47919in;height:4.70227in" /></p>
<p>L’audit prend quelques secondes à s’effectuer, une fois fini j’appuie
sur <em>Entrer</em> et PingCastle se ferme.</p>
<p>Deux fichiers ont été généré à la racine du dossier de PingCastle.</p>
<p><img src="./media/image663.png"
style="width:5.77683in;height:1.19636in" /></p>
</section>
<section id="lecture-du-rapport-de-laudit-ad">
<h3>Lecture du rapport de l’audit AD<a class="headerlink" href="#lecture-du-rapport-de-laudit-ad" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’ouvre dans un navigateur le fichier <em>ad_hc_t2sr.io.html</em></p>
<p><img src="./media/image664.png"
style="width:4.89842in;height:3.16303in" /></p>
<p>L’indicateur est élevé ce qui veux dire que l’AD n’est sécurisé comme il
le devrait, cette note est normale étant donné que l’AD est proche d’une
configuration par défaut, peut de sécurisation ont été fait dessus.</p>
<p>Attention !<br />Ce compteur correspond à la note la plus élevé sur 4 catégories, dans
notre cas il fait référence au compteur d’anomalies.</p>
<p><img src="./media/image665.png"
style="width:4.92933in;height:2.77547in" /></p>
<p>Grace au 4 compteur je peux situer les points de sécurité et les
modifications à effectuer pour renforcer la sécurité générale de l’AD.</p>
<ul class="simple">
<li><p><strong>Stale Object</strong> : points de sécurité liés aux utilisateurs ou aux
ordinateurs</p></li>
<li><p><strong>Privileged Accounts</strong> : points de sécurité liés aux comptes avec des
privilèges élevés (Administrateurs) du domaine Active Directory</p></li>
<li><p><strong>Trusts</strong> : points de sécurité liés aux relations d”approbations
entre les domaines Active Directory</p></li>
<li><p><strong>Anomalies</strong> : points de sécurité liés à d”autres aspects de la
configuration qui peuvent impacter la sécurité de votre annuaire</p></li>
</ul>
<blockquote>
<div><p>Juste en dessous des compteurs vient le tableau « <strong>Risk Model</strong> », il
permet de cerner les configurations auquel il faut porter attention.</p>
<p><img src="./media/image666.png"
style="width:4.81736in;height:3.74205in" /></p>
<p>Ce qui est en blanc n’est pas dans la légende, cela veut dire :</p>
<p><strong>Pas de problèmes tout est bon !</strong></p>
</div></blockquote>
<p>Ensuite vient les règles spécifiques catégories par catégories a modifié
et à prendre en compte.</p>
<blockquote>
<div><p><img src="./media/image667.png"
style="width:4.08378in;height:3.6935in" /></p>
<p>A savoir :</p>
<p>Lorsque l’on exécute un audit AD avec PingCastle l’audit précédent est
écrasé !</p>
<p>Il faut penser à sauvegarder les anciens audits.</p>
</div></blockquote>
</section>
<section id="planifier-un-audit-regulier-de-lad-avec-pingcastle">
<h3>Planifier un audit régulier de l’AD avec PingCastle<a class="headerlink" href="#planifier-un-audit-regulier-de-lad-avec-pingcastle" title="Lien permanent vers cette rubrique"></a></h3>
<p>J’ai créé un script PowerShell qui placé à la racine du Dossier de
PingCastle permet de :</p>
<p>Créer un dossier « <em><strong>auditBkp</strong></em> » s’il n’existe pas</p>
<p>Exécuter un audit AD par le biais du PingCastle.exe</p>
<p>Transférer les deux fichier html et xml dans le dossier <em><strong>auditBkp</strong></em>
et de les renommés en y ajoutant la date et l’heure lors de l’exécution
de l’audit AD.</p>
<p>Le script :</p>
<p><img src="./media/image668.png"
style="width:6.31354in;height:2.47407in" /></p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">\</span><span class="nv">$BkpPath</span> <span class="p">=</span> <span class="s2">&quot;.\auditBkp&quot;</span>  
<span class="p">**</span><span class="k">If</span><span class="p">**(!(</span><span class="nb">Test-Path</span> <span class="p">\</span><span class="nv">$BkpPath</span><span class="p">)){</span>  
<span class="nb">New-Item</span> <span class="n">-ItemType</span> <span class="n">Directory</span> <span class="n">-Force</span> <span class="n">-Path</span> <span class="p">\</span><span class="nv">$BkpPath</span>  
<span class="p">}</span>  
  
<span class="p">.\</span><span class="n">PingCastle</span><span class="p">.</span><span class="n">exe</span> <span class="p">-</span><span class="n">-server</span> <span class="n">SRV-W19-AD</span><span class="p">.</span><span class="n">t2sr</span><span class="p">.</span><span class="n">io</span> <span class="p">-</span><span class="n">-healthcheck</span>  
  
<span class="p">\</span><span class="nv">$SourceFileHtmlPath</span> <span class="p">=</span> <span class="s2">&quot;.\ad_hc_t2sr.io.html&quot;</span>  
<span class="p">\</span><span class="nv">$SourceFileXmlPath</span> <span class="p">=</span> <span class="s2">&quot;.\ad_hc_t2sr.io.xml&quot;</span>  
<span class="p">\</span><span class="nv">$DateNow</span> <span class="p">=</span> <span class="nb">Get-Date</span> <span class="n">-Format</span> <span class="s2">&quot;ddMMyyyyHHmm&quot;</span>  
  
<span class="p">\</span><span class="nv">$FileHtml</span> <span class="p">=</span> <span class="s2">&quot;ad_hc_t2sr.io\_&quot;</span><span class="p">+\</span><span class="nv">$DateNow</span><span class="p">+</span><span class="s2">&quot;.html&quot;</span>  
<span class="p">\</span><span class="nv">$FileXml</span> <span class="p">=</span> <span class="s2">&quot;ad_hc_t2sr.io\_&quot;</span><span class="p">+\</span><span class="nv">$DateNow</span><span class="p">+</span><span class="s2">&quot;.xml&quot;</span>  
  
<span class="nb">Move-Item</span> <span class="n">-Path</span> <span class="p">\</span><span class="nv">$SourceFileHtmlPath</span>
<span class="n">-Destination</span><span class="p">.\</span><span class="n">auditBkp</span><span class="p">\\\</span><span class="nv">$FileHtml</span>  
<span class="nb">Move-Item</span> <span class="n">-Path</span> <span class="p">\</span><span class="nv">$SourceFileXmlPath</span> <span class="n">-Destination</span> <span class="p">.\</span><span class="n">auditBkp</span><span class="p">\\\</span><span class="nv">$FileXml</span>
</pre></div>
</div>
<p>Ce script est propre au réseau sur lequel je travaille (il s’agit d’un
script PowerShell : <strong>.ps1</strong>).</p>
<p>Pour m’aider j’ai consulté le « help » de PingCastle dans une invite de
commande :</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="p">.\</span><span class="n">PingCastle</span><span class="p">.</span><span class="n">exe</span> <span class="p">-</span><span class="n">-help</span>
</pre></div>
</div>
<p><img src="./media/image669.png"
style="width:5.90064in;height:4.05474in" /></p>
</section>
</section>
<section id="id99">
<h2>Conclusion<a class="headerlink" href="#id99" title="Lien permanent vers cette rubrique"></a></h2>
<p>PingCastle est un outil très intéressant pour auditer l’Active Directory
avant de sa mise en production.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="index.html" class="btn btn-neutral float-left" title="Documentation Projet Cluster Proxmox" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Zoltan SRAM &amp; Pierre BONNENFANT.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

  <style>
         .wy-nav-content { max-width: none; }
  </style>



</body>
</html>